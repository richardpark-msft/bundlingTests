var main=function(e){"use strict";function t(e){return e.toLowerCase()}function r(e){if(e&&"object"==typeof e){var t=e;if("function"==typeof t.rawHeaders&&"function"==typeof t.clone&&"function"==typeof t.get&&"function"==typeof t.set&&"function"==typeof t.contains&&"function"==typeof t.remove&&"function"==typeof t.headersArray&&"function"==typeof t.headerValues&&"function"==typeof t.headerNames&&"function"==typeof t.toJson)return!0}return!1}var n=function(){function e(e){if(this._headersMap={},e)for(var t in e)this.set(t,e[t])}return e.prototype.set=function(e,r){this._headersMap[t(e)]={name:e,value:r.toString()}},e.prototype.get=function(e){var r=this._headersMap[t(e)];return r?r.value:void 0},e.prototype.contains=function(e){return!!this._headersMap[t(e)]},e.prototype.remove=function(e){var r=this.contains(e);return delete this._headersMap[t(e)],r},e.prototype.rawHeaders=function(){var e={};for(var t in this._headersMap){var r=this._headersMap[t];e[r.name.toLowerCase()]=r.value}return e},e.prototype.headersArray=function(){var e=[];for(var t in this._headersMap)e.push(this._headersMap[t]);return e},e.prototype.headerNames=function(){for(var e=[],t=this.headersArray(),r=0;r<t.length;++r)e.push(t[r].name);return e},e.prototype.headerValues=function(){for(var e=[],t=this.headersArray(),r=0;r<t.length;++r)e.push(t[r].value);return e},e.prototype.toJson=function(){return this.rawHeaders()},e.prototype.toString=function(){return JSON.stringify(this.toJson())},e.prototype.clone=function(){return new e(this.rawHeaders())},e}(),o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var a,s=function(){return(s=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function c(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))}function u(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function l(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function p(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function d(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(p(arguments[t]));return e}function f(e){for(var t="",r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return btoa(t)}function h(e){for(var t=atob(e),r=new Uint8Array(t.length),n=0;n<t.length;n++)r[n]=t.charCodeAt(n);return r}var y=new Uint8Array(16);function g(){if(!a&&!(a="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return a(y)}var m=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function v(e){return"string"==typeof e&&m.test(e)}for(var b=[],w=0;w<256;++w)b.push((w+256).toString(16).substr(1));function S(e,t,r){var n=(e=e||{}).random||(e.rng||g)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(var o=0;o<16;++o)t[r+o]=n[o];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(b[e[t+0]]+b[e[t+1]]+b[e[t+2]]+b[e[t+3]]+"-"+b[e[t+4]]+b[e[t+5]]+"-"+b[e[t+6]]+b[e[t+7]]+"-"+b[e[t+8]]+b[e[t+9]]+"-"+b[e[t+10]]+b[e[t+11]]+b[e[t+12]]+b[e[t+13]]+b[e[t+14]]+b[e[t+15]]).toLowerCase();if(!v(r))throw TypeError("Stringified UUID is invalid");return r}(n)}var T="1.2.4",E={HttpVerbs:{PUT:"PUT",GET:"GET",DELETE:"DELETE",POST:"POST",MERGE:"MERGE",HEAD:"HEAD",PATCH:"PATCH"},StatusCodes:{TooManyRequests:429}},I={AUTHORIZATION:"authorization",AUTHORIZATION_SCHEME:"Bearer",RETRY_AFTER:"Retry-After",USER_AGENT:"User-Agent"},C="$",A=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/i,O="undefined"!=typeof process&&!!process.version&&!!process.versions&&!!process.versions.node;function P(){return S()}function R(e,t){return new Promise((function(r){return setTimeout((function(){return r(t)}),e)}))}var _=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function N(e,t,r){return e&&t?e.split(t).join(r||""):e}var k=function(){function e(e,t){void 0===e&&(e={}),this.modelMappers=e,this.isXML=t}return e.prototype.validateConstraints=function(e,t,r){var n=function(e,n){throw new Error('"'+r+'" with value "'+t+'" should satisfy the constraint "'+e+'": '+n+".")};if(e.constraints&&null!=t){var o=t,i=e.constraints,a=i.ExclusiveMaximum,s=i.ExclusiveMinimum,c=i.InclusiveMaximum,u=i.InclusiveMinimum,l=i.MaxItems,p=i.MaxLength,d=i.MinItems,f=i.MinLength,h=i.MultipleOf,y=i.Pattern,g=i.UniqueItems;null!=a&&o>=a&&n("ExclusiveMaximum",a),null!=s&&o<=s&&n("ExclusiveMinimum",s),null!=c&&o>c&&n("InclusiveMaximum",c),null!=u&&o<u&&n("InclusiveMinimum",u);var m=t;if(null!=l&&m.length>l&&n("MaxItems",l),null!=p&&m.length>p&&n("MaxLength",p),null!=d&&m.length<d&&n("MinItems",d),null!=f&&m.length<f&&n("MinLength",f),null!=h&&o%h!=0&&n("MultipleOf",h),y){var v="string"==typeof y?new RegExp(y):y;"string"==typeof t&&null!==t.match(v)||n("Pattern",y)}g&&m.some((function(e,t,r){return r.indexOf(e)!==t}))&&n("UniqueItems",g)}},e.prototype.serialize=function(e,t,r,n){var o,i,a;void 0===n&&(n={});var c={rootName:null!==(o=n.rootName)&&void 0!==o?o:"",includeRoot:null!==(i=n.includeRoot)&&void 0!==i&&i,xmlCharKey:null!==(a=n.xmlCharKey)&&void 0!==a?a:"_"},u={},l=e.type.name;r||(r=e.serializedName),null!==l.match(/^Sequence$/i)&&(u=[]),e.isConstant&&(t=e.defaultValue);var p=e.required,d=e.nullable;if(p&&d&&void 0===t)throw new Error(r+" cannot be undefined.");if(p&&!d&&null==t)throw new Error(r+" cannot be null or undefined.");if(!p&&!1===d&&null===t)throw new Error(r+" cannot be null.");if(null==t)u=t;else if(this.validateConstraints(e,t,r),null!==l.match(/^any$/i))u=t;else if(null!==l.match(/^(Number|String|Boolean|Object|Stream|Uuid)$/i))u=function(e,t,r){if(null!=r)if(null!==e.match(/^Number$/i)){if("number"!=typeof r)throw new Error(t+" with value "+r+" must be of type number.")}else if(null!==e.match(/^String$/i)){if("string"!=typeof r.valueOf())throw new Error(t+' with value "'+r+'" must be of type string.')}else if(null!==e.match(/^Uuid$/i)){if("string"!=typeof r.valueOf()||(o=r,!A.test(o)))throw new Error(t+' with value "'+r+'" must be of type string and a valid uuid.')}else if(null!==e.match(/^Boolean$/i)){if("boolean"!=typeof r)throw new Error(t+" with value "+r+" must be of type boolean.")}else if(null!==e.match(/^Stream$/i)){var n=typeof r;if(!("string"===n||"function"===n||r instanceof ArrayBuffer||ArrayBuffer.isView(r)||("function"==typeof Blob||"object"==typeof Blob)&&r instanceof Blob))throw new Error(t+" must be a string, Blob, ArrayBuffer, ArrayBufferView, or a function returning NodeJS.ReadableStream.")}var o;return r}(l,r,t);else if(null!==l.match(/^Enum$/i)){u=function(e,t,r){if(!t)throw new Error("Please provide a set of allowedValues to validate "+e+" as an Enum Type.");if(!t.some((function(e){return"string"==typeof e.valueOf()?e.toLowerCase()===r.toLowerCase():e===r})))throw new Error(r+" is not a valid value for "+e+". The valid values are: "+JSON.stringify(t)+".");return r}(r,e.type.allowedValues,t)}else null!==l.match(/^(Date|DateTime|TimeSpan|DateTimeRfc1123|UnixTime)$/i)?u=function(e,t,r){if(null!=t)if(null!==e.match(/^Date$/i)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(r+" must be an instanceof Date or a string in ISO8601 format.");t=t instanceof Date?t.toISOString().substring(0,10):new Date(t).toISOString().substring(0,10)}else if(null!==e.match(/^DateTime$/i)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(r+" must be an instanceof Date or a string in ISO8601 format.");t=t instanceof Date?t.toISOString():new Date(t).toISOString()}else if(null!==e.match(/^DateTimeRfc1123$/i)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(r+" must be an instanceof Date or a string in RFC-1123 format.");t=t instanceof Date?t.toUTCString():new Date(t).toUTCString()}else if(null!==e.match(/^UnixTime$/i)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(r+" must be an instanceof Date or a string in RFC-1123/ISO8601 format for it to be serialized in UnixTime/Epoch format.");t=function(e){if(!e)return;"string"==typeof e.valueOf()&&(e=new Date(e));return Math.floor(e.getTime()/1e3)}(t)}else if(null!==e.match(/^TimeSpan$/i)&&!function(e){return _.test(e)}(t))throw new Error(r+' must be a string in ISO 8601 format. Instead was "'+t+'".');return t}(l,t,r):null!==l.match(/^ByteArray$/i)?u=function(e,t){var r="";if(null!=t){if(!(t instanceof Uint8Array))throw new Error(e+" must be of type Uint8Array.");r=f(t)}return r}(r,t):null!==l.match(/^Base64Url$/i)?u=function(e,t){var r="";if(null!=t){if(!(t instanceof Uint8Array))throw new Error(e+" must be of type Uint8Array.");r=function(e){if(!e)return;if(!(e instanceof Uint8Array))throw new Error("Please provide an input of type Uint8Array for converting to Base64Url.");return function(e,t){var r=e.length;for(;r-1>=0&&e[r-1]===t;)--r;return e.substr(0,r)}(f(e),"=").replace(/\+/g,"-").replace(/\//g,"_")}(t)||""}return r}(r,t):null!==l.match(/^Sequence$/i)?u=function(e,t,r,n,o,i){var a,c;if(!Array.isArray(r))throw new Error(n+" must be of type Array.");var u=t.type.element;if(!u||"object"!=typeof u)throw new Error('element" metadata for an Array must be defined in the mapper and it must of type "object" in '+n+".");for(var l=[],p=0;p<r.length;p++){var d=e.serialize(u,r[p],n,i);if(o&&u.xmlNamespace){var f=u.xmlNamespacePrefix?"xmlns:"+u.xmlNamespacePrefix:"xmlns";"Composite"===u.type.name?(l[p]=s({},d),l[p][C]=((a={})[f]=u.xmlNamespace,a)):(l[p]={},l[p][i.xmlCharKey]=d,l[p][C]=((c={})[f]=u.xmlNamespace,c))}else l[p]=d}return l}(this,e,t,r,Boolean(this.isXML),c):null!==l.match(/^Dictionary$/i)?u=function(e,t,r,n,o,i){var a;if("object"!=typeof r)throw new Error(n+" must be of type object.");var s=t.type.value;if(!s||"object"!=typeof s)throw new Error('"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in '+n+".");for(var c={},u=0,l=Object.keys(r);u<l.length;u++){var p=l[u],d=e.serialize(s,r[p],n,i);c[p]=q(s,d,o,i)}if(o&&t.xmlNamespace){var f=t.xmlNamespacePrefix?"xmlns:"+t.xmlNamespacePrefix:"xmlns",h=c;return h[C]=((a={})[f]=t.xmlNamespace,a),h}return c}(this,e,t,r,Boolean(this.isXML),c):null!==l.match(/^Composite$/i)&&(u=function(e,t,r,n,o,i){var a,c;U(e,t)&&(t=L(e,t,r,"clientName"));if(null!=r){for(var u={},l=M(e,t,n),p=0,d=Object.keys(l);p<d.length;p++){var f=d[p],h=l[f];if(!h.readOnly){var y=void 0,g=u;if(e.isXML)y=h.xmlIsWrapped?h.xmlName:h.xmlElementName||h.xmlName;else{var m=x(h.serializedName);y=m.pop();for(var v=0,b=m;v<b.length;v++){var w=b[v];null!=g[w]||null==r[f]&&void 0===h.defaultValue||(g[w]={}),g=g[w]}}if(null!=g){if(o&&t.xmlNamespace){var S=t.xmlNamespacePrefix?"xmlns:"+t.xmlNamespacePrefix:"xmlns";g[C]=s(s({},g[C]),((a={})[S]=t.xmlNamespace,a))}var T=""!==h.serializedName?n+"."+h.serializedName:n,E=r[f],I=U(e,t);I&&I.clientName===f&&null==E&&(E=t.serializedName);var A=e.serialize(h,E,T,i);if(void 0!==A&&null!=y){var O=q(h,A,o,i);o&&h.xmlIsAttribute?(g[C]=g[C]||{},g[C][y]=A):o&&h.xmlIsWrapped?g[y]=((c={})[h.xmlElementName]=O,c):g[y]=O}}}}var P=function(e,t,r){var n=t.type.additionalProperties;if(!n&&t.type.className){var o=j(e,t,r);return null==o?void 0:o.type.additionalProperties}return n}(e,t,n);if(P){var R=Object.keys(l),_=function(t){R.every((function(e){return e!==t}))&&(u[t]=e.serialize(P,r[t],n+'["'+t+'"]',i))};for(var N in r)_(N)}return u}return r}(this,e,t,r,Boolean(this.isXML),c));return u},e.prototype.deserialize=function(e,t,r,n){var o,i,a;void 0===n&&(n={});var s,c={rootName:null!==(o=n.rootName)&&void 0!==o?o:"",includeRoot:null!==(i=n.includeRoot)&&void 0!==i&&i,xmlCharKey:null!==(a=n.xmlCharKey)&&void 0!==a?a:"_"};if(null==t)return this.isXML&&"Sequence"===e.type.name&&!e.xmlIsWrapped&&(t=[]),void 0!==e.defaultValue&&(t=e.defaultValue),t;var u=e.type.name;if(r||(r=e.serializedName),null!==u.match(/^Composite$/i))s=function(e,t,r,n,o){var i;U(e,t)&&(t=L(e,t,r,"serializedName"));for(var a=M(e,t,n),s={},c=[],u=0,l=Object.keys(a);u<l.length;u++){var p=l[u],d=a[p],f=x(a[p].serializedName);c.push(f[0]);var h=d.serializedName,y=d.xmlName,g=d.xmlElementName,m=n;""!==h&&void 0!==h&&(m=n+"."+h);var v=d.headerCollectionPrefix;if(v){for(var b={},w=0,S=Object.keys(r);w<S.length;w++){var T=S[w];T.startsWith(v)&&(b[T.substring(v.length)]=e.deserialize(d.type.value,r[T],m,o)),c.push(T)}s[p]=b}else if(e.isXML)if(d.xmlIsAttribute&&r[C])s[p]=e.deserialize(d,r[C][y],m,o);else{var E=g||y||h;if(d.xmlIsWrapped){var I=r[y],A=null!==(i=null==I?void 0:I[g])&&void 0!==i?i:[];s[p]=e.deserialize(d,A,m,o)}else{var O=r[E];s[p]=e.deserialize(d,O,m,o)}}else{for(var P=void 0,R=r,_=0,N=f;_<N.length;_++){var k=N[_];if(!R)break;R=R[k]}P=R;var j=t.type.polymorphicDiscriminator;j&&p===j.clientName&&null==P&&(P=t.serializedName);var q=void 0;Array.isArray(r[p])&&""===a[p].serializedName?(P=r[p],s=e.deserialize(d,P,m,o)):void 0===P&&void 0===d.defaultValue||(q=e.deserialize(d,P,m,o),s[p]=q)}}var H=t.type.additionalProperties;if(H){var z=function(e){for(var t in a){if(x(a[t].serializedName)[0]===e)return!1}return!0};for(var F in r)z(F)&&(s[F]=e.deserialize(H,r[F],n+'["'+F+'"]',o))}else if(r)for(var V=0,B=Object.keys(r);V<B.length;V++){p=B[V];void 0!==s[p]||c.includes(p)||D(p,o)||(s[p]=r[p])}return s}(this,e,t,r,c);else{if(this.isXML){var l=c.xmlCharKey,p=t;null!=p[C]&&null!=p[l]&&(t=p[l])}null!==u.match(/^Number$/i)?(s=parseFloat(t),isNaN(s)&&(s=t)):null!==u.match(/^Boolean$/i)?s="true"===t||"false"!==t&&t:null!==u.match(/^(String|Enum|Object|Stream|Uuid|TimeSpan|any)$/i)?s=t:null!==u.match(/^(Date|DateTime|DateTimeRfc1123)$/i)?s=new Date(t):null!==u.match(/^UnixTime$/i)?s=function(e){if(!e)return;return new Date(1e3*e)}(t):null!==u.match(/^ByteArray$/i)?s=h(t):null!==u.match(/^Base64Url$/i)?s=function(e){if(!e)return;if(e&&"string"!=typeof e.valueOf())throw new Error("Please provide an input of type string for converting to Uint8Array");return h(e=e.replace(/-/g,"+").replace(/_/g,"/"))}(t):null!==u.match(/^Sequence$/i)?s=function(e,t,r,n,o){var i=t.type.element;if(!i||"object"!=typeof i)throw new Error('element" metadata for an Array must be defined in the mapper and it must of type "object" in '+n);if(r){Array.isArray(r)||(r=[r]);for(var a=[],s=0;s<r.length;s++)a[s]=e.deserialize(i,r[s],n+"["+s+"]",o);return a}return r}(this,e,t,r,c):null!==u.match(/^Dictionary$/i)&&(s=function(e,t,r,n,o){var i=t.type.value;if(!i||"object"!=typeof i)throw new Error('"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in '+n);if(r){for(var a={},s=0,c=Object.keys(r);s<c.length;s++){var u=c[s];a[u]=e.deserialize(i,r[u],n,o)}return a}return r}(this,e,t,r,c))}return e.isConstant&&(s=e.defaultValue),s},e}();function x(e){var t=[],r="";if(e)for(var n=0,o=e.split(".");n<o.length;n++){var i=o[n];"\\"===i.charAt(i.length-1)?r+=i.substr(0,i.length-1)+".":(r+=i,t.push(r),r="")}return t}function j(e,t,r){var n=t.type.className;if(!n)throw new Error('Class name for model "'+r+'" is not provided in the mapper "'+JSON.stringify(t,void 0,2)+'".');return e.modelMappers[n]}function M(e,t,r){var n=t.type.modelProperties;if(!n){var o=j(e,t,r);if(!o)throw new Error('mapper() cannot be null or undefined for model "'+t.type.className+'".');if(!(n=null==o?void 0:o.type.modelProperties))throw new Error('modelProperties cannot be null or undefined in the mapper "'+JSON.stringify(o)+'" of type "'+t.type.className+'" for object "'+r+'".')}return n}function q(e,t,r,n){var o;if(!r||!e.xmlNamespace)return t;var i=((o={})[e.xmlNamespacePrefix?"xmlns:"+e.xmlNamespacePrefix:"xmlns"]=e.xmlNamespace,o);if(["Composite"].includes(e.type.name)){if(t[C])return t;var a=s({},t);return a[C]=i,a}var c={};return c[n.xmlCharKey]=t,c[C]=i,c}function D(e,t){return[C,t.xmlCharKey].includes(e)}function L(e,t,r,n){var o=U(e,t);if(o){var i=o[n];if(null!=i){var a=r[i];if(null!=a){var s=t.type.uberParent||t.type.className,c=a===s?a:s+"."+a,u=e.modelMappers.discriminators[c];u&&(t=u)}}}return t}function U(e,t){return t.type.polymorphicDiscriminator||H(e,t.type.uberParent)||H(e,t.type.className)}function H(e,t){return t&&e.modelMappers[t]&&e.modelMappers[t].type.polymorphicDiscriminator}var z=function(e){for(var t={},r=0,n=e;r<n.length;r++){var o=n[r];t[o]=o}return t}(["Base64Url","Boolean","ByteArray","Composite","Date","DateTime","DateTimeRfc1123","Dictionary","Enum","Number","Object","Sequence","String","Stream","TimeSpan","UnixTime"]);var F=function(){function e(e,t,o,i,a,s,c,u,l,p,d,f,h,y,g){this.streamResponseBody=s,this.streamResponseStatusCodes=g,this.url=e||"",this.method=t||"GET",this.headers=r(a)?a:new n(a),this.body=o,this.query=i,this.formData=void 0,this.withCredentials=c||!1,this.abortSignal=u,this.timeout=l||0,this.onUploadProgress=p,this.onDownloadProgress=d,this.proxySettings=f,this.keepAlive=h,this.decompressResponse=y,this.requestId=this.headers.get("x-ms-client-request-id")||P()}return e.prototype.validateRequestProperties=function(){if(!this.method)throw new Error("WebResource.method is required.");if(!this.url)throw new Error("WebResource.url is required.")},e.prototype.prepare=function(e){if(!e)throw new Error("options object is required");if(void 0===e.method||null===e.method||"string"!=typeof e.method.valueOf())throw new Error("options.method must be a string.");if(e.url&&e.pathTemplate)throw new Error("options.url and options.pathTemplate are mutually exclusive. Please provide exactly one of them.");if(!(void 0!==e.pathTemplate&&null!==e.pathTemplate&&"string"==typeof e.pathTemplate.valueOf()||void 0!==e.url&&null!==e.url&&"string"==typeof e.url.valueOf()))throw new Error("Please provide exactly one of options.pathTemplate or options.url.");if(e.url){if("string"!=typeof e.url)throw new Error('options.url must be of type "string".');this.url=e.url}if(e.method){var t=["GET","PUT","HEAD","DELETE","OPTIONS","POST","PATCH","TRACE"];if(-1===t.indexOf(e.method.toUpperCase()))throw new Error('The provided method "'+e.method+'" is invalid. Supported HTTP methods are: '+JSON.stringify(t))}if(this.method=e.method.toUpperCase(),e.pathTemplate){var r=e.pathTemplate,n=e.pathParameters;if("string"!=typeof r)throw new Error('options.pathTemplate must be of type "string".');e.baseUrl||(e.baseUrl="https://management.azure.com");var o=e.baseUrl,i=o+(o.endsWith("/")?"":"/")+(r.startsWith("/")?r.slice(1):r),a=i.match(/({[\w-]*\s*[\w-]*})/gi);if(a&&a.length){if(!n)throw new Error("pathTemplate: "+r+" has been provided. Hence, options.pathParameters must also be provided.");a.forEach((function(e){var t=e.slice(1,-1),o=n[t];if(null==o||"string"!=typeof o&&"object"!=typeof o){var a=JSON.stringify(n,void 0,2);throw new Error("pathTemplate: "+r+" contains the path parameter "+t+" however, it is not present in parameters: "+a+'.The value of the path parameter can either be a "string" of the form { '+t+': "some sample value" } or it can be an "object" of the form { "'+t+'": { value: "some sample value", skipUrlEncoding: true } }.')}if("string"==typeof o.valueOf()&&(i=i.replace(e,encodeURIComponent(o))),"object"==typeof o.valueOf()){if(!o.value)throw new Error("options.pathParameters["+t+'] is of type "object" but it does not contain a "value" property.');i=o.skipUrlEncoding?i.replace(e,o.value):i.replace(e,encodeURIComponent(o.value))}}))}this.url=i}if(e.queryParameters){var s=e.queryParameters;if("object"!=typeof s)throw new Error('options.queryParameters must be of type object. It should be a JSON object of "query-parameter-name" as the key and the "query-parameter-value" as the value. The "query-parameter-value" may be fo type "string" or an "object" of the form { value: "query-parameter-value", skipUrlEncoding: true }.');this.url&&-1===this.url.indexOf("?")&&(this.url+="?");var c=[];for(var u in this.query={},s){var l=s[u];if(l)if("string"==typeof l)c.push(u+"="+encodeURIComponent(l)),this.query[u]=encodeURIComponent(l);else if("object"==typeof l){if(!l.value)throw new Error("options.queryParameters["+u+'] is of type "object" but it does not contain a "value" property.');l.skipUrlEncoding?(c.push(u+"="+l.value),this.query[u]=l.value):(c.push(u+"="+encodeURIComponent(l.value)),this.query[u]=encodeURIComponent(l.value))}}this.url+=c.join("&")}if(e.headers)for(var p=e.headers,d=0,f=Object.keys(e.headers);d<f.length;d++){var h=f[d];this.headers.set(h,p[h])}return this.headers.get("accept-language")||this.headers.set("accept-language","en-US"),this.headers.get("x-ms-client-request-id")||e.disableClientRequestId||this.headers.set("x-ms-client-request-id",this.requestId),this.headers.get("Content-Type")||this.headers.set("Content-Type","application/json; charset=utf-8"),this.body=e.body,void 0!==e.body&&null!==e.body&&(e.bodyIsStream?(this.headers.get("Transfer-Encoding")||this.headers.set("Transfer-Encoding","chunked"),"application/octet-stream"!==this.headers.get("Content-Type")&&this.headers.set("Content-Type","application/octet-stream")):(e.serializationMapper&&(this.body=new k(e.mappers).serialize(e.serializationMapper,e.body,"requestBody")),e.disableJsonStringifyOnBody||(this.body=JSON.stringify(e.body)))),e.spanOptions&&(this.spanOptions=e.spanOptions),e.tracingContext&&(this.tracingContext=e.tracingContext),this.abortSignal=e.abortSignal,this.onDownloadProgress=e.onDownloadProgress,this.onUploadProgress=e.onUploadProgress,this},e.prototype.clone=function(){var t=new e(this.url,this.method,this.body,this.query,this.headers&&this.headers.clone(),this.streamResponseBody,this.withCredentials,this.abortSignal,this.timeout,this.onUploadProgress,this.onDownloadProgress,this.proxySettings,this.keepAlive,this.decompressResponse,this.streamResponseStatusCodes);return this.formData&&(t.formData=this.formData),this.operationSpec&&(t.operationSpec=this.operationSpec),this.shouldDeserialize&&(t.shouldDeserialize=this.shouldDeserialize),this.operationResponseGetter&&(t.operationResponseGetter=this.operationResponseGetter),t},e}(),V=new WeakMap,B=new WeakMap,G=function(){function e(){this.onabort=null,V.set(this,[]),B.set(this,!1)}return Object.defineProperty(e.prototype,"aborted",{get:function(){if(!B.has(this))throw new TypeError("Expected `this` to be an instance of AbortSignal.");return B.get(this)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"none",{get:function(){return new e},enumerable:!1,configurable:!0}),e.prototype.addEventListener=function(e,t){if(!V.has(this))throw new TypeError("Expected `this` to be an instance of AbortSignal.");V.get(this).push(t)},e.prototype.removeEventListener=function(e,t){if(!V.has(this))throw new TypeError("Expected `this` to be an instance of AbortSignal.");var r=V.get(this),n=r.indexOf(t);n>-1&&r.splice(n,1)},e.prototype.dispatchEvent=function(e){throw new Error("This is a stub dispatchEvent implementation that should not be used.  It only exists for type-checking purposes.")},e}();function K(e){if(!e.aborted){e.onabort&&e.onabort.call(e);var t=V.get(e);t&&t.slice().forEach((function(t){t.call(e,{type:"abort"})})),B.set(e,!0)}}var W=function(e){function t(t){var r=e.call(this,t)||this;return r.name="AbortError",r}return i(t,e),t}(Error);!function(){function e(e){var t=this;if(this._signal=new G,e){Array.isArray(e)||(e=arguments);for(var r=0,n=e;r<n.length;r++){var o=n[r];o.aborted?this.abort():o.addEventListener("abort",(function(){t.abort()}))}}}Object.defineProperty(e.prototype,"signal",{get:function(){return this._signal},enumerable:!1,configurable:!0}),e.prototype.abort=function(){K(this._signal)},e.timeout=function(e){var t=new G,r=setTimeout(K,e,t);return"function"==typeof r.unref&&r.unref(),t}}();var Q={},$=URL,J=function(){function e(){this._rawQuery={}}return e.prototype.any=function(){return Object.keys(this._rawQuery).length>0},e.prototype.keys=function(){return Object.keys(this._rawQuery)},e.prototype.set=function(e,t){var r=t;if(e)if(null!=r){var n=Array.isArray(r)?r:r.toString();this._rawQuery[e]=n}else delete this._rawQuery[e]},e.prototype.get=function(e){return e?this._rawQuery[e]:void 0},e.prototype.toString=function(){var e="";for(var t in this._rawQuery){e&&(e+="&");var r=this._rawQuery[t];if(Array.isArray(r)){for(var n=[],o=0,i=r;o<i.length;o++){var a=i[o];n.push(t+"="+a)}e+=n.join("&")}else e+=t+"="+r}return e},e.parse=function(t){var r=new e;if(t){t.startsWith("?")&&(t=t.substring(1));for(var n="ParameterName",o="",i="",a=0;a<t.length;++a){var s=t[a];switch(n){case"ParameterName":switch(s){case"=":n="ParameterValue";break;case"&":o="",i="";break;default:o+=s}break;case"ParameterValue":switch(s){case"&":r.set(o,i),o="",i="",n="ParameterName";break;default:i+=s}break;default:throw new Error("Unrecognized URLQuery parse state: "+n)}}"ParameterValue"===n&&r.set(o,i)}return r},e}(),X=function(){function e(){}return e.prototype.setScheme=function(e){e?this.set(e,"SCHEME"):this._scheme=void 0},e.prototype.getScheme=function(){return this._scheme},e.prototype.setHost=function(e){e?this.set(e,"SCHEME_OR_HOST"):this._host=void 0},e.prototype.getHost=function(){return this._host},e.prototype.setPort=function(e){null==e||""===e?this._port=void 0:this.set(e.toString(),"PORT")},e.prototype.getPort=function(){return this._port},e.prototype.setPath=function(e){if(e){var t=e.indexOf("://");if(-1!==t){var r=e.lastIndexOf("/",t);this.set(-1===r?e:e.substr(r+1),"SCHEME")}else this.set(e,"PATH")}else this._path=void 0},e.prototype.appendPath=function(e){if(e){var t=this.getPath();t&&(t.endsWith("/")||(t+="/"),e.startsWith("/")&&(e=e.substring(1)),e=t+e),this.set(e,"PATH")}},e.prototype.getPath=function(){return this._path},e.prototype.setQuery=function(e){this._query=e?J.parse(e):void 0},e.prototype.setQueryParameter=function(e,t){e&&(this._query||(this._query=new J),this._query.set(e,t))},e.prototype.getQueryParameterValue=function(e){return this._query?this._query.get(e):void 0},e.prototype.getQuery=function(){return this._query?this._query.toString():void 0},e.prototype.set=function(e,t){for(var r=new Z(e,t);r.next();){var n=r.current(),o=void 0;if(n)switch(n.type){case"SCHEME":this._scheme=n.text||void 0;break;case"HOST":this._host=n.text||void 0;break;case"PORT":this._port=n.text||void 0;break;case"PATH":o=n.text||void 0,this._path&&"/"!==this._path&&"/"===o||(this._path=o);break;case"QUERY":this._query=J.parse(n.text);break;default:throw new Error("Unrecognized URLTokenType: "+n.type)}}},e.prototype.toString=function(){var e="";return this._scheme&&(e+=this._scheme+"://"),this._host&&(e+=this._host),this._port&&(e+=":"+this._port),this._path&&(this._path.startsWith("/")||(e+="/"),e+=this._path),this._query&&this._query.any()&&(e+="?"+this._query.toString()),e},e.prototype.replaceAll=function(e,t){e&&(this.setScheme(N(this.getScheme(),e,t)),this.setHost(N(this.getHost(),e,t)),this.setPort(N(this.getPort(),e,t)),this.setPath(N(this.getPath(),e,t)),this.setQuery(N(this.getQuery(),e,t)))},e.parse=function(t){var r=new e;return r.set(t,"SCHEME_OR_HOST"),r},e}(),Y=function(){function e(e,t){this.text=e,this.type=t}return e.scheme=function(t){return new e(t,"SCHEME")},e.host=function(t){return new e(t,"HOST")},e.port=function(t){return new e(t,"PORT")},e.path=function(t){return new e(t,"PATH")},e.query=function(t){return new e(t,"QUERY")},e}();var Z=function(){function e(e,t){this._text=e,this._textLength=e?e.length:0,this._currentState=null!=t?t:"SCHEME_OR_HOST",this._currentIndex=0}return e.prototype.current=function(){return this._currentToken},e.prototype.next=function(){if(ee(this))switch(this._currentState){case"SCHEME":t=function(e){return oe(e,(function(e){return function(e){var t=e.charCodeAt(0);return 48<=t&&t<=57||65<=t&&t<=90||97<=t&&t<=122}(e)}))}(e=this),e._currentToken=Y.scheme(t),ee(e)?e._currentState="HOST":e._currentState="DONE";break;case"SCHEME_OR_HOST":!function(e){var t=ie(e,":","/","?");ee(e)?":"===te(e)?"://"===ne(e,3)?(e._currentToken=Y.scheme(t),e._currentState="HOST"):(e._currentToken=Y.host(t),e._currentState="PORT"):(e._currentToken=Y.host(t),"/"===te(e)?e._currentState="PATH":e._currentState="QUERY"):(e._currentToken=Y.host(t),e._currentState="DONE")}(this);break;case"HOST":!function(e){"://"===ne(e,3)&&re(e,3);var t=ie(e,":","/","?");e._currentToken=Y.host(t),ee(e)?":"===te(e)?e._currentState="PORT":"/"===te(e)?e._currentState="PATH":e._currentState="QUERY":e._currentState="DONE"}(this);break;case"PORT":!function(e){":"===te(e)&&re(e);var t=ie(e,"/","?");e._currentToken=Y.port(t),ee(e)?"/"===te(e)?e._currentState="PATH":e._currentState="QUERY":e._currentState="DONE"}(this);break;case"PATH":!function(e){var t=ie(e,"?");e._currentToken=Y.path(t),ee(e)?e._currentState="QUERY":e._currentState="DONE"}(this);break;case"QUERY":!function(e){"?"===te(e)&&re(e);var t=function(e){var t="";e._currentIndex<e._textLength&&(t=e._text.substring(e._currentIndex),e._currentIndex=e._textLength);return t}(e);e._currentToken=Y.query(t),e._currentState="DONE"}(this);break;default:throw new Error("Unrecognized URLTokenizerState: "+this._currentState)}else this._currentToken=void 0;var e,t;return!!this._currentToken},e}();function ee(e){return e._currentIndex<e._textLength}function te(e){return e._text[e._currentIndex]}function re(e,t){ee(e)&&(t||(t=1),e._currentIndex+=t)}function ne(e,t){var r=e._currentIndex+t;return e._textLength<r&&(r=e._textLength),e._text.substring(e._currentIndex,r)}function oe(e,t){for(var r="";ee(e);){var n=te(e);if(!t(n))break;r+=n,re(e)}return r}function ie(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return oe(e,(function(e){return-1===t.indexOf(e)}))}var ae,se=["x-ms-client-request-id","x-ms-return-client-request-id","x-ms-useragent","x-ms-correlation-request-id","x-ms-request-id","client-request-id","ms-cv","return-client-request-id","traceparent","Access-Control-Allow-Credentials","Access-Control-Allow-Headers","Access-Control-Allow-Methods","Access-Control-Allow-Origin","Access-Control-Expose-Headers","Access-Control-Max-Age","Access-Control-Request-Headers","Access-Control-Request-Method","Origin","Accept","Cache-Control","Connection","Content-Length","Content-Type","Date","ETag","Expires","If-Match","If-Modified-Since","If-None-Match","If-Unmodified-Since","Last-Modified","Pragma","Request-Id","Retry-After","Server","Transfer-Encoding","User-Agent"],ce=["api-version"],ue=function(){function e(e){var t=void 0===e?{}:e,r=t.allowedHeaderNames,n=void 0===r?[]:r,o=t.allowedQueryParameters,i=void 0===o?[]:o;n=Array.isArray(n)?se.concat(n):se,i=Array.isArray(i)?ce.concat(i):ce,this.allowedHeaderNames=new Set(n.map((function(e){return e.toLowerCase()}))),this.allowedQueryParameters=new Set(i.map((function(e){return e.toLowerCase()})))}return e.prototype.sanitize=function(e){return JSON.stringify(e,this.replacer.bind(this),2)},e.prototype.replacer=function(e,t){return t instanceof Error?s(s({},t),{name:t.name,message:t.message}):"_headersMap"===e?this.sanitizeHeaders(e,t):"url"===e?this.sanitizeUrl(t):"query"===e?this.sanitizeQuery(t):"body"!==e&&"response"!==e&&"operationSpec"!==e?t:void 0},e.prototype.sanitizeHeaders=function(e,t){return this.sanitizeObject(t,this.allowedHeaderNames,(function(e,t){return e[t].value}))},e.prototype.sanitizeQuery=function(e){return this.sanitizeObject(e,this.allowedQueryParameters,(function(e,t){return e[t]}))},e.prototype.sanitizeObject=function(e,t,r){if("object"!=typeof e||null===e)return e;for(var n={},o=0,i=Object.keys(e);o<i.length;o++){var a=i[o];t.has(a.toLowerCase())?n[a]=r(e,a):n[a]="REDACTED"}return n},e.prototype.sanitizeUrl=function(e){if("string"!=typeof e||null===e)return e;var t=X.parse(e),r=t.getQuery();if(!r)return e;for(var n=J.parse(r),o=0,i=n.keys();o<i.length;o++){var a=i[o];this.allowedQueryParameters.has(a.toLowerCase())||n.set(a,"REDACTED")}return t.setQuery(n.toString()),t.toString()},e}(),le=new ue,pe=function(e){function t(r,n,o,i,a){var s=e.call(this,r)||this;return s.name="RestError",s.code=n,s.statusCode=o,s.request=i,s.response=a,Object.setPrototypeOf(s,t.prototype),s}return i(t,e),t.prototype[Q]=function(){return"RestError: "+this.message+" \n "+le.sanitize(this)},t.REQUEST_SEND_ERROR="REQUEST_SEND_ERROR",t.PARSE_ERROR="PARSE_ERROR",t}(Error),de=function(){function e(){}return e.prototype.sendRequest=function(e){var t,r=new XMLHttpRequest;if(e.proxySettings)throw new Error("HTTP proxy is not supported in browser environment");var n=e.abortSignal;if(n){if(n.aborted)return Promise.reject(new W("The operation was aborted."));var o=function(){r.abort()};n.addEventListener("abort",o),r.addEventListener("readystatechange",(function(){r.readyState===XMLHttpRequest.DONE&&n.removeEventListener("abort",o)}))}if(fe(r.upload,e.onUploadProgress),fe(r,e.onDownloadProgress),e.formData){for(var i=e.formData,a=new FormData,s=function(e,t){t&&Object.prototype.hasOwnProperty.call(t,"value")&&Object.prototype.hasOwnProperty.call(t,"options")?a.append(e,t.value,t.options):a.append(e,t)},c=0,u=Object.keys(i);c<u.length;c++){var l=u[c],p=i[l];if(Array.isArray(p))for(var d=0;d<p.length;d++)s(l,p[d]);else s(l,p)}e.body=a,e.formData=void 0;var f=e.headers.get("Content-Type");f&&-1!==f.indexOf("multipart/form-data")&&e.headers.remove("Content-Type")}r.open(e.method,e.url),r.timeout=e.timeout,r.withCredentials=e.withCredentials;for(var h=0,y=e.headers.headersArray();h<y.length;h++){var g=y[h];r.setRequestHeader(g.name,g.value)}return r.responseType=(null===(t=e.streamResponseStatusCodes)||void 0===t?void 0:t.size)||e.streamResponseBody?"blob":"text",r.send(void 0===e.body?null:e.body),"blob"===r.responseType?new Promise((function(t,n){!function(e,t,r,n){e.addEventListener("readystatechange",(function(){var o;if(e.readyState===XMLHttpRequest.HEADERS_RECEIVED)if(t.streamResponseBody||(null===(o=t.streamResponseStatusCodes)||void 0===o?void 0:o.has(e.status))){var i=new Promise((function(r,n){e.addEventListener("load",(function(){r(e.response)})),ye(t,e,n)}));r({request:t,status:e.status,headers:he(e),blobBody:i})}else e.addEventListener("load",(function(){if(e.response){var o=new FileReader;o.onload=function(n){var o,i=null===(o=n.target)||void 0===o?void 0:o.result;r({request:t,status:e.status,headers:he(e),bodyAsText:i})},o.onerror=function(e){n(o.error)},o.readAsText(e.response,"UTF-8")}else r({request:t,status:e.status,headers:he(e)})}))}))}(r,e,t,n),ye(e,r,n)})):new Promise((function(t,n){r.addEventListener("load",(function(){return t({request:e,status:r.status,headers:he(r),bodyAsText:r.responseText})})),ye(e,r,n)}))},e}();function fe(e,t){t&&e.addEventListener("progress",(function(e){return t({loadedBytes:e.loaded})}))}function he(e){for(var t=new n,r=0,o=e.getAllResponseHeaders().trim().split(/[\r\n]+/);r<o.length;r++){var i=o[r],a=i.indexOf(":"),s=i.slice(0,a),c=i.slice(a+2);t.set(s,c)}return t}function ye(e,t,r){t.addEventListener("error",(function(){return r(new pe("Failed to send request to "+e.url,pe.REQUEST_SEND_ERROR,void 0,e))}));var n=new W("The operation was aborted.");t.addEventListener("abort",(function(){return r(n)})),t.addEventListener("timeout",(function(){return r(n)}))}function ge(e){var t=e.requestOptions,r=e.tracingOptions,n=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}(e,["requestOptions","tracingOptions"]);return t&&(n=s(s({},n),t)),r&&(n.spanOptions=r.spanOptions,n.tracingContext=r.tracingContext),n}!function(e){e[e.OFF=0]="OFF",e[e.ERROR=1]="ERROR",e[e.WARNING=2]="WARNING",e[e.INFO=3]="INFO"}(ae||(ae={}));var me=function(){function e(e,t){this._nextPolicy=e,this._options=t}return e.prototype.shouldLog=function(e){return this._options.shouldLog(e)},e.prototype.log=function(e,t){this._options.log(e,t)},e}(),ve=function(){function e(e){this._logger=e}return e.prototype.shouldLog=function(e){return!!this._logger&&e!==ae.OFF&&e<=this._logger.minimumLogLevel},e.prototype.log=function(e,t){this._logger&&this.shouldLog(e)&&this._logger.log(e,t)},e}();var be,we="undefined"!=typeof process&&process.env&&process.env.DEBUG||void 0,Se=[],Te=[],Ee=[];we&&Ce(we);var Ie=Object.assign((function(e){return Oe(e)}),{enable:Ce,enabled:Ae,disable:function(){var e=be||"";return Ce(""),e},log:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(e.length>0){var r=String(e[0]);r.includes(":error")?console.error.apply(console,d(e)):r.includes(":warning")?console.warn.apply(console,d(e)):r.includes(":info")?console.info.apply(console,d(e)):(r.includes(":verbose"),console.debug.apply(console,d(e)))}}});function Ce(e){var t,r,n,o;be=e,Se=[],Te=[];var i=/\*/g,a=e.split(",").map((function(e){return e.trim().replace(i,".*?")}));try{for(var s=l(a),c=s.next();!c.done;c=s.next()){var u=c.value;u.startsWith("-")?Te.push(new RegExp("^"+u.substr(1)+"$")):Se.push(new RegExp("^"+u+"$"))}}catch(e){t={error:e}}finally{try{c&&!c.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}try{for(var p=l(Ee),d=p.next();!d.done;d=p.next()){var f=d.value;f.enabled=Ae(f.namespace)}}catch(e){n={error:e}}finally{try{d&&!d.done&&(o=p.return)&&o.call(p)}finally{if(n)throw n.error}}}function Ae(e){var t,r,n,o;if(e.endsWith("*"))return!0;try{for(var i=l(Te),a=i.next();!a.done;a=i.next()){if(a.value.test(e))return!1}}catch(e){t={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}try{for(var s=l(Se),c=s.next();!c.done;c=s.next()){if(c.value.test(e))return!0}}catch(e){n={error:e}}finally{try{c&&!c.done&&(o=s.return)&&o.call(s)}finally{if(n)throw n.error}}return!1}function Oe(e){var t=Object.assign((function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];if(!t.enabled)return;r.length>0&&(r[0]=e+" "+r[0]);t.log.apply(t,d(r))}),{enabled:Ae(e),destroy:Pe,log:Ie.log,namespace:e,extend:Re});return Ee.push(t),t}function Pe(){var e=Ee.indexOf(this);return e>=0&&(Ee.splice(e,1),!0)}function Re(e){var t=Oe(this.namespace+":"+e);return t.log=this.log,t}var _e,Ne=new Set,ke="undefined"!=typeof process&&process.env&&process.env.AZURE_LOG_LEVEL||void 0,xe=Ie("azure");xe.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];Ie.log.apply(Ie,d(e))};var je=["verbose","info","warning","error"];ke&&(He(ke)?function(e){var t,r;if(e&&!He(e))throw new Error("Unknown log level '"+e+"'. Acceptable values: "+je.join(","));_e=e;var n=[];try{for(var o=l(Ne),i=o.next();!i.done;i=o.next()){var a=i.value;Ue(a)&&n.push(a.namespace)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}Ie.enable(n.join(","))}(ke):console.error("AZURE_LOG_LEVEL set to unknown log level '"+ke+"'; logging is not enabled. Acceptable values: "+je.join(", ")+"."));var Me={verbose:400,info:300,warning:200,error:100};function qe(e){var t=xe.extend(e);return De(xe,t),{error:Le(t,"error"),warning:Le(t,"warning"),info:Le(t,"info"),verbose:Le(t,"verbose")}}function De(e,t){t.log=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];e.log.apply(e,d(t))}}function Le(e,t){var r=Object.assign(e.extend(t),{level:t});if(De(e,r),Ue(r)){var n=Ie.disable();Ie.enable(n+","+r.namespace)}return Ne.add(r),r}function Ue(e){return!!(_e&&Me[e.level]<=Me[_e])}function He(e){return je.includes(e)}var ze=qe("core-http");function Fe(e){return void 0===e&&(e={}),{create:function(t,r){return new Ve(t,r,e)}}}var Ve=function(e){function t(t,r,n){var o=void 0===n?{}:n,i=o.logger,a=void 0===i?ze.info:i,s=o.allowedHeaderNames,c=void 0===s?[]:s,u=o.allowedQueryParameters,l=void 0===u?[]:u,p=e.call(this,t,r)||this;return p.logger=a,p.sanitizer=new ue({allowedHeaderNames:c,allowedQueryParameters:l}),p}return i(t,e),Object.defineProperty(t.prototype,"allowedHeaderNames",{get:function(){return this.sanitizer.allowedHeaderNames},set:function(e){this.sanitizer.allowedHeaderNames=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"allowedQueryParameters",{get:function(){return this.sanitizer.allowedQueryParameters},set:function(e){this.sanitizer.allowedQueryParameters=e},enumerable:!1,configurable:!0}),t.prototype.sendRequest=function(e){var t=this;return this.logger.enabled?(this.logRequest(e),this._nextPolicy.sendRequest(e).then((function(e){return t.logResponse(e)}))):this._nextPolicy.sendRequest(e)},t.prototype.logRequest=function(e){this.logger("Request: "+this.sanitizer.sanitize(e))},t.prototype.logResponse=function(e){return this.logger("Response status code: "+e.status),this.logger("Headers: "+this.sanitizer.sanitize(e.headers)),e},t}(me);function Be(e){return Ge(e.parameterPath,e.mapper)}function Ge(e,t){return"string"==typeof e?e:Array.isArray(e)?e.join("."):t.serializedName}var Ke,We=document.implementation.createDocument(null,null,null),Qe=new DOMParser;function $e(e,t){var r,n,o;void 0===t&&(t={});try{var i={rootName:null!==(r=t.rootName)&&void 0!==r?r:"",includeRoot:null!==(n=t.includeRoot)&&void 0!==n&&n,xmlCharKey:null!==(o=t.xmlCharKey)&&void 0!==o?o:"_"},a=Qe.parseFromString(e,"application/xml");!function(e){var t=e.getElementsByTagName("parsererror");if(t.length>0&&function(){var e;if(void 0===Ke)try{Ke=null!==(e=Qe.parseFromString("INVALID","text/xml").getElementsByTagName("parsererror")[0].namespaceURI)&&void 0!==e?e:""}catch(e){Ke=""}return Ke}())for(var r=0;r<t.length;r++)if(t[r].namespaceURI===Ke)throw new Error(t[r].innerHTML)}(a);var s=void 0;return s=Je(i.includeRoot?a:a.childNodes[0],i),Promise.resolve(s)}catch(e){return Promise.reject(e)}}function Je(e,t){var r={},n=e.childNodes.length,o=e.childNodes[0],i=o&&1===n&&o.nodeType===Node.TEXT_NODE&&o.nodeValue||void 0,a=function(e){return function(e){return!!e.attributes}(e)&&e.hasAttributes()?e:void 0}(e);if(a){r[C]={};for(var s=0;s<a.attributes.length;s++){var c=a.attributes[s];r[C][c.nodeName]=c.nodeValue}i&&(r[t.xmlCharKey]=i)}else 0===n?r="":i&&(r=i);if(!i)for(s=0;s<n;s++){var u=e.childNodes[s];if(u.nodeType!==Node.TEXT_NODE){var l=Je(u,t);r[u.nodeName]?Array.isArray(r[u.nodeName])?r[u.nodeName].push(l):r[u.nodeName]=[r[u.nodeName],l]:r[u.nodeName]=l}}return r}var Xe=new XMLSerializer;function Ye(e,t){var r,n,o;void 0===t&&(t={});var i={rootName:null!==(r=t.rootName)&&void 0!==r?r:"root",includeRoot:null!==(n=t.includeRoot)&&void 0!==n&&n,xmlCharKey:null!==(o=t.xmlCharKey)&&void 0!==o?o:"_"},a=function e(t,r,n){if(null==t||"string"==typeof t||"number"==typeof t||"boolean"==typeof t)return(p=We.createElement(r)).textContent=null==t?"":t.toString(),[p];if(Array.isArray(t)){for(var o=[],i=0,a=t;i<a.length;i++)for(var s=a[i],c=0,u=e(s,r,n);c<u.length;c++){var l=u[c];o.push(l)}return o}if("object"==typeof t){for(var p=We.createElement(r),d=0,f=Object.keys(t);d<f.length;d++){var h=f[d];if(h===C)for(var y=0,g=Ze(t[h]);y<g.length;y++){var m=g[y];p.attributes.setNamedItem(m)}else if(h===n.xmlCharKey)p.textContent=t[h].toString();else for(var v=0,b=e(t[h],h,n);v<b.length;v++){l=b[v];p.appendChild(l)}}return[p]}throw new Error("Illegal value passed to buildObject: "+t)}(e,i.rootName,i)[0];return'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+Xe.serializeToString(a)}function Ze(e){for(var t=[],r=0,n=Object.keys(e);r<n.length;r++){var o=n[r],i=We.createAttribute(o);i.value=e[o].toString(),t.push(i)}return t}function et(e,t){return{create:function(r,n){return new ot(r,n,e,t)}}}var tt=["application/json","text/json"],rt=["application/xml","application/atom+xml"],nt={expectedContentTypes:{json:tt,xml:rt}},ot=function(e){function t(t,r,n,o){var i;void 0===o&&(o={});var a=e.call(this,t,r)||this;return a.jsonContentTypes=n&&n.json||tt,a.xmlContentTypes=n&&n.xml||rt,a.xmlCharKey=null!==(i=o.xmlCharKey)&&void 0!==i?i:"_",a}return i(t,e),t.prototype.sendRequest=function(e){return c(this,void 0,void 0,(function(){var t=this;return u(this,(function(r){return[2,this._nextPolicy.sendRequest(e).then((function(e){return function(e,t,r,n){var o,i,a;void 0===n&&(n={});var s={rootName:null!==(o=n.rootName)&&void 0!==o?o:"",includeRoot:null!==(i=n.includeRoot)&&void 0!==i&&i,xmlCharKey:null!==(a=n.xmlCharKey)&&void 0!==a?a:"_"};return function(e,t,r,n){var o,i=function(e){var t='Error "'+e+'" occurred while parsing the response body - '+r.bodyAsText+".",n=e.code||pe.PARSE_ERROR,o=new pe(t,n,r.status,r.request,r);return Promise.reject(o)};if(!(null===(o=r.request.streamResponseStatusCodes)||void 0===o?void 0:o.has(r.status))&&!r.request.streamResponseBody&&r.bodyAsText){var a=r.bodyAsText,s=r.headers.get("Content-Type")||"",c=s?s.split(";").map((function(e){return e.toLowerCase()})):[];if(0===c.length||c.some((function(t){return-1!==e.indexOf(t)})))return new Promise((function(e){r.parsedBody=JSON.parse(a),e(r)})).catch(i);if(c.some((function(e){return-1!==t.indexOf(e)})))return $e(a,n).then((function(e){return r.parsedBody=e,r})).catch(i)}return Promise.resolve(r)}(e,t,r,s).then((function(e){if(!function(e){var t,r=e.request.shouldDeserialize;t=void 0===r||("boolean"==typeof r?r:r(e));return t}(e))return e;var t=e.request.operationSpec;if(!t||!t.responses)return e;var o=function(e){var t,r=e.request,n=r.operationSpec;if(n){var o=r.operationResponseGetter;t=o?o(n,e):n.responses[e.status]}return t}(e),i=function(e,t,r){var n,o=200<=e.status&&e.status<300;if(function(e){var t=Object.keys(e.responses);return 0===t.length||1===t.length&&"default"===t[0]}(t)?o:r){if(!r)return{error:null,shouldReturnResponse:!1};if(!r.isError)return{error:null,shouldReturnResponse:!1}}var i=null!=r?r:t.responses.default,a=(null===(n=e.request.streamResponseStatusCodes)||void 0===n?void 0:n.has(e.status))||e.request.streamResponseBody?"Unexpected status code: "+e.status:e.bodyAsText,s=new pe(a,void 0,e.status,e.request,e);if(!i)throw s;var c=i.bodyMapper,u=i.headersMapper;try{if(e.parsedBody){var l=e.parsedBody,p=void 0;if(c){var d=l;t.isXML&&c.type.name===z.Sequence&&(d="object"==typeof l?l[c.xmlElementName]:[]),p=t.serializer.deserialize(c,d,"error.response.parsedBody")}var f=l.error||p||l;s.code=f.code,f.message&&(s.message=f.message),c&&(s.response.parsedBody=p)}e.headers&&u&&(s.response.parsedHeaders=t.serializer.deserialize(u,e.headers.rawHeaders(),"operationRes.parsedHeaders"))}catch(t){s.message='Error "'+t.message+'" occurred in deserializing the responseBody - "'+e.bodyAsText+'" for the default response.'}return{error:s,shouldReturnResponse:!1}}(e,t,o),a=i.error,s=i.shouldReturnResponse;if(a)throw a;if(s)return e;if(o){if(o.bodyMapper){var c=e.parsedBody;t.isXML&&o.bodyMapper.type.name===z.Sequence&&(c="object"==typeof c?c[o.bodyMapper.xmlElementName]:[]);try{e.parsedBody=t.serializer.deserialize(o.bodyMapper,c,"operationRes.parsedBody",n)}catch(t){throw new pe("Error "+t+" occurred in deserializing the responseBody - "+e.bodyAsText,void 0,e.status,e.request,e)}}else"HEAD"===t.httpMethod&&(e.parsedBody=r.status>=200&&r.status<300);o.headersMapper&&(e.parsedHeaders=t.serializer.deserialize(o.headersMapper,e.headers.rawHeaders(),"operationRes.parsedHeaders",n))}return e}))}(t.jsonContentTypes,t.xmlContentTypes,e,{xmlCharKey:t.xmlCharKey})}))]}))}))},t}(me);var it;function at(e){return"number"==typeof e}function st(e,t,r,n,o){return!!t(n,o)&&r.retryCount<e}function ct(e,t,r){void 0===t&&(t={retryCount:0,retryInterval:0}),r&&(t.error&&(r.innerError=t.error),t.error=r),t.retryCount++;var n=Math.pow(2,t.retryCount-1)-1;return n*=.8*e.retryInterval+Math.floor(Math.random()*(.4*e.retryInterval)),t.retryInterval=Math.min(e.minRetryInterval+n,e.maxRetryInterval),t}function ut(e,t,r){return{create:function(n,o){return new pt(n,o,e,t,r)}}}!function(e){e[e.Exponential=0]="Exponential"}(it||(it={}));var lt={maxRetries:3,retryDelayInMs:3e4,maxRetryDelayInMs:9e4},pt=function(e){function t(t,r,n,o,i){var a=e.call(this,t,r)||this;return a.retryCount=at(n)?n:3,a.retryInterval=at(o)?o:3e4,a.maxRetryInterval=at(i)?i:9e4,a}return i(t,e),t.prototype.sendRequest=function(e){var t=this;return this._nextPolicy.sendRequest(e.clone()).then((function(r){return dt(t,e,r)})).catch((function(r){return dt(t,e,r.response,void 0,r)}))},t}(me);function dt(e,t,r,n,o){return c(this,void 0,void 0,(function(){function i(e){var t=null==e?void 0:e.status;return!(void 0===t||t<500&&408!==t||501===t||505===t)}var a,s,c;return u(this,(function(u){switch(u.label){case 0:if(n=ct({retryInterval:e.retryInterval,minRetryInterval:0,maxRetryInterval:e.maxRetryInterval},n,o),(a=t.abortSignal&&t.abortSignal.aborted)||!st(e.retryCount,i,n,r))return[3,6];ze.info("Retrying request in "+n.retryInterval),u.label=1;case 1:return u.trys.push([1,4,,5]),[4,R(n.retryInterval)];case 2:return u.sent(),[4,e._nextPolicy.sendRequest(t.clone())];case 3:return s=u.sent(),[2,dt(e,t,s,n)];case 4:return c=u.sent(),[2,dt(e,t,r,n,c)];case 5:return[3,7];case 6:if(a||o||!r)throw n.error||new pe("Failed to send the request.",pe.REQUEST_SEND_ERROR,r&&r.status,r&&r.request,r);return[2,r];case 7:return[2]}}))}))}function ft(e){return void 0===e&&(e="x-ms-client-request-id"),{create:function(t,r){return new ht(t,r,e)}}}var ht=function(e){function t(t,r,n){var o=e.call(this,t,r)||this;return o._requestIdHeaderName=n,o}return i(t,e),t.prototype.sendRequest=function(e){return e.headers.contains(this._requestIdHeaderName)||e.headers.set(this._requestIdHeaderName,e.requestId),this._nextPolicy.sendRequest(e)},t}(me);function yt(){return"x-ms-useragent"}var gt=yt;function mt(){var e,t,r,n=[{key:"core-http",value:T}],o=function(){var e=self.navigator;return[{key:"OS",value:(e.oscpu||e.platform).replace(" ","")}]}();return e=n.concat(o),void 0===t&&(t=" "),void 0===r&&(r="/"),e.map((function(e){var t=e.value?""+r+e.value:"";return""+e.key+t})).join(t)}function vt(e){var t=e&&void 0!==e.key&&null!==e.key?e.key:"x-ms-useragent",r=e&&void 0!==e.value&&null!==e.value?e.value:mt();return{create:function(e,n){return new bt(e,n,t,r)}}}var bt=function(e){function t(t,r,n,o){var i=e.call(this,t,r)||this;return i._nextPolicy=t,i._options=r,i.headerKey=n,i.headerValue=o,i}return i(t,e),t.prototype.sendRequest=function(e){return this.addUserAgentHeader(e),this._nextPolicy.sendRequest(e)},t.prototype.addUserAgentHeader=function(e){e.headers||(e.headers=new n),!e.headers.get(this.headerKey)&&this.headerValue&&e.headers.set(this.headerKey,this.headerValue)},t}(me),wt=["GET","HEAD"],St={handleRedirects:!0,maxRetries:20};function Tt(e){return void 0===e&&(e=20),{create:function(t,r){return new Et(t,r,e)}}}var Et=function(e){function t(t,r,n){void 0===n&&(n=20);var o=e.call(this,t,r)||this;return o.maxRetries=n,o}return i(t,e),t.prototype.sendRequest=function(e){var t=this;return this._nextPolicy.sendRequest(e).then((function(e){return function e(t,r,n){var o=r.request,i=r.status,a=r.headers.get("location");if(a&&(300===i||301===i&&wt.includes(o.method)||302===i&&wt.includes(o.method)||303===i&&"POST"===o.method||307===i)&&(!t.maxRetries||n<t.maxRetries)){var s=X.parse(o.url);return s.setPath(a),o.url=s.toString(),303===i&&(o.method="GET",delete o.body),t._nextPolicy.sendRequest(o).then((function(r){return e(t,r,n+1)}))}return Promise.resolve(r)}(t,e,0)}))},t}(me);var It=function(e){function t(t,r,n){void 0===n&&(n=30);var o=e.call(this,t,r)||this;return o._retryTimeout=n,o}return i(t,e),t.prototype.sendRequest=function(e){var t=this;return this._nextPolicy.sendRequest(e.clone()).then((function(r){return function(e,t,r){if(409===r.status){var n=function(e){var t,r;if(e){try{r=JSON.parse(e)}catch(e){}if(r&&r.error&&r.error.message&&r.error.code&&"MissingSubscriptionRegistration"===r.error.code){var n=r.error.message.match(/.*'(.*)'/i);n&&(t=n.pop())}}return t}(r.bodyAsText);if(n){var o=function(e){var t,r=e.match(/.*\/subscriptions\/[a-f0-9-]+\//gi);if(!r||!r[0])throw new Error("Unable to extract subscriptionId from the given url - "+e+".");t=r[0];return t}(t.url);return function(e,t,r,n){var o=t+"providers/"+r+"/register?api-version=2016-02-01",i=t+"providers/"+r+"?api-version=2016-02-01",a=Ct(n);return a.method="POST",a.url=o,e._nextPolicy.sendRequest(a).then((function(t){if(200!==t.status)throw new Error("Autoregistration of "+r+" failed. Please try registering manually.");return function e(t,r,n){var o=Ct(n);return o.url=r,o.method="GET",t._nextPolicy.sendRequest(o).then((function(o){var i=o.parsedBody;return!(!o.parsedBody||!i.registrationState||"Registered"!==i.registrationState)||R(1e3*t._retryTimeout).then((function(){return e(t,r,n)}))}))}(e,i,n)}))}(e,o,n,t).catch((function(){return!1})).then((function(n){return n?(t.headers.set("x-ms-client-request-id",P()),e._nextPolicy.sendRequest(t.clone())):r}))}}return Promise.resolve(r)}(t,e,r)}))},t}(me);function Ct(e,t){void 0===t&&(t=!1);var r=e.clone();return t&&(r.url=e.url),r.headers.set("x-ms-client-request-id",P()),r.headers.set("Content-Type","application/json; charset=utf-8"),r}var At={forcedRefreshWindowInMs:1e3,retryIntervalInMs:3e3,refreshWindowInMs:12e4};function Ot(e,t,r){var n=this,o=null,i=null,a=s(s({},At),r),l={get isRefreshing(){return null!==o},get shouldRefresh(){var e;return!l.isRefreshing&&(null!==(e=null==i?void 0:i.expiresOnTimestamp)&&void 0!==e?e:0)-a.refreshWindowInMs<Date.now()},get mustRefresh(){return null===i||i.expiresOnTimestamp-a.forcedRefreshWindowInMs<Date.now()}};function p(r){var n;if(!l.isRefreshing){o=function(e,t,r){return c(this,void 0,void 0,(function(){function n(){return c(this,void 0,void 0,(function(){var t;return u(this,(function(n){switch(n.label){case 0:if(!(Date.now()<r))return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,e()];case 2:return[2,n.sent()];case 3:return n.sent(),[2,null];case 4:return[3,7];case 5:return[4,e()];case 6:if(null===(t=n.sent()))throw new Error("Failed to refresh access token.");return[2,t];case 7:return[2]}}))}))}var o;return u(this,(function(e){switch(e.label){case 0:return[4,n()];case 1:o=e.sent(),e.label=2;case 2:return null!==o?[3,5]:[4,R(t)];case 3:return e.sent(),[4,n()];case 4:return o=e.sent(),[3,2];case 5:return[2,o]}}))}))}((function(){return e.getToken(t,r)}),a.retryIntervalInMs,null!==(n=null==i?void 0:i.expiresOnTimestamp)&&void 0!==n?n:Date.now()).then((function(e){return o=null,i=e})).catch((function(e){throw o=null,i=null,e}))}return o}return function(e){return c(n,void 0,void 0,(function(){return u(this,(function(t){return l.mustRefresh?[2,p(e)]:(l.shouldRefresh&&p(e),[2,i])}))}))}}function Pt(e,t,r,n){return{create:function(o,i){return new _t(o,i,e,t,r,n)}}}var Rt,_t=function(e){function t(t,r,n,o,i,a){var s=e.call(this,t,r)||this;return s.retryCount=at(n)?n:3,s.retryInterval=at(o)?o:3e4,s.minRetryInterval=at(i)?i:3e3,s.maxRetryInterval=at(a)?a:9e4,s}return i(t,e),t.prototype.sendRequest=function(e){var t=this;return this._nextPolicy.sendRequest(e.clone()).catch((function(r){return function e(t,r,n,o,i){return c(this,void 0,void 0,(function(){function a(e,t){return!(!t||!t.code||"ETIMEDOUT"!==t.code&&"ESOCKETTIMEDOUT"!==t.code&&"ECONNREFUSED"!==t.code&&"ECONNRESET"!==t.code&&"ENOENT"!==t.code)}var s;return u(this,(function(c){switch(c.label){case 0:if(i=ct(t,i,o),!st(t.retryCount,a,i,n,o))return[3,5];c.label=1;case 1:return c.trys.push([1,3,,4]),[4,R(i.retryInterval)];case 2:return c.sent(),[2,t._nextPolicy.sendRequest(r.clone())];case 3:return s=c.sent(),[2,e(t,r,n,s,i)];case 4:return[3,6];case 5:return o?[2,Promise.reject(i.error)]:[2,n];case 6:return[2]}}))}))}(t,e,r.response,r)}))},t}(me);!function(e){e.Csv=",",e.Ssv=" ",e.Tsv="\t",e.Pipes="|",e.Multi="Multi"}(Rt||(Rt={}));var Nt=new Error("ProxyPolicy is not supported in browser environment");function kt(e){return{create:function(e,t){throw Nt}}}!function(e){function t(t,r){throw e.call(this,t,r),Nt}i(t,e),t.prototype.sendRequest=function(e){throw Nt}}(me);var xt=E.StatusCodes;function jt(){return{create:function(e,t){return new Mt(e,t)}}}var Mt=function(e){function t(t,r,n){var o=e.call(this,t,r)||this;return o._handleResponse=n||o._defaultResponseHandler,o}return i(t,e),t.prototype.sendRequest=function(e){return c(this,void 0,void 0,(function(){var t=this;return u(this,(function(r){return[2,this._nextPolicy.sendRequest(e.clone()).then((function(r){return r.status!==xt.TooManyRequests?r:t._handleResponse(e,r)}))]}))}))},t.prototype._defaultResponseHandler=function(e,r){return c(this,void 0,void 0,(function(){var n,o,i=this;return u(this,(function(a){return(n=r.headers.get(I.RETRY_AFTER))&&(o=t.parseRetryAfterHeader(n))?[2,R(o).then((function(t){return i._nextPolicy.sendRequest(e)}))]:[2,r]}))}))},t.parseRetryAfterHeader=function(e){var r=Number(e);return Number.isNaN(r)?t.parseDateRetryAfterHeader(e):1e3*r},t.parseDateRetryAfterHeader=function(e){try{var t=Date.now(),r=Date.parse(e)-t;return Number.isNaN(r)?void 0:r}catch(e){return}},t}(me);var qt=function(e){function t(t,r,n){var o=e.call(this,t,r)||this;return o.authenticationProvider=n,o}return i(t,e),t.prototype.signRequest=function(e){return this.authenticationProvider.signRequest(e)},t.prototype.sendRequest=function(e){var t=this;return this.signRequest(e).then((function(e){return t._nextPolicy.sendRequest(e)}))},t}(me),Dt={enable:!0};var Lt=function(e){function t(t,r,n){var o=e.call(this,t,r)||this;return o.keepAliveOptions=n,o}return i(t,e),t.prototype.sendRequest=function(e){return c(this,void 0,void 0,(function(){return u(this,(function(t){return e.keepAlive=this.keepAliveOptions.enable,[2,this._nextPolicy.sendRequest(e)]}))}))},t}(me),Ut=function(){function e(){}return e.prototype.context=function(){return{spanId:"",traceId:"",traceFlags:0}},e.prototype.end=function(e){},e.prototype.setAttribute=function(e,t){return this},e.prototype.setAttributes=function(e){return this},e.prototype.addEvent=function(e,t){return this},e.prototype.setStatus=function(e){return this},e.prototype.updateName=function(e){return this},e.prototype.isRecording=function(){return!1},e.prototype.recordException=function(e,t){},e}(),Ht=function(){function e(){}return e.prototype.startSpan=function(e,t){return new Ut},e.prototype.getCurrentSpan=function(){return new Ut},e.prototype.withSpan=function(e,t){return t()},e.prototype.bind=function(e,t){return e},e}();var zt,Ft,Vt=Symbol.for("@azure/core-tracing.tracerCache3");function Bt(){var e=self,t=e[Vt],r=!0;if(t)if(4===t.version)zt=t;else if(r=!1,t.tracer)throw new Error("Two incompatible versions of @azure/core-tracing have been loaded.\n          This library is 4, existing is "+t.version+".");zt||(zt={tracer:void 0,version:4}),r&&(e[Vt]=zt)}function Gt(){return zt||Bt(),zt}function Kt(){var e=Gt();return e.tracer?e.tracer:(Ft||(Ft=new Ht),Ft)}var Wt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function Qt(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function $t(e,t){return e(t={exports:{}},t.exports),t.exports}var Jt=$t((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.BaggageImpl=void 0;var r=function(){function e(e){this._entries=e?new Map(e):new Map}return e.prototype.getEntry=function(e){var t=this._entries.get(e);if(t)return Object.assign({},t)},e.prototype.getAllEntries=function(){return Array.from(this._entries.entries()).map((function(e){return[e[0],e[1]]}))},e.prototype.setEntry=function(t,r){var n=new e(this._entries);return n._entries.set(t,r),n},e.prototype.removeEntry=function(t){var r=new e(this._entries);return r._entries.delete(t),r},e.prototype.removeEntries=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(var n=new e(this._entries),o=0,i=t;o<i.length;o++){var a=i[o];n._entries.delete(a)}return n},e.prototype.clear=function(){return new e},e}();t.BaggageImpl=r}));Qt(Jt),Jt.BaggageImpl;var Xt=$t((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.baggageEntryMetadataSymbol=void 0,t.baggageEntryMetadataSymbol=Symbol("BaggageEntryMetadata")}));Qt(Xt),Xt.baggageEntryMetadataSymbol;var Yt=$t((function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}));Qt(Yt);var Zt=$t((function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}));Qt(Zt);var er=$t((function(e,t){var r=Wt&&Wt.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),n=Wt&&Wt.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.baggageEntryMetadataFromString=t.createBaggage=void 0,n(Yt,t),n(Zt,t),t.createBaggage=function(e){return void 0===e&&(e={}),new Jt.BaggageImpl(new Map(Object.entries(e)))},t.baggageEntryMetadataFromString=function(e){return"string"!=typeof e&&(e=""),{__TYPE__:Xt.baggageEntryMetadataSymbol,toString:function(){return e}}}}));Qt(er),er.baggageEntryMetadataFromString,er.createBaggage;var tr=$t((function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}));Qt(tr);var rr=$t((function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}));Qt(rr);var nr=$t((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.DiagConsoleLogger=void 0;var r=[{n:"error",c:"error"},{n:"warn",c:"warn"},{n:"info",c:"info"},{n:"debug",c:"debug"},{n:"verbose",c:"trace"}],n=function(){function e(e){return function(){var t=arguments;if(console){var r=console[e];if("function"!=typeof r&&(r=console.log),"function"==typeof r)return r.apply(console,t)}}}for(var t=0;t<r.length;t++)this[r[t].n]=e(r[t].c)};t.DiagConsoleLogger=n}));Qt(nr),nr.DiagConsoleLogger;var or=$t((function(e,t){var r;Object.defineProperty(t,"__esModule",{value:!0}),t.DiagLogLevel=void 0,(r=t.DiagLogLevel||(t.DiagLogLevel={}))[r.NONE=0]="NONE",r[r.ERROR=30]="ERROR",r[r.WARN=50]="WARN",r[r.INFO=60]="INFO",r[r.DEBUG=70]="DEBUG",r[r.VERBOSE=80]="VERBOSE",r[r.ALL=9999]="ALL"}));Qt(or),or.DiagLogLevel;var ir=$t((function(e,t){var r=Wt&&Wt.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),n=Wt&&Wt.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),n(nr,t),n(or,t)}));Qt(ir);var ar=$t((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.NOOP_TEXT_MAP_PROPAGATOR=t.NoopTextMapPropagator=void 0;var r=function(){function e(){}return e.prototype.inject=function(e,t){},e.prototype.extract=function(e,t){return e},e.prototype.fields=function(){return[]},e}();t.NoopTextMapPropagator=r,t.NOOP_TEXT_MAP_PROPAGATOR=new r}));Qt(ar),ar.NOOP_TEXT_MAP_PROPAGATOR,ar.NoopTextMapPropagator;var sr=$t((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.defaultTextMapSetter=t.defaultTextMapGetter=void 0,t.defaultTextMapGetter={get:function(e,t){if(null!=e)return e[t]},keys:function(e){return null==e?[]:Object.keys(e)}},t.defaultTextMapSetter={set:function(e,t,r){null!=e&&(e[t]=r)}}}));Qt(sr),sr.defaultTextMapSetter,sr.defaultTextMapGetter;var cr=$t((function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}));Qt(cr);var ur=$t((function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}));Qt(ur);var lr=$t((function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}));Qt(lr);var pr=$t((function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}));Qt(pr);var dr=$t((function(e,t){var r;Object.defineProperty(t,"__esModule",{value:!0}),t.TraceFlags=void 0,(r=t.TraceFlags||(t.TraceFlags={}))[r.NONE=0]="NONE",r[r.SAMPLED=1]="SAMPLED"}));Qt(dr),dr.TraceFlags;var fr=$t((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isSpanContextValid=t.isValidSpanId=t.isValidTraceId=t.INVALID_SPAN_CONTEXT=t.INVALID_TRACEID=t.INVALID_SPANID=void 0;var r=/^([0-9a-f]{32})$/i,n=/^[0-9a-f]{16}$/i;function o(e){return r.test(e)&&e!==t.INVALID_TRACEID}function i(e){return n.test(e)&&e!==t.INVALID_SPANID}t.INVALID_SPANID="0000000000000000",t.INVALID_TRACEID="00000000000000000000000000000000",t.INVALID_SPAN_CONTEXT={traceId:t.INVALID_TRACEID,spanId:t.INVALID_SPANID,traceFlags:dr.TraceFlags.NONE},t.isValidTraceId=o,t.isValidSpanId=i,t.isSpanContextValid=function(e){return o(e.traceId)&&i(e.spanId)}}));Qt(fr),fr.isSpanContextValid,fr.isValidSpanId,fr.isValidTraceId,fr.INVALID_SPAN_CONTEXT,fr.INVALID_TRACEID,fr.INVALID_SPANID;var hr=$t((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.NoopSpan=void 0;var r=function(){function e(e){void 0===e&&(e=fr.INVALID_SPAN_CONTEXT),this._spanContext=e}return e.prototype.context=function(){return this._spanContext},e.prototype.setAttribute=function(e,t){return this},e.prototype.setAttributes=function(e){return this},e.prototype.addEvent=function(e,t){return this},e.prototype.setStatus=function(e){return this},e.prototype.updateName=function(e){return this},e.prototype.end=function(e){},e.prototype.isRecording=function(){return!1},e.prototype.recordException=function(e,t){},e}();t.NoopSpan=r}));Qt(hr),hr.NoopSpan;var yr=$t((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ROOT_CONTEXT=t.createContextKey=t.setBaggage=t.getBaggage=t.isInstrumentationSuppressed=t.unsuppressInstrumentation=t.suppressInstrumentation=t.getSpanContext=t.setSpanContext=t.setSpan=t.getSpan=void 0;var r=s("OpenTelemetry Context Key SPAN"),n=s("OpenTelemetry Context Key SUPPRESS_INSTRUMENTATION"),o=s("OpenTelemetry Baggage Key");function i(e){return e.getValue(r)||void 0}function a(e,t){return e.setValue(r,t)}function s(e){return Symbol.for(e)}t.getSpan=i,t.setSpan=a,t.setSpanContext=function(e,t){return a(e,new hr.NoopSpan(t))},t.getSpanContext=function(e){var t;return null===(t=i(e))||void 0===t?void 0:t.context()},t.suppressInstrumentation=function(e){return e.setValue(n,!0)},t.unsuppressInstrumentation=function(e){return e.setValue(n,!1)},t.isInstrumentationSuppressed=function(e){return Boolean(e.getValue(n))},t.getBaggage=function(e){return e.getValue(o)||void 0},t.setBaggage=function(e,t){return e.setValue(o,t)},t.createContextKey=s;var c=function e(t){var r=this;r._currentContext=t?new Map(t):new Map,r.getValue=function(e){return r._currentContext.get(e)},r.setValue=function(t,n){var o=new e(r._currentContext);return o._currentContext.set(t,n),o},r.deleteValue=function(t){var n=new e(r._currentContext);return n._currentContext.delete(t),n}};t.ROOT_CONTEXT=new c}));Qt(yr),yr.ROOT_CONTEXT,yr.createContextKey,yr.setBaggage,yr.getBaggage,yr.isInstrumentationSuppressed,yr.unsuppressInstrumentation,yr.suppressInstrumentation,yr.getSpanContext,yr.setSpanContext,yr.setSpan,yr.getSpan;var gr=$t((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.NOOP_TRACER=t.NoopTracer=void 0;var r=function(){function e(){}return e.prototype.startSpan=function(e,t,r){if(Boolean(null==t?void 0:t.root))return new hr.NoopSpan;var n,o=r&&yr.getSpanContext(r);return"object"==typeof(n=o)&&"string"==typeof n.spanId&&"string"==typeof n.traceId&&"number"==typeof n.traceFlags&&fr.isSpanContextValid(o)?new hr.NoopSpan(o):new hr.NoopSpan},e}();t.NoopTracer=r,t.NOOP_TRACER=new r}));Qt(gr),gr.NOOP_TRACER,gr.NoopTracer;var mr=$t((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.NOOP_TRACER_PROVIDER=t.NoopTracerProvider=void 0;var r=function(){function e(){}return e.prototype.getTracer=function(e,t){return gr.NOOP_TRACER},e}();t.NoopTracerProvider=r,t.NOOP_TRACER_PROVIDER=new r}));Qt(mr),mr.NOOP_TRACER_PROVIDER,mr.NoopTracerProvider;var vr=$t((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ProxyTracer=void 0;var r=function(){function e(e,t,r){this._provider=e,this.name=t,this.version=r}return e.prototype.startSpan=function(e,t,r){return this._getTracer().startSpan(e,t,r)},e.prototype._getTracer=function(){if(this._delegate)return this._delegate;var e=this._provider.getDelegateTracer(this.name,this.version);return e?(this._delegate=e,this._delegate):gr.NOOP_TRACER},e}();t.ProxyTracer=r}));Qt(vr),vr.ProxyTracer;var br=$t((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ProxyTracerProvider=void 0;var r=function(){function e(){}return e.prototype.getTracer=function(e,t){var r;return null!==(r=this.getDelegateTracer(e,t))&&void 0!==r?r:new vr.ProxyTracer(this,e,t)},e.prototype.getDelegate=function(){var e;return null!==(e=this._delegate)&&void 0!==e?e:mr.NOOP_TRACER_PROVIDER},e.prototype.setDelegate=function(e){this._delegate=e},e.prototype.getDelegateTracer=function(e,t){var r;return null===(r=this._delegate)||void 0===r?void 0:r.getTracer(e,t)},e}();t.ProxyTracerProvider=r}));Qt(br),br.ProxyTracerProvider;var wr=$t((function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}));Qt(wr);var Sr=$t((function(e,t){var r;Object.defineProperty(t,"__esModule",{value:!0}),t.SamplingDecision=void 0,(r=t.SamplingDecision||(t.SamplingDecision={}))[r.NOT_RECORD=0]="NOT_RECORD",r[r.RECORD=1]="RECORD",r[r.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"}));Qt(Sr),Sr.SamplingDecision;var Tr=$t((function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}));Qt(Tr);var Er=$t((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.SpanKind=void 0,function(e){e[e.INTERNAL=0]="INTERNAL",e[e.SERVER=1]="SERVER",e[e.CLIENT=2]="CLIENT",e[e.PRODUCER=3]="PRODUCER",e[e.CONSUMER=4]="CONSUMER"}(t.SpanKind||(t.SpanKind={}))}));Qt(Er),Er.SpanKind;var Ir=$t((function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}));Qt(Ir);var Cr=$t((function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}));Qt(Cr);var Ar=$t((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.SpanStatusCode=void 0,function(e){e[e.UNSET=0]="UNSET",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR"}(t.SpanStatusCode||(t.SpanStatusCode={}))}));Qt(Ar),Ar.SpanStatusCode;var Or=$t((function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}));Qt(Or);var Pr=$t((function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}));Qt(Pr);var Rr=$t((function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}));Qt(Rr);var _r=$t((function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}));Qt(_r);var Nr=$t((function(e,t){var r=Wt&&Wt.__spreadArrays||function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n};Object.defineProperty(t,"__esModule",{value:!0}),t.NoopContextManager=void 0;var n=function(){function e(){}return e.prototype.active=function(){return yr.ROOT_CONTEXT},e.prototype.with=function(e,t,n){for(var o=[],i=3;i<arguments.length;i++)o[i-3]=arguments[i];return t.call.apply(t,r([n],o))},e.prototype.bind=function(e,t){return e},e.prototype.enable=function(){return this},e.prototype.disable=function(){return this},e}();t.NoopContextManager=n}));Qt(Nr),Nr.NoopContextManager;var kr=$t((function(e,t){Object.defineProperty(t,"__esModule",{value:!0})}));Qt(kr);var xr=$t((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t._globalThis=void 0,t._globalThis="object"==typeof globalThis?globalThis:window}));Qt(xr),xr._globalThis;var jr=$t((function(e,t){var r=Wt&&Wt.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),n=Wt&&Wt.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),n(xr,t)}));Qt(jr);var Mr=$t((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.VERSION=void 0,t.VERSION="1.0.0-rc.0"}));Qt(Mr),Mr.VERSION;var qr=$t((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isCompatible=t._makeCompatibilityCheck=void 0;var r=/^(\d+)\.(\d+)\.(\d+)(?:-(.*))?$/;function n(e){var t=new Set([e]),n=new Set,o=e.match(r);if(!o)return function(){return!1};var i=+o[1],a=+o[2],s=+o[3];function c(e){return n.add(e),!1}function u(e){return t.add(e),!0}return function(e){if(t.has(e))return!0;if(n.has(e))return!1;var o=e.match(r);if(!o)return c(e);var l=+o[1],p=+o[2],d=+o[3];return i!==l?c(e):0===i?a===p&&s<=d?u(e):c(e):a<=p?u(e):c(e)}}t._makeCompatibilityCheck=n,t.isCompatible=n(Mr.VERSION)}));Qt(qr),qr.isCompatible,qr._makeCompatibilityCheck;var Dr=$t((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.unregisterGlobal=t.getGlobal=t.registerGlobal=void 0;var r=Mr.VERSION.split(".")[0],n=Symbol.for("io.opentelemetry.js.api."+r),o=jr._globalThis;t.registerGlobal=function(e,t,r){var i;void 0===r&&(r=!1),o[n]=null!==(i=o[n])&&void 0!==i?i:{version:Mr.VERSION};var a=o[n];if(r||!a[e])if(a.version===Mr.VERSION)a[e]=t;else{s=new Error("@opentelemetry/api: All API registration versions must match");Vr.diag.error(s.stack||s.message)}else{var s=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+e);Vr.diag.error(s.stack||s.message)}},t.getGlobal=function(e){var t,r,i=null===(t=o[n])||void 0===t?void 0:t.version;if(i&&qr.isCompatible(i))return null===(r=o[n])||void 0===r?void 0:r[e]},t.unregisterGlobal=function(e){var t=o[n];t&&delete t[e]}}));Qt(Dr),Dr.unregisterGlobal,Dr.getGlobal,Dr.registerGlobal;var Lr=$t((function(e,t){var r=Wt&&Wt.__spreadArrays||function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n};Object.defineProperty(t,"__esModule",{value:!0}),t.ContextAPI=void 0;var n=new Nr.NoopContextManager,o=function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalContextManager=function(e){return Dr.registerGlobal("context",e),e},e.prototype.active=function(){return this._getContextManager().active()},e.prototype.with=function(e,t,n){for(var o,i=[],a=3;a<arguments.length;a++)i[a-3]=arguments[a];return(o=this._getContextManager()).with.apply(o,r([e,t,n],i))},e.prototype.bind=function(e,t){return void 0===t&&(t=this.active()),this._getContextManager().bind(e,t)},e.prototype._getContextManager=function(){return Dr.getGlobal("context")||n},e.prototype.disable=function(){this._getContextManager().disable(),Dr.unregisterGlobal("context")},e}();t.ContextAPI=o}));Qt(Lr),Lr.ContextAPI;var Ur=$t((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.TraceAPI=void 0;var r=function(){function e(){this._proxyTracerProvider=new br.ProxyTracerProvider,this.isSpanContextValid=fr.isSpanContextValid}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalTracerProvider=function(e){return this._proxyTracerProvider.setDelegate(e),Dr.registerGlobal("trace",this._proxyTracerProvider),this._proxyTracerProvider},e.prototype.getTracerProvider=function(){return Dr.getGlobal("trace")||this._proxyTracerProvider},e.prototype.getTracer=function(e,t){return this.getTracerProvider().getTracer(e,t)},e.prototype.disable=function(){Dr.unregisterGlobal("trace"),this._proxyTracerProvider=new br.ProxyTracerProvider},e}();t.TraceAPI=r}));Qt(Ur),Ur.TraceAPI;var Hr=$t((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.PropagationAPI=void 0;var r=function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalPropagator=function(e){return Dr.registerGlobal("propagation",e),e},e.prototype.inject=function(e,t,r){return void 0===r&&(r=sr.defaultTextMapSetter),this._getGlobalPropagator().inject(e,t,r)},e.prototype.extract=function(e,t,r){return void 0===r&&(r=sr.defaultTextMapGetter),this._getGlobalPropagator().extract(e,t,r)},e.prototype.fields=function(){return this._getGlobalPropagator().fields()},e.prototype.disable=function(){Dr.unregisterGlobal("propagation")},e.prototype._getGlobalPropagator=function(){return Dr.getGlobal("propagation")||ar.NOOP_TEXT_MAP_PROPAGATOR},e}();t.PropagationAPI=r}));Qt(Hr),Hr.PropagationAPI;var zr=$t((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.createLogLevelDiagLogger=void 0,t.createLogLevelDiagLogger=function(e,t){function r(r,n){var o=t[r];return"function"==typeof o&&e>=n?o.bind(t):function(){}}return e<or.DiagLogLevel.NONE?e=or.DiagLogLevel.NONE:e>or.DiagLogLevel.ALL&&(e=or.DiagLogLevel.ALL),t=t||{},{error:r("error",or.DiagLogLevel.ERROR),warn:r("warn",or.DiagLogLevel.WARN),info:r("info",or.DiagLogLevel.INFO),debug:r("debug",or.DiagLogLevel.DEBUG),verbose:r("verbose",or.DiagLogLevel.VERBOSE)}}}));Qt(zr),zr.createLogLevelDiagLogger;var Fr=$t((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.DiagAPI=void 0;var r=function(){function e(){function e(e){return function(){var t=Dr.getGlobal("diag");if(t)return t[e].apply(t,arguments)}}var t=this;t.setLogger=function(e,r){var n;if(void 0===r&&(r=or.DiagLogLevel.INFO),e!==t)Dr.registerGlobal("diag",zr.createLogLevelDiagLogger(r,e),!0);else{var o=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");t.error(null!==(n=o.stack)&&void 0!==n?n:o.message)}},t.disable=function(){Dr.unregisterGlobal("diag")},t.verbose=e("verbose"),t.debug=e("debug"),t.info=e("info"),t.warn=e("warn"),t.error=e("error")}return e.instance=function(){return this._instance||(this._instance=new e),this._instance},e}();t.DiagAPI=r}));Qt(Fr),Fr.DiagAPI;var Vr=$t((function(e,t){var r=Wt&&Wt.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),n=Wt&&Wt.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.diag=t.propagation=t.trace=t.context=t.isValidSpanId=t.isValidTraceId=t.isSpanContextValid=t.INVALID_SPAN_CONTEXT=t.INVALID_TRACEID=t.INVALID_SPANID=void 0,n(er,t),n(tr,t),n(rr,t),n(ir,t),n(ar,t),n(sr,t),n(cr,t),n(ur,t),n(lr,t),n(pr,t),n(gr,t),n(mr,t),n(vr,t),n(br,t),n(wr,t),n(Sr,t),n(Tr,t),n(Er,t),n(Ir,t),n(Cr,t),n(Ar,t),n(Or,t),n(dr,t),n(Pr,t),n(Rr,t),n(_r,t),Object.defineProperty(t,"INVALID_SPANID",{enumerable:!0,get:function(){return fr.INVALID_SPANID}}),Object.defineProperty(t,"INVALID_TRACEID",{enumerable:!0,get:function(){return fr.INVALID_TRACEID}}),Object.defineProperty(t,"INVALID_SPAN_CONTEXT",{enumerable:!0,get:function(){return fr.INVALID_SPAN_CONTEXT}}),Object.defineProperty(t,"isSpanContextValid",{enumerable:!0,get:function(){return fr.isSpanContextValid}}),Object.defineProperty(t,"isValidTraceId",{enumerable:!0,get:function(){return fr.isValidTraceId}}),Object.defineProperty(t,"isValidSpanId",{enumerable:!0,get:function(){return fr.isValidSpanId}}),n(yr,t),n(Nr,t),n(kr,t),t.context=Lr.ContextAPI.getInstance(),t.trace=Ur.TraceAPI.getInstance(),t.propagation=Hr.PropagationAPI.getInstance(),t.diag=Fr.DiagAPI.instance(),t.default={trace:t.trace,context:t.context,propagation:t.propagation,diag:t.diag}}));Qt(Vr),Vr.SpanKind,Vr.TraceFlags,Vr.getSpan;var Br=Vr.setSpan;Vr.SpanStatusCode,Vr.getSpanContext,Vr.setSpanContext,Vr.diag,Vr.propagation,Vr.trace;var Gr,Kr=Vr.context;function Wr(e,t){return Br(e,t)}Vr.isValidSpanId,Vr.isValidTraceId,Vr.isSpanContextValid,Vr.INVALID_SPAN_CONTEXT,Vr.INVALID_TRACEID,Vr.INVALID_SPANID,function(e){e[e.INTERNAL=0]="INTERNAL",e[e.SERVER=1]="SERVER",e[e.CLIENT=2]="CLIENT",e[e.PRODUCER=3]="PRODUCER",e[e.CONSUMER=4]="CONSUMER"}(Gr||(Gr={}));var Qr,$r=Kr;function Jr(e){return function(t,r){var n=Kt(),o=(null==r?void 0:r.tracingOptions)||{},i=s({kind:Gr.INTERNAL},o.spanOptions),a=e.packagePrefix?e.packagePrefix+"."+t:t,c=n.startSpan(a,i,o.tracingContext);e.namespace&&c.setAttribute("az.namespace",e.namespace);var u=o.spanOptions||{};c.isRecording()&&e.namespace&&(u=s(s({},o.spanOptions),{attributes:s(s({},i.attributes),{"az.namespace":e.namespace})}));var l=s(s({},o),{spanOptions:u,tracingContext:Wr(o.tracingContext||$r.active(),c)});return{span:c,updatedOptions:s(s({},r),{tracingOptions:l})}}}!function(e){e[e.UNSET=0]="UNSET",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR"}(Qr||(Qr={}));var Xr=Jr({packagePrefix:"",namespace:""});var Yr=function(e){function t(t,r,n){var o=e.call(this,t,r)||this;return o.userAgent=n.userAgent,o}return i(t,e),t.prototype.sendRequest=function(e){return c(this,void 0,void 0,(function(){var t,r,n,o,i,a,c,l;return u(this,(function(u){switch(u.label){case 0:if(!e.tracingContext)return[2,this._nextPolicy.sendRequest(e)];t=X.parse(e.url).getPath()||"/",(r=Xr(t,{tracingOptions:{spanOptions:s(s({},e.spanOptions),{kind:Gr.CLIENT}),tracingContext:e.tracingContext}}).span).setAttributes({"http.method":e.method,"http.url":e.url,requestId:e.requestId}),this.userAgent&&r.setAttribute("http.user_agent",this.userAgent),u.label=1;case 1:return u.trys.push([1,3,,4]),n=r.context(),(o=function(e){var t=[];if(e.traceId||t.push("traceId"),e.spanId||t.push("spanId"),!t.length){var r=(e.traceFlags||0).toString(16),n=1===r.length?"0"+r:r;return"00-"+e.traceId+"-"+e.spanId+"-"+n}}(n))&&(e.headers.set("traceparent",o),(i=n.traceState&&n.traceState.serialize())&&e.headers.set("tracestate",i)),[4,this._nextPolicy.sendRequest(e)];case 2:return a=u.sent(),r.setAttribute("http.status_code",a.status),(c=a.headers.get("x-ms-request-id"))&&r.setAttribute("serviceRequestId",c),r.end(),[2,a];case 3:throw l=u.sent(),r.end(),l;case 4:return[2]}}))}))},t}(me),Zr=new Error("DisableResponseDecompressionPolicy is not supported in browser environment");!function(e){function t(t,r){throw e.call(this,t,r),Zr}i(t,e),t.prototype.sendRequest=function(e){return c(this,void 0,void 0,(function(){return u(this,(function(e){throw Zr}))}))}}(me);var en,tn=function(e){function t(t,r){return e.call(this,t,r)||this}return i(t,e),t.prototype.sendRequest=function(e){return c(this,void 0,void 0,(function(){var t;return u(this,(function(r){return"string"==typeof e.body&&e.body.startsWith("[")&&(t=JSON.parse(e.body),Array.isArray(t)&&(e.body=t.map((function(e){return JSON.stringify(e)+"\n"})).join(""))),[2,this._nextPolicy.sendRequest(e)]}))}))},t}(me);var rn=function(){function e(e,t){var r,n,o,a,s,l,p=this;if(t||(t={}),this._withCredentials=t.withCredentials||!1,this._httpClient=t.httpClient||(en||(en=new de),en),this._requestPolicyOptions=new ve(t.httpPipelineLogger),Array.isArray(t.requestPolicyFactories))ze.info("ServiceClient: using custom request policies"),r=t.requestPolicyFactories;else{var d=void 0;if((l=e)&&"function"==typeof l.getToken&&(void 0===l.signRequest||l.getToken.length>0)){ze.info("ServiceClient: creating bearer token authentication policy from provided credentials");o=void 0,a=p,s=t,d={create:function(t,r){var n=function(e,t){if(null==e?void 0:e.credentialScopes){var r=e.credentialScopes;return Array.isArray(r)?r.map((function(e){return new $(e).toString()})):new $(r).toString()}if(t)return t+"/.default"}(s,a.baseUri);if(!n)throw new Error("When using credential, the ServiceClient must contain a baseUri or a credentialScopes in ServiceClientOptions. Unable to create a bearerTokenAuthenticationPolicy");return null==o&&(o=function(e,t){var r=Ot(e,t),n=function(e){function t(t,r){return e.call(this,t,r)||this}return i(t,e),t.prototype.sendRequest=function(e){return c(this,void 0,void 0,(function(){var t;return u(this,(function(n){switch(n.label){case 0:return[4,r({abortSignal:e.abortSignal,tracingOptions:{spanOptions:e.spanOptions,tracingContext:e.tracingContext}})];case 1:return t=n.sent().token,e.headers.set(I.AUTHORIZATION,"Bearer "+t),[2,this._nextPolicy.sendRequest(e)]}}))}))},t}(me);return{create:function(e,t){return new n(e,t)}}}(e,n)),o.create(t,r)}}}else if(e&&"function"==typeof e.signRequest)ze.info("ServiceClient: creating signing policy from provided credentials"),n=e,d={create:function(e,t){return new qt(e,t,n)}};else if(null!=e)throw new Error("The credentials argument must implement the TokenCredential interface");if(ze.info("ServiceClient: using default request policies"),r=function(e,t){var r=[];t.generateClientRequestIdHeader&&r.push(ft(t.clientRequestIdHeaderName));e&&r.push(e);var n=nn(t.userAgentHeaderName,gt),o=nn(t.userAgent,mt);n&&o&&r.push(vt({key:n,value:o}));r.push(Tt()),r.push(function(e){return void 0===e&&(e=30),{create:function(t,r){return new It(t,r,e)}}}(t.rpRegistrationRetryTimeout)),t.noRetryPolicy||(r.push(ut()),r.push(Pt()),r.push(jt()));r.push(et(t.deserializationContentTypes)),O&&r.push(kt(t.proxySettings));return r.push(Fe({logger:ze.info})),r}(d,t),t.requestPolicyFactories){var f=t.requestPolicyFactories(r);f&&(r=f)}}this._requestPolicyFactories=r}return e.prototype.sendRequest=function(e){if(null==e||"object"!=typeof e)throw new Error("options cannot be null or undefined and it must be of type object.");var t;try{!function(e){if(e&&"object"==typeof e){var t=e;if("string"==typeof t.url&&"string"==typeof t.method&&"object"==typeof t.headers&&r(t.headers)&&"function"==typeof t.validateRequestProperties&&"function"==typeof t.prepare&&"function"==typeof t.clone)return!0}return!1}(e)?t=(t=new F).prepare(e):(e.validateRequestProperties(),t=e)}catch(e){return Promise.reject(e)}var n=this._httpClient;if(this._requestPolicyFactories&&this._requestPolicyFactories.length>0)for(var o=this._requestPolicyFactories.length-1;o>=0;--o)n=this._requestPolicyFactories[o].create(n,this._requestPolicyOptions);return n.sendRequest(t)},e.prototype.sendOperationRequest=function(e,t,r){var n;return c(this,void 0,void 0,(function(){var o,i,a,s,c,l,p,d,f,h,y,g,m,v,b,w,S,T,E,I,A,O,P,R,_,N,k,x,j,M,q;return u(this,(function(u){switch(u.label){case 0:"function"==typeof e.options&&(r=e.options,e.options=void 0),o=null===(n=e.options)||void 0===n?void 0:n.serializerOptions,i=new F,u.label=1;case 1:if(u.trys.push([1,6,,7]),!(s=t.baseUrl||this.baseUri))throw new Error("If operationSpec.baseUrl is not specified, then the ServiceClient must have a baseUri string property that contains the base URL to use.");if(i.method=t.httpMethod,i.operationSpec=t,c=X.parse(s),t.path&&c.appendPath(t.path),t.urlParameters&&t.urlParameters.length>0)for(l=0,p=t.urlParameters;l<p.length;l++)d=p[l],f=an(this,e,d,t.serializer),f=t.serializer.serialize(d.mapper,f,Be(d),o),d.skipEncoding||(f=encodeURIComponent(f)),c.replaceAll("{"+(d.mapper.serializedName||Be(d))+"}",f);if(t.queryParameters&&t.queryParameters.length>0)for(h=0,y=t.queryParameters;h<y.length;h++)if(g=y[h],null!=(m=an(this,e,g,t.serializer))){if(m=t.serializer.serialize(g.mapper,m,Be(g),o),void 0!==g.collectionFormat&&null!==g.collectionFormat)if(g.collectionFormat===Rt.Multi){if(0===m.length)continue;for(b in m)v=m[b],m[b]=null==v?"":v.toString()}else g.collectionFormat!==Rt.Ssv&&g.collectionFormat!==Rt.Tsv||(m=m.join(g.collectionFormat));if(!g.skipEncoding)if(Array.isArray(m))for(b in m)void 0!==m[b]&&null!==m[b]&&(m[b]=encodeURIComponent(m[b]));else m=encodeURIComponent(m);void 0!==g.collectionFormat&&null!==g.collectionFormat&&g.collectionFormat!==Rt.Multi&&g.collectionFormat!==Rt.Ssv&&g.collectionFormat!==Rt.Tsv&&(m=m.join(g.collectionFormat)),c.setQueryParameter(g.mapper.serializedName||Be(g),m)}if(i.url=c.toString(),(w=t.contentType||this.requestContentType)&&t.requestBody&&i.headers.set("Content-Type",w),t.headerParameters)for(S=0,T=t.headerParameters;S<T.length;S++)if(E=T[S],null!=(I=an(this,e,E,t.serializer)))if(I=t.serializer.serialize(E.mapper,I,Be(E),o),A=E.mapper.headerCollectionPrefix)for(O=0,P=Object.keys(I);O<P.length;O++)R=P[O],i.headers.set(A+R,I[R]);else i.headers.set(E.mapper.serializedName||Be(E),I);if(_=e.options){if(_.customHeaders)for(N in _.customHeaders)i.headers.set(N,_.customHeaders[N]);_.abortSignal&&(i.abortSignal=_.abortSignal),_.timeout&&(i.timeout=_.timeout),_.onUploadProgress&&(i.onUploadProgress=_.onUploadProgress),_.onDownloadProgress&&(i.onDownloadProgress=_.onDownloadProgress),_.spanOptions&&(i.spanOptions=_.spanOptions),_.tracingContext&&(i.tracingContext=_.tracingContext),void 0!==_.shouldDeserialize&&null!==_.shouldDeserialize&&(i.shouldDeserialize=_.shouldDeserialize)}i.withCredentials=this._withCredentials,function(e,t,r,n){var o,i,a,s,c,u,l=null!==(i=null===(o=r.options)||void 0===o?void 0:o.serializerOptions)&&void 0!==i?i:{},p={rootName:null!==(a=l.rootName)&&void 0!==a?a:"",includeRoot:null!==(s=l.includeRoot)&&void 0!==s&&s,xmlCharKey:null!==(c=l.xmlCharKey)&&void 0!==c?c:"_"},d=l.xmlCharKey;if(n.requestBody&&n.requestBody.mapper){t.body=an(e,r,n.requestBody,n.serializer);var f=n.requestBody.mapper,h=f.required,y=f.xmlName,g=f.xmlElementName,m=f.serializedName,v=f.xmlNamespace,b=f.xmlNamespacePrefix,w=f.type.name;try{if(void 0!==t.body&&null!==t.body||h){var S=Be(n.requestBody);t.body=n.serializer.serialize(f,t.body,S,p);var T=w===z.Stream;if(n.isXML){var E=b?"xmlns:"+b:"xmlns",I=function(e,t,r,n,o){var i;if(e&&!["Composite","Sequence","Dictionary"].includes(r)){var a={};return a[o.xmlCharKey]=n,a[C]=((i={})[t]=e,i),a}return n}(v,E,w,t.body,p);w===z.Sequence?t.body=Ye(function(e,t,r,n){var o,i,a;if(Array.isArray(e)||(e=[e]),!r||!n)return(o={})[t]=e,o;var s=((i={})[t]=e,i);return s[C]=((a={})[r]=n,a),s}(I,g||y||m,E,v),{rootName:y||m,xmlCharKey:d}):T||(t.body=Ye(I,{rootName:y||m,xmlCharKey:d}))}else{if(w===z.String&&((null===(u=n.contentType)||void 0===u?void 0:u.match("text/plain"))||"text"===n.mediaType))return;T||(t.body=JSON.stringify(t.body))}}}catch(e){throw new Error('Error "'+e.message+'" occurred in serializing the payload - '+JSON.stringify(m,void 0,"  ")+".")}}else if(n.formDataParameters&&n.formDataParameters.length>0){t.formData={};for(var A=0,O=n.formDataParameters;A<O.length;A++){var P=O[A],R=an(e,r,P,n.serializer);if(null!=R){var _=P.mapper.serializedName||Be(P);t.formData[_]=n.serializer.serialize(P.mapper,R,Be(P),p)}}}}(this,i,e,t),void 0===i.streamResponseStatusCodes&&(i.streamResponseStatusCodes=function(e){var t=new Set;for(var r in e.responses){var n=e.responses[r];n.bodyMapper&&n.bodyMapper.type.name===z.Stream&&t.add(Number(r))}return t}(t)),k=void 0,x=void 0,u.label=2;case 2:return u.trys.push([2,4,,5]),[4,this.sendRequest(i)];case 3:return k=u.sent(),[3,5];case 4:return j=u.sent(),x=j,[3,5];case 5:return x?(x.response&&(x.details=cn(x.response,t.responses[x.statusCode]||t.responses.default)),a=Promise.reject(x)):a=Promise.resolve(cn(k,t.responses[k.status])),[3,7];case 6:return M=u.sent(),a=Promise.reject(M),[3,7];case 7:return(q=r)&&a.then((function(e){return q(null,e._response.parsedBody,e._response.request,e._response)})).catch((function(e){return q(e)})),[2,a]}}))}))},e}();function nn(e,t){var r;return"string"==typeof e?r=e:(r=t(),"function"==typeof e&&(r=e(r))),r}function on(e,t){var r=[];e.sendStreamingJson&&r.push({create:function(e,t){return new tn(e,t)}});var n=void 0;if(e.userAgentOptions&&e.userAgentOptions.userAgentPrefix){var o=[];o.push(e.userAgentOptions.userAgentPrefix);var i=mt();-1===o.indexOf(i)&&o.push(i),n=o.join(" ")}var a=s(s({},Dt),e.keepAliveOptions),c=s(s({},lt),e.retryOptions),u=s(s({},St),e.redirectOptions);O&&r.push(kt(e.proxyOptions));var l,p=s(s({},nt),e.deserializationOptions),d=s({},e.loggingOptions);return r.push((void 0===(l={userAgent:n})&&(l={}),{create:function(e,t){return new Yr(e,t,l)}}),function(e){return{create:function(t,r){return new Lt(t,r,e||Dt)}}}(a),vt({value:n}),ft(),et(p.expectedContentTypes),jt(),Pt(),ut(c.maxRetries,c.retryDelayInMs,c.maxRetryDelayInMs)),u.handleRedirects&&r.push(Tt(u.maxRetries)),t&&r.push(t),r.push(Fe(d)),O&&!1===e.decompressResponse&&r.push({create:function(e,t){throw Zr}}),{httpClient:e.httpClient,requestPolicyFactories:r}}function an(e,t,r,n){return function e(t,r,n,o,i){var a,s;"string"==typeof n&&(n=[n]);var c=null===(a=r.options)||void 0===a?void 0:a.serializerOptions;if(Array.isArray(n)){if(n.length>0){if(o.isConstant)s=o.defaultValue;else{var u=sn(r,n);u.propertyFound||(u=sn(t,n));var l=!1;u.propertyFound||(l=o.required||"options"===n[0]&&2===n.length),s=l?o.defaultValue:u.propertyValue}var p=Ge(n,o);i.serialize(o,s,p,c)}}else for(var d in o.required&&(s={}),n){var f=o.type.modelProperties[d],h=n[d],y=e(t,r,h,f,i),g=Ge(h,f);i.serialize(f,y,g,c),null!=y&&(s||(s={}),s[d]=y)}return s}(e,t,r.parameterPath,r.mapper,n)}function sn(e,t){for(var r={propertyFound:!1},n=0;n<t.length;++n){var o=t[n];if(null==e||!(o in e))break;e=e[o]}return n===t.length&&(r.propertyValue=e,r.propertyFound=!0),r}function cn(e,t){var r,n=e.parsedHeaders,o=t&&t.bodyMapper,i=function(t){return Object.defineProperty(t,"_response",{value:e})};if(o){var a=o.type.name;if("Stream"===a)return i(s(s({},n),{blobBody:e.blobBody,readableStreamBody:e.readableStreamBody}));var c="Composite"===a&&o.type.modelProperties||{},u=Object.keys(c).some((function(e){return""===c[e].serializedName}));if("Sequence"===a||u){for(var l=function(e,t){for(var r=0,n=t.length,o=e.length;r<n;r++,o++)e[o]=t[r];return e}([],e.parsedBody||[]),p=0,d=Object.keys(c);p<d.length;p++){var f=d[p];c[f].serializedName&&(l[f]=e.parsedBody[f])}if(n)for(var h=0,y=Object.keys(n);h<y.length;h++){l[f=y[h]]=n[f]}return i(l),l}if("Composite"===a||"Dictionary"===a)return i(s(s({},n),e.parsedBody))}return o||"HEAD"===e.request.method||("object"!=typeof(r=e.parsedBody)&&"function"!=typeof r||null===r)?i(s(s({},n),{body:e.parsedBody})):i(s(s({},n),e.parsedBody))}const un={type:{name:"Composite",className:"Response",modelProperties:{cost:{constraints:{InclusiveMinimum:0},serializedName:"cost",type:{name:"Number"}},timespan:{serializedName:"timespan",required:!0,type:{name:"String"}},interval:{serializedName:"interval",type:{name:"TimeSpan"}},namespace:{serializedName:"namespace",type:{name:"String"}},resourceregion:{serializedName:"resourceregion",type:{name:"String"}},value:{serializedName:"value",required:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"Metric"}}}}}}},ln={type:{name:"Composite",className:"ErrorResponse",modelProperties:{code:{serializedName:"code",type:{name:"String"}},message:{serializedName:"message",type:{name:"String"}}}}};var pn=Object.freeze({__proto__:null,Response:un,Metric:{type:{name:"Composite",className:"Metric",modelProperties:{id:{serializedName:"id",required:!0,type:{name:"String"}},type:{serializedName:"type",required:!0,type:{name:"String"}},name:{serializedName:"name",type:{name:"Composite",className:"LocalizableString"}},unit:{serializedName:"unit",required:!0,type:{name:"Enum",allowedValues:["Count","Bytes","Seconds","CountPerSecond","BytesPerSecond","Percent","MilliSeconds","ByteSeconds","Unspecified","Cores","MilliCores","NanoCores","BitsPerSecond"]}},timeseries:{serializedName:"timeseries",required:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"TimeSeriesElement"}}}}}}},LocalizableString:{type:{name:"Composite",className:"LocalizableString",modelProperties:{value:{serializedName:"value",required:!0,type:{name:"String"}},localizedValue:{serializedName:"localizedValue",type:{name:"String"}}}}},TimeSeriesElement:{type:{name:"Composite",className:"TimeSeriesElement",modelProperties:{metadatavalues:{serializedName:"metadatavalues",type:{name:"Sequence",element:{type:{name:"Composite",className:"MetadataValue"}}}},data:{serializedName:"data",type:{name:"Sequence",element:{type:{name:"Composite",className:"MetricValue"}}}}}}},MetadataValue:{type:{name:"Composite",className:"MetadataValue",modelProperties:{name:{serializedName:"name",type:{name:"Composite",className:"LocalizableString"}},value:{serializedName:"value",type:{name:"String"}}}}},MetricValue:{type:{name:"Composite",className:"MetricValue",modelProperties:{timeStamp:{serializedName:"timeStamp",required:!0,type:{name:"DateTime"}},average:{serializedName:"average",type:{name:"Number"}},minimum:{serializedName:"minimum",type:{name:"Number"}},maximum:{serializedName:"maximum",type:{name:"Number"}},total:{serializedName:"total",type:{name:"Number"}},count:{serializedName:"count",type:{name:"Number"}}}}},ErrorResponse:ln});class dn{constructor(e){this.client=e}list(e,t){const r={resourceUri:e,options:ge(t||{})};return this.client.sendOperationRequest(r,fn)}}const fn={path:"/{resourceUri}/providers/microsoft.insights/metrics",httpMethod:"GET",responses:{200:{bodyMapper:un},default:{bodyMapper:ln}},queryParameters:[{parameterPath:["options","timespan"],mapper:{serializedName:"timespan",type:{name:"String"}}},{parameterPath:["options","interval"],mapper:{serializedName:"interval",type:{name:"TimeSpan"}}},{parameterPath:["options","metricnames"],mapper:{serializedName:"metricnames",type:{name:"String"}}},{parameterPath:["options","aggregation"],mapper:{serializedName:"aggregation",type:{name:"String"}}},{parameterPath:["options","top"],mapper:{serializedName:"top",type:{name:"Number"}}},{parameterPath:["options","orderby"],mapper:{serializedName:"orderby",type:{name:"String"}}},{parameterPath:["options","filter"],mapper:{serializedName:"$filter",type:{name:"String"}}},{parameterPath:["options","resultType"],mapper:{serializedName:"resultType",type:{name:"Enum",allowedValues:["Data","Metadata"]}}},{parameterPath:"apiVersion",mapper:{serializedName:"api-version",required:!0,type:{name:"String"}}},{parameterPath:["options","metricnamespace"],mapper:{serializedName:"metricnamespace",type:{name:"String"}}}],urlParameters:[{parameterPath:"$host",mapper:{serializedName:"$host",required:!0,type:{name:"String"}},skipEncoding:!0},{parameterPath:"resourceUri",mapper:{serializedName:"resourceUri",required:!0,type:{name:"String"}},skipEncoding:!0}],headerParameters:[{parameterPath:"accept",mapper:{defaultValue:"application/json",isConstant:!0,serializedName:"Accept",type:{name:"String"}}}],serializer:new k(pn,!1)};class hn extends rn{constructor(e,t,r){if(void 0===e)throw new Error("'credentials' cannot be null");if(void 0===t)throw new Error("'apiVersion' cannot be null");if(r||(r={}),!r.userAgent){const e=mt();r.userAgent="monitor-metrics/1.0.0 "+e}super(e,r),this.requestContentType="application/json; charset=utf-8",this.baseUri=r.endpoint||"https://management.azure.com",this.apiVersion=t,this.$host=r.$host||"https://management.azure.com"}}class yn extends hn{constructor(e,t,r){super(e,t,r),this.metrics=new dn(this)}}const gn={type:{name:"Composite",className:"MetricDefinitionCollection",modelProperties:{value:{serializedName:"value",required:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"MetricDefinition"}}}}}}},mn={type:{name:"Composite",className:"ErrorResponse",modelProperties:{code:{serializedName:"code",type:{name:"String"}},message:{serializedName:"message",type:{name:"String"}}}}};var vn=Object.freeze({__proto__:null,MetricDefinitionCollection:gn,MetricDefinition:{type:{name:"Composite",className:"MetricDefinition",modelProperties:{isDimensionRequired:{serializedName:"isDimensionRequired",type:{name:"Boolean"}},resourceId:{serializedName:"resourceId",type:{name:"String"}},namespace:{serializedName:"namespace",type:{name:"String"}},name:{serializedName:"name",type:{name:"Composite",className:"LocalizableString"}},unit:{serializedName:"unit",type:{name:"Enum",allowedValues:["Count","Bytes","Seconds","CountPerSecond","BytesPerSecond","Percent","MilliSeconds","ByteSeconds","Unspecified","Cores","MilliCores","NanoCores","BitsPerSecond"]}},primaryAggregationType:{serializedName:"primaryAggregationType",type:{name:"Enum",allowedValues:["None","Average","Count","Minimum","Maximum","Total"]}},supportedAggregationTypes:{serializedName:"supportedAggregationTypes",type:{name:"Sequence",element:{type:{name:"Enum",allowedValues:["None","Average","Count","Minimum","Maximum","Total"]}}}},metricAvailabilities:{serializedName:"metricAvailabilities",type:{name:"Sequence",element:{type:{name:"Composite",className:"MetricAvailability"}}}},id:{serializedName:"id",type:{name:"String"}},dimensions:{serializedName:"dimensions",type:{name:"Sequence",element:{type:{name:"Composite",className:"LocalizableString"}}}}}}},LocalizableString:{type:{name:"Composite",className:"LocalizableString",modelProperties:{value:{serializedName:"value",required:!0,type:{name:"String"}},localizedValue:{serializedName:"localizedValue",type:{name:"String"}}}}},MetricAvailability:{type:{name:"Composite",className:"MetricAvailability",modelProperties:{timeGrain:{serializedName:"timeGrain",type:{name:"TimeSpan"}},retention:{serializedName:"retention",type:{name:"TimeSpan"}}}}},ErrorResponse:mn});class bn{constructor(e){this.client=e}list(e,t){const r={resourceUri:e,options:ge(t||{})};return this.client.sendOperationRequest(r,wn)}}const wn={path:"/{resourceUri}/providers/microsoft.insights/metricDefinitions",httpMethod:"GET",responses:{200:{bodyMapper:gn},default:{bodyMapper:mn}},queryParameters:[{parameterPath:"apiVersion",mapper:{serializedName:"api-version",required:!0,type:{name:"String"}}},{parameterPath:["options","metricnamespace"],mapper:{serializedName:"metricnamespace",type:{name:"String"}}}],urlParameters:[{parameterPath:"$host",mapper:{serializedName:"$host",required:!0,type:{name:"String"}},skipEncoding:!0},{parameterPath:"resourceUri",mapper:{serializedName:"resourceUri",required:!0,type:{name:"String"}},skipEncoding:!0}],headerParameters:[{parameterPath:"accept",mapper:{defaultValue:"application/json",isConstant:!0,serializedName:"Accept",type:{name:"String"}}}],serializer:new k(vn,!1)};class Sn extends rn{constructor(e,t,r){if(void 0===e)throw new Error("'credentials' cannot be null");if(void 0===t)throw new Error("'apiVersion' cannot be null");if(r||(r={}),!r.userAgent){const e=mt();r.userAgent="monitor-metrics-definitions/1.0.0 "+e}super(e,r),this.requestContentType="application/json; charset=utf-8",this.baseUri=r.endpoint||"https://management.azure.com",this.apiVersion=t,this.$host=r.$host||"https://management.azure.com"}}class Tn extends Sn{constructor(e,t,r){super(e,t,r),this.metricDefinitions=new bn(this)}}const En={type:{name:"Composite",className:"MetricNamespaceCollection",modelProperties:{value:{serializedName:"value",required:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"MetricNamespace"}}}}}}},In={type:{name:"Composite",className:"ErrorResponse",modelProperties:{code:{serializedName:"code",type:{name:"String"}},message:{serializedName:"message",type:{name:"String"}}}}};var Cn=Object.freeze({__proto__:null,MetricNamespaceCollection:En,MetricNamespace:{type:{name:"Composite",className:"MetricNamespace",modelProperties:{id:{serializedName:"id",type:{name:"String"}},type:{serializedName:"type",type:{name:"String"}},name:{serializedName:"name",type:{name:"String"}},properties:{serializedName:"properties",type:{name:"Composite",className:"MetricNamespaceName"}}}}},MetricNamespaceName:{type:{name:"Composite",className:"MetricNamespaceName",modelProperties:{metricNamespaceName:{serializedName:"metricNamespaceName",type:{name:"String"}}}}},ErrorResponse:In});class An{constructor(e){this.client=e}list(e,t){const r={resourceUri:e,options:ge(t||{})};return this.client.sendOperationRequest(r,On)}}const On={path:"/{resourceUri}/providers/microsoft.insights/metricNamespaces",httpMethod:"GET",responses:{200:{bodyMapper:En},default:{bodyMapper:In}},queryParameters:[{parameterPath:"apiVersion",mapper:{serializedName:"api-version",required:!0,type:{name:"String"}}},{parameterPath:["options","startTime"],mapper:{serializedName:"startTime",type:{name:"String"}}}],urlParameters:[{parameterPath:"$host",mapper:{serializedName:"$host",required:!0,type:{name:"String"}},skipEncoding:!0},{parameterPath:"resourceUri",mapper:{serializedName:"resourceUri",required:!0,type:{name:"String"}},skipEncoding:!0}],headerParameters:[{parameterPath:"accept",mapper:{defaultValue:"application/json",isConstant:!0,serializedName:"Accept",type:{name:"String"}}}],serializer:new k(Cn,!1)};class Pn extends rn{constructor(e,t,r){if(void 0===e)throw new Error("'credentials' cannot be null");if(void 0===t)throw new Error("'apiVersion' cannot be null");if(r||(r={}),!r.userAgent){const e=mt();r.userAgent="monitor-metrics-namespaces/1.0.0 "+e}super(e,r),this.requestContentType="application/json; charset=utf-8",this.baseUri=r.endpoint||"https://management.azure.com",this.apiVersion=t,this.$host=r.$host||"https://management.azure.com"}}class Rn extends Pn{constructor(e,t,r){super(e,t,r),this.metricNamespaces=new An(this)}}class _n{constructor(e){this._metricsClient=new yn(e,"2018-01-01",{}),this._definitionsClient=new Tn(e,"2018-01-01",{}),this._namespacesClient=new Rn(e,"2017-12-01-preview",{})}queryMetrics(e,t){return this._metricsClient.metrics.list(e,t)}getMetricDefinitions(e,t){return this._definitionsClient.metricDefinitions.list(e,t)}getMetricNamespaces(e,t){return this._namespacesClient.metricNamespaces.list(e,t)}}class Nn extends Error{constructor(e,t){let r={error:"unknown",errorDescription:"An unknown error occurred and no additional details are available."};if(function(e){return e&&"string"==typeof e.error&&"string"==typeof e.error_description}(t))r=kn(t);else if("string"==typeof t)try{r=kn(JSON.parse(t))}catch(n){r=400===e?{error:"authority_not_found",errorDescription:"The specified authority URL was not found."}:{error:"unknown_error",errorDescription:"An unknown error has occurred. Response body:\n\n"+t}}else r={error:"unknown_error",errorDescription:"An unknown error occurred and no additional details are available."};super(`${r.error}(status code ${e}).\nMore details:\n${r.errorDescription}`),this.statusCode=e,this.errorResponse=r,this.name="AuthenticationError"}}function kn(e){return{error:e.error,errorDescription:e.error_description,correlationId:e.correlation_id,errorCodes:e.error_codes,timestamp:e.timestamp,traceId:e.trace_id}}const xn=Jr({packagePrefix:"Azure.Identity",namespace:"Microsoft.AAD"}),jn=qe("identity");function Mn(e,t){let r="ERROR.";return(null==e?void 0:e.length)&&(r+=` Scopes: ${Array.isArray(e)?e.join(", "):e}.`),`${r} Error message: ${"string"==typeof t?t:t.message}.`}function qn(e,t,r=jn){const n=t?`${t.fullTitle} ${e}`:e;return{title:e,fullTitle:n,info:function(e){r.info(n+" =>",e)}}}var Dn="undefined"!=typeof Symbol&&Symbol,Ln="Function.prototype.bind called on incompatible ",Un=Array.prototype.slice,Hn=Object.prototype.toString,zn=Function.prototype.bind||function(e){var t=this;if("function"!=typeof t||"[object Function]"!==Hn.call(t))throw new TypeError(Ln+t);for(var r,n=Un.call(arguments,1),o=function(){if(this instanceof r){var o=t.apply(this,n.concat(Un.call(arguments)));return Object(o)===o?o:this}return t.apply(e,n.concat(Un.call(arguments)))},i=Math.max(0,t.length-n.length),a=[],s=0;s<i;s++)a.push("$"+s);if(r=Function("binder","return function ("+a.join(",")+"){ return binder.apply(this,arguments); }")(o),t.prototype){var c=function(){};c.prototype=t.prototype,r.prototype=new c,c.prototype=null}return r},Fn=zn.call(Function.call,Object.prototype.hasOwnProperty),Vn=SyntaxError,Bn=Function,Gn=TypeError,Kn=function(e){try{return Bn('"use strict"; return ('+e+").constructor;")()}catch(e){}},Wn=Object.getOwnPropertyDescriptor;if(Wn)try{Wn({},"")}catch(e){Wn=null}var Qn=function(){throw new Gn},$n=Wn?function(){try{return Qn}catch(e){try{return Wn(arguments,"callee").get}catch(e){return Qn}}}():Qn,Jn="function"==typeof Dn&&"function"==typeof Symbol&&"symbol"==typeof Dn("foo")&&"symbol"==typeof Symbol("bar")&&function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),r=Object(t);if("string"==typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(r))return!1;for(t in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var n=Object.getOwnPropertySymbols(e);if(1!==n.length||n[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var o=Object.getOwnPropertyDescriptor(e,t);if(42!==o.value||!0!==o.enumerable)return!1}return!0}(),Xn=Object.getPrototypeOf||function(e){return e.__proto__},Yn={},Zn="undefined"==typeof Uint8Array?void 0:Xn(Uint8Array),eo={"%AggregateError%":"undefined"==typeof AggregateError?void 0:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?void 0:ArrayBuffer,"%ArrayIteratorPrototype%":Jn?Xn([][Symbol.iterator]()):void 0,"%AsyncFromSyncIteratorPrototype%":void 0,"%AsyncFunction%":Yn,"%AsyncGenerator%":Yn,"%AsyncGeneratorFunction%":Yn,"%AsyncIteratorPrototype%":Yn,"%Atomics%":"undefined"==typeof Atomics?void 0:Atomics,"%BigInt%":"undefined"==typeof BigInt?void 0:BigInt,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?void 0:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?void 0:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?void 0:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?void 0:FinalizationRegistry,"%Function%":Bn,"%GeneratorFunction%":Yn,"%Int8Array%":"undefined"==typeof Int8Array?void 0:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?void 0:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?void 0:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Jn?Xn(Xn([][Symbol.iterator]())):void 0,"%JSON%":"object"==typeof JSON?JSON:void 0,"%Map%":"undefined"==typeof Map?void 0:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&Jn?Xn((new Map)[Symbol.iterator]()):void 0,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?void 0:Promise,"%Proxy%":"undefined"==typeof Proxy?void 0:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?void 0:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?void 0:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&Jn?Xn((new Set)[Symbol.iterator]()):void 0,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?void 0:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Jn?Xn(""[Symbol.iterator]()):void 0,"%Symbol%":Jn?Symbol:void 0,"%SyntaxError%":Vn,"%ThrowTypeError%":$n,"%TypedArray%":Zn,"%TypeError%":Gn,"%Uint8Array%":"undefined"==typeof Uint8Array?void 0:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?void 0:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?void 0:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?void 0:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?void 0:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?void 0:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?void 0:WeakSet},to={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},ro=zn.call(Function.call,Array.prototype.concat),no=zn.call(Function.apply,Array.prototype.splice),oo=zn.call(Function.call,String.prototype.replace),io=zn.call(Function.call,String.prototype.slice),ao=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,so=/\\(\\)?/g,co=function(e){var t=io(e,0,1),r=io(e,-1);if("%"===t&&"%"!==r)throw new Vn("invalid intrinsic syntax, expected closing `%`");if("%"===r&&"%"!==t)throw new Vn("invalid intrinsic syntax, expected opening `%`");var n=[];return oo(e,ao,(function(e,t,r,o){n[n.length]=r?oo(o,so,"$1"):t||e})),n},uo=function(e,t){var r,n=e;if(Fn(to,n)&&(n="%"+(r=to[n])[0]+"%"),Fn(eo,n)){var o=eo[n];if(o===Yn&&(o=function e(t){var r;if("%AsyncFunction%"===t)r=Kn("async function () {}");else if("%GeneratorFunction%"===t)r=Kn("function* () {}");else if("%AsyncGeneratorFunction%"===t)r=Kn("async function* () {}");else if("%AsyncGenerator%"===t){var n=e("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if("%AsyncIteratorPrototype%"===t){var o=e("%AsyncGenerator%");o&&(r=Xn(o.prototype))}return eo[t]=r,r}(n)),void 0===o&&!t)throw new Gn("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:r,name:n,value:o}}throw new Vn("intrinsic "+e+" does not exist!")},lo=function(e,t){if("string"!=typeof e||0===e.length)throw new Gn("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof t)throw new Gn('"allowMissing" argument must be a boolean');var r=co(e),n=r.length>0?r[0]:"",o=uo("%"+n+"%",t),i=o.name,a=o.value,s=!1,c=o.alias;c&&(n=c[0],no(r,ro([0,1],c)));for(var u=1,l=!0;u<r.length;u+=1){var p=r[u],d=io(p,0,1),f=io(p,-1);if(('"'===d||"'"===d||"`"===d||'"'===f||"'"===f||"`"===f)&&d!==f)throw new Vn("property names with quotes must have matching quotes");if("constructor"!==p&&l||(s=!0),Fn(eo,i="%"+(n+="."+p)+"%"))a=eo[i];else if(null!=a){if(!(p in a)){if(!t)throw new Gn("base intrinsic for "+e+" exists, but the property is not available.");return}if(Wn&&u+1>=r.length){var h=Wn(a,p);a=(l=!!h)&&"get"in h&&!("originalValue"in h.get)?h.get:a[p]}else l=Fn(a,p),a=a[p];l&&!s&&(eo[i]=a)}}return a},po=$t((function(e){var t=lo("%Function.prototype.apply%"),r=lo("%Function.prototype.call%"),n=lo("%Reflect.apply%",!0)||zn.call(r,t),o=lo("%Object.getOwnPropertyDescriptor%",!0),i=lo("%Object.defineProperty%",!0),a=lo("%Math.max%");if(i)try{i({},"a",{value:1})}catch(e){i=null}e.exports=function(e){var t=n(zn,r,arguments);if(o&&i){var s=o(t,"length");s.configurable&&i(t,"length",{value:1+a(0,e.length-(arguments.length-1))})}return t};var s=function(){return n(zn,t,arguments)};i?i(e.exports,"apply",{value:s}):e.exports.apply=s}));po.apply;var fo,ho=po(lo("String.prototype.indexOf")),yo=function(e,t){var r=lo(e,!!t);return"function"==typeof r&&ho(e,".prototype.")>-1?po(r):r},go=(fo=Object.freeze({__proto__:null,default:{}}))&&fo.default||fo,mo="function"==typeof Map&&Map.prototype,vo=Object.getOwnPropertyDescriptor&&mo?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,bo=mo&&vo&&"function"==typeof vo.get?vo.get:null,wo=mo&&Map.prototype.forEach,So="function"==typeof Set&&Set.prototype,To=Object.getOwnPropertyDescriptor&&So?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,Eo=So&&To&&"function"==typeof To.get?To.get:null,Io=So&&Set.prototype.forEach,Co="function"==typeof WeakMap&&WeakMap.prototype?WeakMap.prototype.has:null,Ao="function"==typeof WeakSet&&WeakSet.prototype?WeakSet.prototype.has:null,Oo="function"==typeof WeakRef&&WeakRef.prototype?WeakRef.prototype.deref:null,Po=Boolean.prototype.valueOf,Ro=Object.prototype.toString,_o=Function.prototype.toString,No=String.prototype.match,ko="function"==typeof BigInt?BigInt.prototype.valueOf:null,xo=Object.getOwnPropertySymbols,jo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?Symbol.prototype.toString:null,Mo=Object.prototype.propertyIsEnumerable,qo=("function"==typeof Reflect?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(e){return e.__proto__}:null),Do=go.custom,Lo=Do&&Bo(Do)?Do:null,Uo="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag?Symbol.toStringTag:null,Ho=function e(t,r,n,o){var i=r||{};if(Ko(i,"quoteStyle")&&"single"!==i.quoteStyle&&"double"!==i.quoteStyle)throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Ko(i,"maxStringLength")&&("number"==typeof i.maxStringLength?i.maxStringLength<0&&i.maxStringLength!==1/0:null!==i.maxStringLength))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var a=!Ko(i,"customInspect")||i.customInspect;if("boolean"!=typeof a)throw new TypeError('option "customInspect", if provided, must be `true` or `false`');if(Ko(i,"indent")&&null!==i.indent&&"\t"!==i.indent&&!(parseInt(i.indent,10)===i.indent&&i.indent>0))throw new TypeError('options "indent" must be "\\t", an integer > 0, or `null`');if(void 0===t)return"undefined";if(null===t)return"null";if("boolean"==typeof t)return t?"true":"false";if("string"==typeof t)return function e(t,r){if(t.length>r.maxStringLength){var n=t.length-r.maxStringLength,o="... "+n+" more character"+(n>1?"s":"");return e(t.slice(0,r.maxStringLength),r)+o}return zo(t.replace(/(['\\])/g,"\\$1").replace(/[\x00-\x1f]/g,$o),"single",r)}(t,i);if("number"==typeof t)return 0===t?1/0/t>0?"0":"-0":String(t);if("bigint"==typeof t)return String(t)+"n";var s=void 0===i.depth?5:i.depth;if(void 0===n&&(n=0),n>=s&&s>0&&"object"==typeof t)return Vo(t)?"[Array]":"[Object]";var c=function(e,t){var r;if("\t"===e.indent)r="\t";else{if(!("number"==typeof e.indent&&e.indent>0))return null;r=Array(e.indent+1).join(" ")}return{base:r,prev:Array(t+1).join(r)}}(i,n);if(void 0===o)o=[];else if(Qo(o,t)>=0)return"[Circular]";function u(t,r,a){if(r&&(o=o.slice()).push(r),a){var s={depth:i.depth};return Ko(i,"quoteStyle")&&(s.quoteStyle=i.quoteStyle),e(t,s,n+1,o)}return e(t,i,n+1,o)}if("function"==typeof t){var l=function(e){if(e.name)return e.name;var t=No.call(_o.call(e),/^function\s*([\w$]+)/);if(t)return t[1];return null}(t),p=ei(t,u);return"[Function"+(l?": "+l:" (anonymous)")+"]"+(p.length>0?" { "+p.join(", ")+" }":"")}if(Bo(t)){var d=jo.call(t);return"object"==typeof t?Jo(d):d}if(function(e){if(!e||"object"!=typeof e)return!1;if("undefined"!=typeof HTMLElement&&e instanceof HTMLElement)return!0;return"string"==typeof e.nodeName&&"function"==typeof e.getAttribute}(t)){for(var f="<"+String(t.nodeName).toLowerCase(),h=t.attributes||[],y=0;y<h.length;y++)f+=" "+h[y].name+"="+zo(Fo(h[y].value),"double",i);return f+=">",t.childNodes&&t.childNodes.length&&(f+="..."),f+="</"+String(t.nodeName).toLowerCase()+">"}if(Vo(t)){if(0===t.length)return"[]";var g=ei(t,u);return c&&!function(e){for(var t=0;t<e.length;t++)if(Qo(e[t],"\n")>=0)return!1;return!0}(g)?"["+Zo(g,c)+"]":"[ "+g.join(", ")+" ]"}if(function(e){return!("[object Error]"!==Wo(e)||Uo&&"object"==typeof e&&Uo in e)}(t)){var m=ei(t,u);return 0===m.length?"["+String(t)+"]":"{ ["+String(t)+"] "+m.join(", ")+" }"}if("object"==typeof t&&a){if(Lo&&"function"==typeof t[Lo])return t[Lo]();if("function"==typeof t.inspect)return t.inspect()}if(function(e){if(!bo||!e||"object"!=typeof e)return!1;try{bo.call(e);try{Eo.call(e)}catch(e){return!0}return e instanceof Map}catch(e){}return!1}(t)){var v=[];return wo.call(t,(function(e,r){v.push(u(r,t,!0)+" => "+u(e,t))})),Yo("Map",bo.call(t),v,c)}if(function(e){if(!Eo||!e||"object"!=typeof e)return!1;try{Eo.call(e);try{bo.call(e)}catch(e){return!0}return e instanceof Set}catch(e){}return!1}(t)){var b=[];return Io.call(t,(function(e){b.push(u(e,t))})),Yo("Set",Eo.call(t),b,c)}if(function(e){if(!Co||!e||"object"!=typeof e)return!1;try{Co.call(e,Co);try{Ao.call(e,Ao)}catch(e){return!0}return e instanceof WeakMap}catch(e){}return!1}(t))return Xo("WeakMap");if(function(e){if(!Ao||!e||"object"!=typeof e)return!1;try{Ao.call(e,Ao);try{Co.call(e,Co)}catch(e){return!0}return e instanceof WeakSet}catch(e){}return!1}(t))return Xo("WeakSet");if(function(e){if(!Oo||!e||"object"!=typeof e)return!1;try{return Oo.call(e),!0}catch(e){}return!1}(t))return Xo("WeakRef");if(function(e){return!("[object Number]"!==Wo(e)||Uo&&"object"==typeof e&&Uo in e)}(t))return Jo(u(Number(t)));if(function(e){if(!e||"object"!=typeof e||!ko)return!1;try{return ko.call(e),!0}catch(e){}return!1}(t))return Jo(u(ko.call(t)));if(function(e){return!("[object Boolean]"!==Wo(e)||Uo&&"object"==typeof e&&Uo in e)}(t))return Jo(Po.call(t));if(function(e){return!("[object String]"!==Wo(e)||Uo&&"object"==typeof e&&Uo in e)}(t))return Jo(u(String(t)));if(!function(e){return!("[object Date]"!==Wo(e)||Uo&&"object"==typeof e&&Uo in e)}(t)&&!function(e){return!("[object RegExp]"!==Wo(e)||Uo&&"object"==typeof e&&Uo in e)}(t)){var w=ei(t,u),S=qo?qo(t)===Object.prototype:t instanceof Object||t.constructor===Object,T=t instanceof Object?"":"null prototype",E=!S&&Uo&&Object(t)===t&&Uo in t?Wo(t).slice(8,-1):T?"Object":"",I=(S||"function"!=typeof t.constructor?"":t.constructor.name?t.constructor.name+" ":"")+(E||T?"["+[].concat(E||[],T||[]).join(": ")+"] ":"");return 0===w.length?I+"{}":c?I+"{"+Zo(w,c)+"}":I+"{ "+w.join(", ")+" }"}return String(t)};function zo(e,t,r){var n="double"===(r.quoteStyle||t)?'"':"'";return n+e+n}function Fo(e){return String(e).replace(/"/g,"&quot;")}function Vo(e){return!("[object Array]"!==Wo(e)||Uo&&"object"==typeof e&&Uo in e)}function Bo(e){if("symbol"==typeof e)return!0;if(!e||"object"!=typeof e||!jo)return!1;try{return jo.call(e),!0}catch(e){}return!1}var Go=Object.prototype.hasOwnProperty||function(e){return e in this};function Ko(e,t){return Go.call(e,t)}function Wo(e){return Ro.call(e)}function Qo(e,t){if(e.indexOf)return e.indexOf(t);for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}function $o(e){var t=e.charCodeAt(0),r={8:"b",9:"t",10:"n",12:"f",13:"r"}[t];return r?"\\"+r:"\\x"+(t<16?"0":"")+t.toString(16).toUpperCase()}function Jo(e){return"Object("+e+")"}function Xo(e){return e+" { ? }"}function Yo(e,t,r,n){return e+" ("+t+") {"+(n?Zo(r,n):r.join(", "))+"}"}function Zo(e,t){if(0===e.length)return"";var r="\n"+t.prev+t.base;return r+e.join(","+r)+"\n"+t.prev}function ei(e,t){var r=Vo(e),n=[];if(r){n.length=e.length;for(var o=0;o<e.length;o++)n[o]=Ko(e,o)?t(e[o],e):""}for(var i in e)Ko(e,i)&&(r&&String(Number(i))===i&&i<e.length||(/[^\w$]/.test(i)?n.push(t(i,e)+": "+t(e[i],e)):n.push(i+": "+t(e[i],e))));if("function"==typeof xo)for(var a=xo(e),s=0;s<a.length;s++)Mo.call(e,a[s])&&n.push("["+t(a[s])+"]: "+t(e[a[s]],e));return n}var ti=lo("%TypeError%"),ri=lo("%WeakMap%",!0),ni=lo("%Map%",!0),oi=yo("WeakMap.prototype.get",!0),ii=yo("WeakMap.prototype.set",!0),ai=yo("WeakMap.prototype.has",!0),si=yo("Map.prototype.get",!0),ci=yo("Map.prototype.set",!0),ui=yo("Map.prototype.has",!0),li=function(e,t){for(var r,n=e;null!==(r=n.next);n=r)if(r.key===t)return n.next=r.next,r.next=e.next,e.next=r,r},pi=function(){var e,t,r,n={assert:function(e){if(!n.has(e))throw new ti("Side channel does not contain "+Ho(e))},get:function(n){if(ri&&n&&("object"==typeof n||"function"==typeof n)){if(e)return oi(e,n)}else if(ni){if(t)return si(t,n)}else if(r)return function(e,t){var r=li(e,t);return r&&r.value}(r,n)},has:function(n){if(ri&&n&&("object"==typeof n||"function"==typeof n)){if(e)return ai(e,n)}else if(ni){if(t)return ui(t,n)}else if(r)return function(e,t){return!!li(e,t)}(r,n);return!1},set:function(n,o){ri&&n&&("object"==typeof n||"function"==typeof n)?(e||(e=new ri),ii(e,n,o)):ni?(t||(t=new ni),ci(t,n,o)):(r||(r={key:{},next:null}),function(e,t,r){var n=li(e,t);n?n.value=r:e.next={key:t,next:e.next,value:r}}(r,n,o))}};return n},di=String.prototype.replace,fi=/%20/g,hi="RFC3986",yi={default:hi,formatters:{RFC1738:function(e){return di.call(e,fi,"+")},RFC3986:function(e){return String(e)}},RFC1738:"RFC1738",RFC3986:hi},gi=Object.prototype.hasOwnProperty,mi=Array.isArray,vi=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}(),bi=function(e,t){for(var r=t&&t.plainObjects?Object.create(null):{},n=0;n<e.length;++n)void 0!==e[n]&&(r[n]=e[n]);return r},wi={arrayToObject:bi,assign:function(e,t){return Object.keys(t).reduce((function(e,r){return e[r]=t[r],e}),e)},combine:function(e,t){return[].concat(e,t)},compact:function(e){for(var t=[{obj:{o:e},prop:"o"}],r=[],n=0;n<t.length;++n)for(var o=t[n],i=o.obj[o.prop],a=Object.keys(i),s=0;s<a.length;++s){var c=a[s],u=i[c];"object"==typeof u&&null!==u&&-1===r.indexOf(u)&&(t.push({obj:i,prop:c}),r.push(u))}return function(e){for(;e.length>1;){var t=e.pop(),r=t.obj[t.prop];if(mi(r)){for(var n=[],o=0;o<r.length;++o)void 0!==r[o]&&n.push(r[o]);t.obj[t.prop]=n}}}(t),e},decode:function(e,t,r){var n=e.replace(/\+/g," ");if("iso-8859-1"===r)return n.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(n)}catch(e){return n}},encode:function(e,t,r,n,o){if(0===e.length)return e;var i=e;if("symbol"==typeof e?i=Symbol.prototype.toString.call(e):"string"!=typeof e&&(i=String(e)),"iso-8859-1"===r)return escape(i).replace(/%u[0-9a-f]{4}/gi,(function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"}));for(var a="",s=0;s<i.length;++s){var c=i.charCodeAt(s);45===c||46===c||95===c||126===c||c>=48&&c<=57||c>=65&&c<=90||c>=97&&c<=122||o===yi.RFC1738&&(40===c||41===c)?a+=i.charAt(s):c<128?a+=vi[c]:c<2048?a+=vi[192|c>>6]+vi[128|63&c]:c<55296||c>=57344?a+=vi[224|c>>12]+vi[128|c>>6&63]+vi[128|63&c]:(s+=1,c=65536+((1023&c)<<10|1023&i.charCodeAt(s)),a+=vi[240|c>>18]+vi[128|c>>12&63]+vi[128|c>>6&63]+vi[128|63&c])}return a},isBuffer:function(e){return!(!e||"object"!=typeof e)&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},isRegExp:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},maybeMap:function(e,t){if(mi(e)){for(var r=[],n=0;n<e.length;n+=1)r.push(t(e[n]));return r}return t(e)},merge:function e(t,r,n){if(!r)return t;if("object"!=typeof r){if(mi(t))t.push(r);else{if(!t||"object"!=typeof t)return[t,r];(n&&(n.plainObjects||n.allowPrototypes)||!gi.call(Object.prototype,r))&&(t[r]=!0)}return t}if(!t||"object"!=typeof t)return[t].concat(r);var o=t;return mi(t)&&!mi(r)&&(o=bi(t,n)),mi(t)&&mi(r)?(r.forEach((function(r,o){if(gi.call(t,o)){var i=t[o];i&&"object"==typeof i&&r&&"object"==typeof r?t[o]=e(i,r,n):t.push(r)}else t[o]=r})),t):Object.keys(r).reduce((function(t,o){var i=r[o];return gi.call(t,o)?t[o]=e(t[o],i,n):t[o]=i,t}),o)}},Si=Object.prototype.hasOwnProperty,Ti={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},Ei=Array.isArray,Ii=Array.prototype.push,Ci=function(e,t){Ii.apply(e,Ei(t)?t:[t])},Ai=Date.prototype.toISOString,Oi=yi.default,Pi={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:wi.encode,encodeValuesOnly:!1,format:Oi,formatter:yi.formatters[Oi],indices:!1,serializeDate:function(e){return Ai.call(e)},skipNulls:!1,strictNullHandling:!1},Ri=function e(t,r,n,o,i,a,s,c,u,l,p,d,f,h,y){var g,m=t;if(y.has(t))throw new RangeError("Cyclic object value");if("function"==typeof s?m=s(r,m):m instanceof Date?m=l(m):"comma"===n&&Ei(m)&&(m=wi.maybeMap(m,(function(e){return e instanceof Date?l(e):e}))),null===m){if(o)return a&&!f?a(r,Pi.encoder,h,"key",p):r;m=""}if("string"==typeof(g=m)||"number"==typeof g||"boolean"==typeof g||"symbol"==typeof g||"bigint"==typeof g||wi.isBuffer(m))return a?[d(f?r:a(r,Pi.encoder,h,"key",p))+"="+d(a(m,Pi.encoder,h,"value",p))]:[d(r)+"="+d(String(m))];var v,b=[];if(void 0===m)return b;if("comma"===n&&Ei(m))v=[{value:m.length>0?m.join(",")||null:void 0}];else if(Ei(s))v=s;else{var w=Object.keys(m);v=c?w.sort(c):w}for(var S=0;S<v.length;++S){var T=v[S],E="object"==typeof T&&void 0!==T.value?T.value:m[T];if(!i||null!==E){var I=Ei(m)?"function"==typeof n?n(r,T):r:r+(u?"."+T:"["+T+"]");y.set(t,!0);var C=pi();Ci(b,e(E,I,n,o,i,a,s,c,u,l,p,d,f,h,C))}}return b},_i=(Object.prototype.hasOwnProperty,Array.isArray,function(e,t){var r,n=e,o=function(e){if(!e)return Pi;if(null!==e.encoder&&void 0!==e.encoder&&"function"!=typeof e.encoder)throw new TypeError("Encoder has to be a function.");var t=e.charset||Pi.charset;if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var r=yi.default;if(void 0!==e.format){if(!Si.call(yi.formatters,e.format))throw new TypeError("Unknown format option provided.");r=e.format}var n=yi.formatters[r],o=Pi.filter;return("function"==typeof e.filter||Ei(e.filter))&&(o=e.filter),{addQueryPrefix:"boolean"==typeof e.addQueryPrefix?e.addQueryPrefix:Pi.addQueryPrefix,allowDots:void 0===e.allowDots?Pi.allowDots:!!e.allowDots,charset:t,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:Pi.charsetSentinel,delimiter:void 0===e.delimiter?Pi.delimiter:e.delimiter,encode:"boolean"==typeof e.encode?e.encode:Pi.encode,encoder:"function"==typeof e.encoder?e.encoder:Pi.encoder,encodeValuesOnly:"boolean"==typeof e.encodeValuesOnly?e.encodeValuesOnly:Pi.encodeValuesOnly,filter:o,format:r,formatter:n,serializeDate:"function"==typeof e.serializeDate?e.serializeDate:Pi.serializeDate,skipNulls:"boolean"==typeof e.skipNulls?e.skipNulls:Pi.skipNulls,sort:"function"==typeof e.sort?e.sort:null,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:Pi.strictNullHandling}}(t);"function"==typeof o.filter?n=(0,o.filter)("",n):Ei(o.filter)&&(r=o.filter);var i,a=[];if("object"!=typeof n||null===n)return"";i=t&&t.arrayFormat in Ti?t.arrayFormat:t&&"indices"in t?t.indices?"indices":"repeat":"indices";var s=Ti[i];r||(r=Object.keys(n)),o.sort&&r.sort(o.sort);for(var c=pi(),u=0;u<r.length;++u){var l=r[u];o.skipNulls&&null===n[l]||Ci(a,Ri(n[l],l,s,o.strictNullHandling,o.skipNulls,o.encode?o.encoder:null,o.filter,o.sort,o.allowDots,o.serializeDate,o.format,o.formatter,o.encodeValuesOnly,o.charset,c))}var p=a.join(o.delimiter),d=!0===o.addQueryPrefix?"?":"";return o.charsetSentinel&&("iso-8859-1"===o.charset?d+="utf8=%26%2310003%3B&":d+="utf8=%E2%9C%93&"),p.length>0?d+p:""});const Ni=new Error("getAuthorityHostEnvironment is not supported in the browser.");class ki extends rn{constructor(e){if(O&&(e=e||function(){throw Ni}()),e=e||ki.getDefaultOptions(),super(void 0,on(Object.assign(Object.assign({},e),{deserializationOptions:{expectedContentTypes:{json:["application/json","text/json","text/plain"]}}}))),this.baseUri=this.authorityHost=e.authorityHost||"https://login.microsoftonline.com",!this.baseUri.startsWith("https:"))throw new Error("The authorityHost address must use the 'https' protocol.")}createWebResource(e){const t=new F;return t.prepare(e),t}sendTokenRequest(e,t){return c(this,void 0,void 0,(function*(){jn.info(`IdentityClient: sending token request to [${e.url}]`);const r=yield this.sendRequest(e);if(t=t||(e=>Date.now()+1e3*e.expires_in),200===r.status||201===r.status){const n={accessToken:{token:r.parsedBody.access_token,expiresOnTimestamp:t(r.parsedBody)},refreshToken:r.parsedBody.refresh_token};return jn.info(`IdentityClient: [${e.url}] token acquired, expires on ${n.accessToken.expiresOnTimestamp}`),n}{const e=new Nn(r.status,r.parsedBody||r.bodyAsText);throw jn.warning(`IdentityClient: authentication error. HTTP status: ${r.status}, ${e.errorResponse.errorDescription}`),e}}))}refreshAccessToken(e,t,r,n,o,i,a){return c(this,void 0,void 0,(function*(){if(void 0===n)return null;jn.info(`IdentityClient: refreshing access token with client ID: ${t}, scopes: ${r} started`);const{span:s,updatedOptions:c}=xn("IdentityClient-refreshAccessToken",a),u={grant_type:"refresh_token",client_id:t,refresh_token:n,scope:r};void 0!==o&&(u.client_secret=o);try{const r=function(e){return"adfs"===e?"oauth2/token":"oauth2/v2.0/token"}(e),n=this.createWebResource({url:`${this.authorityHost}/${e}/${r}`,method:"POST",disableJsonStringifyOnBody:!0,deserializationMapper:void 0,body:_i(u),headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"},spanOptions:c.tracingOptions&&c.tracingOptions.spanOptions,tracingContext:c.tracingOptions&&c.tracingOptions.tracingContext,abortSignal:a&&a.abortSignal}),o=yield this.sendTokenRequest(n,i);return jn.info("IdentityClient: refreshed token for client ID: "+t),o}catch(e){if("AuthenticationError"===e.name&&"interaction_required"===e.errorResponse.error)return jn.info("IdentityClient: interaction required for client ID: "+t),s.setStatus({code:Qr.ERROR,message:e.message}),null;throw jn.warning(`IdentityClient: failed refreshing token for client ID: ${t}: ${e}`),s.setStatus({code:Qr.ERROR,message:e.message}),e}finally{s.end()}}))}sendGetRequestAsync(e,t){const r=new F(e,"GET",null==t?void 0:t.body,{},null==t?void 0:t.headers);return this.sendRequest(r).then(e=>({body:e.parsedBody,headers:e.headers.rawHeaders(),status:e.status}))}sendPostRequestAsync(e,t){const r=new F(e,"POST",null==t?void 0:t.body,{},null==t?void 0:t.headers);return this.sendRequest(r).then(e=>({body:e.parsedBody,headers:e.headers.rawHeaders(),status:e.status}))}static getDefaultOptions(){return{authorityHost:"https://login.microsoftonline.com"}}}
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var xi=function(e,t){return(xi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function ji(e,t){function r(){this.constructor=e}xi(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var Mi=function(){return(Mi=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function qi(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))}function Di(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}var Li,Ui=function(){function e(){}return e.createNewGuid=function(){var t=window.crypto;if(t&&t.getRandomValues){var r=new Uint8Array(16);return t.getRandomValues(r),r[6]|=64,r[6]&=79,r[8]|=128,r[8]&=191,e.decimalToHex(r[0])+e.decimalToHex(r[1])+e.decimalToHex(r[2])+e.decimalToHex(r[3])+"-"+e.decimalToHex(r[4])+e.decimalToHex(r[5])+"-"+e.decimalToHex(r[6])+e.decimalToHex(r[7])+"-"+e.decimalToHex(r[8])+e.decimalToHex(r[9])+"-"+e.decimalToHex(r[10])+e.decimalToHex(r[11])+e.decimalToHex(r[12])+e.decimalToHex(r[13])+e.decimalToHex(r[14])+e.decimalToHex(r[15])}for(var n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",o="0123456789abcdef",i=0,a="",s=0;s<36;s++)"-"!==n[s]&&"4"!==n[s]&&(i=16*Math.random()|0),"x"===n[s]?a+=o[i]:"y"===n[s]?(i&=3,a+=o[i|=8]):a+=n[s];return a},e.isGuid=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},e.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},e.base64Encode=function(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,(function(e,t){return String.fromCharCode(Number("0x"+t))})))},e.base64Decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}return decodeURIComponent(atob(t).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""))},e.deserialize=function(e){var t,r=/\+/g,n=/([^&=]+)=([^&]*)/g,o=function(e){return decodeURIComponent(e.replace(r," "))},i={};for(t=n.exec(e);t;)i[o(t[1])]=o(t[2]),t=n.exec(e);return i},e}(),Hi=function(){function e(){}return Object.defineProperty(e,"libraryName",{get:function(){return"Msal.js"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"claims",{get:function(){return"claims"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"clientId",{get:function(){return"clientId"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"adalIdToken",{get:function(){return"adal.idtoken"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"cachePrefix",{get:function(){return"msal"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"scopes",{get:function(){return"scopes"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"no_account",{get:function(){return"NO_ACCOUNT"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"upn",{get:function(){return"upn"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"domain_hint",{get:function(){return"domain_hint"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt_select_account",{get:function(){return"&prompt=select_account"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt_none",{get:function(){return"&prompt=none"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt",{get:function(){return"prompt"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"response_mode_fragment",{get:function(){return"&response_mode=fragment"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"resourceDelimiter",{get:function(){return"|"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"cacheDelimiter",{get:function(){return"."},enumerable:!0,configurable:!0}),Object.defineProperty(e,"popUpWidth",{get:function(){return this._popUpWidth},set:function(e){this._popUpWidth=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"popUpHeight",{get:function(){return this._popUpHeight},set:function(e){this._popUpHeight=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"login",{get:function(){return"LOGIN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"renewToken",{get:function(){return"RENEW_TOKEN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"unknown",{get:function(){return"UNKNOWN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ADFS",{get:function(){return"adfs"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"homeAccountIdentifier",{get:function(){return"homeAccountIdentifier"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"common",{get:function(){return"common"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"openidScope",{get:function(){return"openid"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"profileScope",{get:function(){return"profile"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"oidcScopes",{get:function(){return[this.openidScope,this.profileScope]},enumerable:!0,configurable:!0}),Object.defineProperty(e,"interactionTypeRedirect",{get:function(){return"redirectInteraction"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"interactionTypePopup",{get:function(){return"popupInteraction"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"interactionTypeSilent",{get:function(){return"silentInteraction"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"inProgress",{get:function(){return"inProgress"},enumerable:!0,configurable:!0}),e._popUpWidth=483,e._popUpHeight=600,e}();!function(e){e.SCOPE="scope",e.STATE="state",e.ERROR="error",e.ERROR_DESCRIPTION="error_description",e.ACCESS_TOKEN="access_token",e.ID_TOKEN="id_token",e.EXPIRES_IN="expires_in",e.SESSION_STATE="session_state",e.CLIENT_INFO="client_info"}(Li||(Li={}));var zi,Fi,Vi,Bi="id_token",Gi="token",Ki="id_token token";!function(e){e.AUTHORITY="authority",e.ACQUIRE_TOKEN_ACCOUNT="acquireTokenAccount",e.SESSION_STATE="session.state",e.STATE_LOGIN="state.login",e.STATE_ACQ_TOKEN="state.acquireToken",e.STATE_RENEW="state.renew",e.NONCE_IDTOKEN="nonce.idtoken",e.LOGIN_REQUEST="login.request",e.RENEW_STATUS="token.renew.status",e.URL_HASH="urlHash",e.INTERACTION_STATUS="interaction_status",e.REDIRECT_REQUEST="redirect_request"}(zi||(zi={})),function(e){e.IDTOKEN="idtoken",e.CLIENT_INFO="client.info"}(Fi||(Fi={})),function(e){e.LOGIN_ERROR="login.error",e.ERROR="error",e.ERROR_DESC="error.description"}(Vi||(Vi={}));var Wi;!function(e){e.ACCOUNT="account",e.SID="sid",e.LOGIN_HINT="login_hint",e.ORGANIZATIONS="organizations",e.CONSUMERS="consumers",e.ID_TOKEN="id_token",e.ACCOUNT_ID="accountIdentifier",e.HOMEACCOUNT_ID="homeAccountIdentifier"}(Wi||(Wi={}));var Qi,$i=[Wi.SID,Wi.LOGIN_HINT],Ji="GET",Xi={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none"},Yi="msalIdTokenFrame",Zi="msalRenewFrame",ea={code:"unexpected_error",desc:"Unexpected error in authentication."},ta={code:"no_window_object",desc:"No window object available. Details:"},ra=function(e){function t(r,n){var o=e.call(this,n)||this;return Object.setPrototypeOf(o,t.prototype),o.errorCode=r,o.errorMessage=n,o.name="AuthError",o}return ji(t,e),t.createUnexpectedError=function(e){return new t(ea.code,ea.desc+": "+e)},t.createNoWindowObjectError=function(e){return new t(ta.code,ta.desc+" "+e)},t}(Error),na=function(){function e(){}return e.isEmpty=function(e){return void 0===e||!e||0===e.length},e.validateAndParseJsonCacheKey=function(e){try{var t=JSON.parse(e);return t&&"object"==typeof t?t:null}catch(e){return null}},e}(),oa={code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},ia={code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},aa={code:"token_renewal_error",desc:"Token renewal operation failed due to timeout."},sa={code:"invalid_id_token",desc:"Invalid ID token format."},ca={code:"invalid_state_error",desc:"Invalid state."},ua={code:"nonce_mismatch_error",desc:"Nonce is not matching, Nonce received: "},la={code:"login_progress_error",desc:"Login_In_Progress: Error during login call - login is already in progress."},pa={code:"acquiretoken_progress_error",desc:"AcquireToken_In_Progress: Error during login call - login is already in progress."},da={code:"user_cancelled",desc:"User cancelled the flow."},fa={code:"callback_error",desc:"Error occurred in token received callback function."},ha={code:"user_login_error",desc:"User login is required. For silent calls, request must contain either sid or login_hint"},ya={code:"user_non_existent",desc:"User object does not exist. Please call a login API."},ga={code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},ma={code:"client_info_not_populated_error",desc:"The service did not populate client_info in the response, Please verify with the service team"},va={code:"null_or_empty_id_token",desc:"The idToken is null or empty. Please review the trace to determine the root cause."},ba={code:"id_token_parsing_error",desc:"ID token cannot be parsed. Please review stack trace to determine root cause."},wa={code:"token_encoding_error",desc:"The token to be decoded is not encoded correctly."},Sa={code:"invalid_interaction_type",desc:"The interaction type passed to the handler was incorrect or unknown"},Ta={code:"cannot_parse_cache",desc:"The cached token key is not a valid JSON and cannot be parsed"},Ea={code:"block_token_requests",desc:"Token calls are blocked in hidden iframes"},Ia=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="ClientAuthError",Object.setPrototypeOf(o,t.prototype),o}return ji(t,e),t.createEndpointResolutionError=function(e){var r=oa.desc;return e&&!na.isEmpty(e)&&(r+=" Details: "+e),new t(oa.code,r)},t.createPopupWindowError=function(e){var r=ia.desc;return e&&!na.isEmpty(e)&&(r+=" Details: "+e),new t(ia.code,r)},t.createTokenRenewalTimeoutError=function(){return new t(aa.code,aa.desc)},t.createInvalidIdTokenError=function(e){return new t(sa.code,sa.desc+" Given token: "+e)},t.createInvalidStateError=function(e,r){return new t(ca.code,ca.desc+" "+e+", state expected : "+r+".")},t.createNonceMismatchError=function(e,r){return new t(ua.code,ua.desc+" "+e+", nonce expected : "+r+".")},t.createLoginInProgressError=function(){return new t(la.code,la.desc)},t.createAcquireTokenInProgressError=function(){return new t(pa.code,pa.desc)},t.createUserCancelledError=function(){return new t(da.code,da.desc)},t.createErrorInCallbackFunction=function(e){return new t(fa.code,fa.desc+" "+e+".")},t.createUserLoginRequiredError=function(){return new t(ha.code,ha.desc)},t.createUserDoesNotExistError=function(){return new t(ya.code,ya.desc)},t.createClientInfoDecodingError=function(e){return new t(ga.code,ga.desc+" Failed with error: "+e)},t.createClientInfoNotPopulatedError=function(e){return new t(ma.code,ma.desc+" Failed with error: "+e)},t.createIdTokenNullOrEmptyError=function(e){return new t(va.code,va.desc+" Raw ID Token Value: "+e)},t.createIdTokenParsingError=function(e){return new t(ba.code,ba.desc+" Failed with error: "+e)},t.createTokenEncodingError=function(e){return new t(wa.code,wa.desc+" Attempted to decode: "+e)},t.createInvalidInteractionTypeError=function(){return new t(Sa.code,Sa.desc)},t.createCacheParseError=function(e){var r="invalid key: "+e+", "+Ta.desc;return new t(Ta.code,r)},t.createBlockTokenRequestsInHiddenIframeError=function(){return new t(Ea.code,Ea.desc)},t}(ra),Ca={code:"no_config_set",desc:"Configuration has not been set. Please call the UserAgentApplication constructor with a valid Configuration object."},Aa={code:"storage_not_supported",desc:"The value for the cacheLocation is not supported."},Oa={code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call handleRedirectCallback() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},Pa={code:"invalid_callback_object",desc:"The object passed for the callback was invalid. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},Ra={code:"scopes_required",desc:"Scopes are required to obtain an access token."},_a={code:"empty_input_scopes_error",desc:"Scopes cannot be passed as empty array."},Na={code:"nonarray_input_scopes_error",desc:"Scopes cannot be passed as non-array."},ka={code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent' and 'none'"},xa={code:"invalid_authority_type",desc:"The given authority is not a valid type of authority supported by MSAL. Please see here for valid authorities: <insert URL here>."},ja={code:"authority_uri_insecure",desc:"Authority URIs must use https."},Ma={code:"authority_uri_invalid_path",desc:"Given authority URI is invalid."},qa={code:"untrusted_authority",desc:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter or set validateAuthority=false."},Da={code:"b2c_known_authorities_not_set",desc:"Must set known authorities when validateAuthority is set to True and using B2C"},La={code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},Ua={code:"empty_request_error",desc:"Request object is required."},Ha={code:"invalid_guid_sent_as_correlationId",desc:"Please set the correlationId as a valid guid"},za={code:"telemetry_config_error",desc:"Telemetry config is not configured with required values"},Fa={code:"sso_silent_error",desc:"request must contain either sid or login_hint"},Va={code:"authority_metadata_error",desc:"Invalid authorityMetadata. Must be a JSON object containing authorization_endpoint, end_session_endpoint, and issuer fields."},Ba=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="ClientConfigurationError",Object.setPrototypeOf(o,t.prototype),o}return ji(t,e),t.createNoSetConfigurationError=function(){return new t(Ca.code,""+Ca.desc)},t.createStorageNotSupportedError=function(e){return new t(Aa.code,Aa.desc+" Given location: "+e)},t.createRedirectCallbacksNotSetError=function(){return new t(Oa.code,Oa.desc)},t.createInvalidCallbackObjectError=function(e){return new t(Pa.code,Pa.desc+" Given value for callback function: "+e)},t.createEmptyScopesArrayError=function(e){return new t(_a.code,_a.desc+" Given value: "+e+".")},t.createScopesNonArrayError=function(e){return new t(Na.code,Na.desc+" Given value: "+e+".")},t.createScopesRequiredError=function(e){return new t(Ra.code,Ra.desc+" Given value: "+e)},t.createInvalidPromptError=function(e){return new t(ka.code,ka.desc+" Given value: "+e)},t.createClaimsRequestParsingError=function(e){return new t(La.code,La.desc+" Given value: "+e)},t.createEmptyRequestError=function(){var e=Ua;return new t(e.code,e.desc)},t.createInvalidCorrelationIdError=function(){return new t(Ha.code,Ha.desc)},t.createKnownAuthoritiesNotSetError=function(){return new t(Da.code,Da.desc)},t.createInvalidAuthorityTypeError=function(){return new t(xa.code,xa.desc)},t.createUntrustedAuthorityError=function(e){return new t(qa.code,qa.desc+" Provided Authority: "+e)},t.createTelemetryConfigError=function(e){var r=za,n=r.code,o=r.desc,i={applicationName:"string",applicationVersion:"string",telemetryEmitter:"function"};return new t(n,o+" mising values: "+Object.keys(i).reduce((function(t,r){return e[r]?t:t.concat([r+" ("+i[r]+")"])}),[]).join(","))},t.createSsoSilentError=function(){return new t(Fa.code,Fa.desc)},t.createInvalidAuthorityMetadataError=function(){return new t(Va.code,Va.desc)},t}(Ia),Ga=function(){function e(){}return e.isIntersectingScopes=function(e,t){for(var r=this.trimAndConvertArrayToLowerCase(e.slice()),n=this.trimAndConvertArrayToLowerCase(t.slice()),o=0;o<n.length;o++)if(r.indexOf(n[o].toLowerCase())>-1)return!0;return!1},e.containsScope=function(e,t){var r=this.trimAndConvertArrayToLowerCase(e.slice());return this.trimAndConvertArrayToLowerCase(t.slice()).every((function(e){return r.indexOf(e.toString().toLowerCase())>=0}))},e.trimAndConvertToLowerCase=function(e){return e.trim().toLowerCase()},e.trimAndConvertArrayToLowerCase=function(e){var t=this;return e.map((function(e){return t.trimAndConvertToLowerCase(e)}))},e.trimScopes=function(e){return e.map((function(e){return e.trim()}))},e.removeElement=function(e,t){var r=this.trimAndConvertToLowerCase(t);return e.filter((function(e){return e!==r}))},e.parseScope=function(e){var t="";if(e)for(var r=0;r<e.length;++r)t+=r!==e.length-1?e[r]+" ":e[r];return t},e.validateInputScope=function(e,t){if(e){if(!Array.isArray(e))throw Ba.createScopesNonArrayError(e);if(e.length<1&&t)throw Ba.createEmptyScopesArrayError(e.toString())}else if(t)throw Ba.createScopesRequiredError(e)},e.getScopeFromState=function(e){if(e){var t=e.indexOf(Hi.resourceDelimiter);if(t>-1&&t+1<e.length)return e.substring(t+1)}return""},e.appendScopes=function(e,t){if(e){var r=t?this.trimAndConvertArrayToLowerCase(t.slice()):null,n=this.trimAndConvertArrayToLowerCase(e.slice());return r?n.concat(r):n}return null},e.onlyContainsOidcScopes=function(e){var t=e.length,r=0;return e.indexOf(Hi.openidScope)>-1&&(r+=1),e.indexOf(Hi.profileScope)>-1&&(r+=1),t>0&&t===r},e.containsAnyOidcScopes=function(e){var t=e.indexOf(Hi.openidScope)>-1,r=e.indexOf(Hi.profileScope)>-1;return t||r},e.onlyContainsClientId=function(e,t){return!!e&&e.indexOf(t)>-1&&1===e.length},e.appendDefaultScopes=function(e){var t=e;return-1===t.indexOf(Hi.openidScope)&&t.push(Hi.openidScope),-1===t.indexOf(Hi.profileScope)&&t.push(Hi.profileScope),t},e.removeDefaultScopes=function(e){return e.filter((function(e){return e!==Hi.openidScope&&e!==Hi.profileScope}))},e.translateClientIdIfSingleScope=function(e,t){return this.onlyContainsClientId(e,t)?Hi.oidcScopes:e},e}(),Ka=function(){function e(){}return e.createNavigateUrl=function(e){var t=this.createNavigationUrlString(e),r=e.authorityInstance.AuthorizationEndpoint;return r.indexOf("?")<0?r+="?":r+="&",""+r+t.join("&")},e.createNavigationUrlString=function(e){var t=Ga.appendDefaultScopes(e.scopes),r=[];return r.push("response_type="+e.responseType),r.push("scope="+encodeURIComponent(Ga.parseScope(t))),r.push("client_id="+encodeURIComponent(e.clientId)),r.push("redirect_uri="+encodeURIComponent(e.redirectUri)),r.push("state="+encodeURIComponent(e.state)),r.push("nonce="+encodeURIComponent(e.nonce)),r.push("client_info=1"),r.push("x-client-SKU="+e.xClientSku),r.push("x-client-Ver="+e.xClientVer),e.promptValue&&r.push("prompt="+encodeURIComponent(e.promptValue)),e.claimsValue&&r.push("claims="+encodeURIComponent(e.claimsValue)),e.queryParameters&&r.push(e.queryParameters),e.extraQueryParameters&&r.push(e.extraQueryParameters),r.push("client-request-id="+encodeURIComponent(e.correlationId)),r},e.getCurrentUrl=function(){return window.location.href.split("?")[0].split("#")[0]},e.removeHashFromUrl=function(e){return e.split("#")[0]},e.replaceTenantPath=function(e,t){var r=e.toLowerCase(),n=this.GetUrlComponents(r),o=n.PathSegments;return!t||0===o.length||o[0]!==Hi.common&&o[0]!==Wi.ORGANIZATIONS&&o[0]!==Wi.CONSUMERS||(o[0]=t),this.constructAuthorityUriFromObject(n,o)},e.constructAuthorityUriFromObject=function(e,t){return this.CanonicalizeUri(e.Protocol+"//"+e.HostNameAndPort+"/"+t.join("/"))},e.isCommonAuthority=function(e){var t=this.CanonicalizeUri(e),r=this.GetUrlComponents(t).PathSegments;return 0!==r.length&&r[0]===Hi.common},e.isOrganizationsAuthority=function(e){var t=this.CanonicalizeUri(e),r=this.GetUrlComponents(t).PathSegments;return 0!==r.length&&r[0]===Wi.ORGANIZATIONS},e.isConsumersAuthority=function(e){var t=this.CanonicalizeUri(e),r=this.GetUrlComponents(t).PathSegments;return 0!==r.length&&r[0]===Wi.CONSUMERS},e.GetUrlComponents=function(e){if(!e)throw"Url required";var t=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),r=e.match(t);if(!r||r.length<6)throw"Valid url required";var n={Protocol:r[1],HostNameAndPort:r[4],AbsolutePath:r[5]},o=n.AbsolutePath.split("/");return o=o.filter((function(e){return e&&e.length>0})),n.PathSegments=o,r[6]&&(n.Search=r[6]),r[8]&&(n.Hash=r[8]),n},e.CanonicalizeUri=function(t){return t&&(t=t.toLowerCase()),t&&!e.endsWith(t,"/")&&(t+="/"),t},e.endsWith=function(e,t){return!(!e||!t)&&-1!==e.indexOf(t,e.length-t.length)},e.urlRemoveQueryStringParameter=function(e,t){if(na.isEmpty(e))return e;var r=new RegExp("(\\&"+t+"=)[^&]+");return e=e.replace(r,""),r=new RegExp("("+t+"=)[^&]+&"),e=e.replace(r,""),r=new RegExp("("+t+"=)[^&]+"),e=e.replace(r,"")},e.getHashFromUrl=function(e){var t=e.indexOf("#"),r=e.indexOf("#/");return r>-1?e.substring(r+2):t>-1?e.substring(t+1):e},e.urlContainsHash=function(t){var r=e.deserializeHash(t);return r.hasOwnProperty(Li.ERROR_DESCRIPTION)||r.hasOwnProperty(Li.ERROR)||r.hasOwnProperty(Li.ACCESS_TOKEN)||r.hasOwnProperty(Li.ID_TOKEN)},e.deserializeHash=function(t){var r=e.getHashFromUrl(t);return Ui.deserialize(r)},e.getHostFromUri=function(e){var t=String(e).replace(/^(https?:)\/\//,"");return t=t.split("/")[0]},e}(),Wa=function(e,t,r,n,o){this.authority=Ka.CanonicalizeUri(e),this.clientId=t,this.scopes=r,this.homeAccountIdentifier=Ui.base64Encode(n)+"."+Ui.base64Encode(o)},Qa=function(e,t,r,n){this.accessToken=e,this.idToken=t,this.expiresIn=r,this.homeAccountIdentifier=n},$a=function(){function e(e,t,r,n,o,i,a){this.authorityInstance=e,this.clientId=t,this.nonce=Ui.createNewGuid(),this.scopes=o?o.slice():Hi.oidcScopes,this.scopes=Ga.trimScopes(this.scopes),this.state=i,this.correlationId=a,this.xClientSku="MSAL.JS",this.xClientVer="1.4.10",this.responseType=r,this.redirectUri=n}return Object.defineProperty(e.prototype,"authority",{get:function(){return this.authorityInstance?this.authorityInstance.CanonicalAuthority:null},enumerable:!0,configurable:!0}),e.prototype.populateQueryParams=function(t,r,n,o){var i={};r&&(r.prompt&&(this.promptValue=r.prompt),r.claimsRequest&&(this.claimsValue=r.claimsRequest),e.isSSOParam(r)&&(i=this.constructUnifiedCacheQueryParameter(r,null))),n&&(i=this.constructUnifiedCacheQueryParameter(null,n)),i=this.addHintParameters(t,i);var a=r?r.extraQueryParameters:null;this.queryParameters=e.generateQueryParametersString(i),this.extraQueryParameters=e.generateQueryParametersString(a,o)},e.prototype.constructUnifiedCacheQueryParameter=function(e,t){var r,n;if(e)if(e.account){var o=e.account;o.sid?(r=Wi.SID,n=o.sid):o.userName&&(r=Wi.LOGIN_HINT,n=o.userName)}else e.sid?(r=Wi.SID,n=e.sid):e.loginHint&&(r=Wi.LOGIN_HINT,n=e.loginHint);else t&&t.hasOwnProperty(Hi.upn)&&(r=Wi.ID_TOKEN,n=t.upn);return this.addSSOParameter(r,n)},e.prototype.addHintParameters=function(e,t){e&&!t[Wi.SID]&&(!t[Wi.LOGIN_HINT]&&e.sid&&this.promptValue===Xi.NONE?t=this.addSSOParameter(Wi.SID,e.sid,t):!t[Wi.LOGIN_HINT]&&e.userName&&!na.isEmpty(e.userName)&&(t=this.addSSOParameter(Wi.LOGIN_HINT,e.userName,t)));return t},e.prototype.addSSOParameter=function(e,t,r){if(r||(r={}),!t)return r;switch(e){case Wi.SID:r[Wi.SID]=t;break;case Wi.ID_TOKEN:case Wi.LOGIN_HINT:r[Wi.LOGIN_HINT]=t}return r},e.generateQueryParametersString=function(e,t){var r=null;return e&&Object.keys(e).forEach((function(n){n===Hi.domain_hint&&(t||e[Wi.SID])||(r?r+="&"+n+"="+encodeURIComponent(e[n]):r=n+"="+encodeURIComponent(e[n]))})),r},e.isSSOParam=function(e){return!(!e||!(e.account||e.sid||e.loginHint))},e.determineResponseType=function(e,t){return Ga.onlyContainsOidcScopes(t)?Bi:e?this.responseTypeForMatchingAccounts(t):Ki},e.responseTypeForMatchingAccounts=function(e){return Ga.containsAnyOidcScopes(e)?Ki:Gi},e}(),Ja=function(){function e(){}return e.prototype.sendRequestAsync=function(e,t,r){var n=this;return new Promise((function(r,o){var i=new XMLHttpRequest;if(i.open(t,e,!0),i.onload=function(){var e;(i.status<200||i.status>=300)&&o(n.handleError(i.responseText));try{e=JSON.parse(i.responseText)}catch(e){o(n.handleError(i.responseText))}var t={statusCode:i.status,body:e};r(t)},i.onerror=function(){o(i.status)},t!==Ji)throw"not implemented";i.send()}))},e.prototype.handleError=function(e){var t;try{if((t=JSON.parse(e)).error)return t.error;throw e}catch(t){return e}},e}(),Xa=function(){function e(){}return e.setTrustedAuthoritiesFromConfig=function(t,r){t&&!this.getTrustedHostList().length&&r.forEach((function(t){e.TrustedHostList.push(t.toLowerCase())}))},e.getAliases=function(e,t,r){return qi(this,void 0,void 0,(function(){var n,o,i,a;return Di(this,(function(s){return n=new Ja,o=Ji,i="https://login.microsoftonline.com/common//discovery/instance?api-version=1.1&authorization_endpoint="+e+"oauth2/v2.0/authorize",a=t.createAndStartHttpEvent(r,o,i,"getAliases"),[2,n.sendRequestAsync(i,o,!0).then((function(e){return a.httpResponseStatus=e.statusCode,t.stopEvent(a),e.body.metadata})).catch((function(e){throw a.serverErrorCode=e,t.stopEvent(a),e}))]}))}))},e.setTrustedAuthoritiesFromNetwork=function(t,r,n){return qi(this,void 0,void 0,(function(){var o;return Di(this,(function(i){switch(i.label){case 0:return[4,this.getAliases(t,r,n)];case 1:return i.sent().forEach((function(t){t.aliases.forEach((function(t){e.TrustedHostList.push(t.toLowerCase())}))})),o=Ka.GetUrlComponents(t).HostNameAndPort,e.getTrustedHostList().length&&!e.IsInTrustedHostList(o)&&e.TrustedHostList.push(o.toLowerCase()),[2]}}))}))},e.getTrustedHostList=function(){return this.TrustedHostList},e.IsInTrustedHostList=function(e){return this.TrustedHostList.indexOf(e.toLowerCase())>-1},e.TrustedHostList=[],e}();!function(e){e[e.Default=0]="Default",e[e.Adfs=1]="Adfs"}(Qi||(Qi={}));var Ya,Za=function(){function e(e,t,r){this.IsValidationEnabled=t,this.CanonicalAuthority=e,this.validateAsUri(),this.tenantDiscoveryResponse=r}return e.isAdfs=function(e){var t=Ka.GetUrlComponents(e).PathSegments;return t.length&&t[0].toLowerCase()===Hi.ADFS},Object.defineProperty(e.prototype,"AuthorityType",{get:function(){return e.isAdfs(this.canonicalAuthority)?Qi.Adfs:Qi.Default},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Tenant",{get:function(){return this.CanonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"AuthorizationEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.AuthorizationEndpoint.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"EndSessionEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.EndSessionEndpoint.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SelfSignedJwtAudience",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.Issuer.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!0,configurable:!0}),e.prototype.validateResolved=function(){if(!this.hasCachedMetadata())throw"Please call ResolveEndpointsAsync first"},Object.defineProperty(e.prototype,"CanonicalAuthority",{get:function(){return this.canonicalAuthority},set:function(e){this.canonicalAuthority=Ka.CanonicalizeUri(e),this.canonicalAuthorityUrlComponents=null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CanonicalAuthorityUrlComponents",{get:function(){return this.canonicalAuthorityUrlComponents||(this.canonicalAuthorityUrlComponents=Ka.GetUrlComponents(this.CanonicalAuthority)),this.canonicalAuthorityUrlComponents},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DefaultOpenIdConfigurationEndpoint",{get:function(){return this.AuthorityType===Qi.Adfs?this.CanonicalAuthority+".well-known/openid-configuration":this.CanonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!0,configurable:!0}),e.prototype.validateAsUri=function(){var e;try{e=this.CanonicalAuthorityUrlComponents}catch(e){throw xa}if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw ja;if(!e.PathSegments||e.PathSegments.length<1)throw Ma},e.prototype.DiscoverEndpoints=function(e,t,r){var n=new Ja,o=Ji,i=t.createAndStartHttpEvent(r,o,e,"openIdConfigurationEndpoint");return n.sendRequestAsync(e,o,!0).then((function(e){return i.httpResponseStatus=e.statusCode,t.stopEvent(i),{AuthorizationEndpoint:e.body.authorization_endpoint,EndSessionEndpoint:e.body.end_session_endpoint,Issuer:e.body.issuer}})).catch((function(e){throw i.serverErrorCode=e,t.stopEvent(i),e}))},e.prototype.resolveEndpointsAsync=function(e,t){return qi(this,void 0,void 0,(function(){var r,n,o;return Di(this,(function(i){switch(i.label){case 0:return this.IsValidationEnabled?(r=this.canonicalAuthorityUrlComponents.HostNameAndPort,0!==Xa.getTrustedHostList().length?[3,2]:[4,Xa.setTrustedAuthoritiesFromNetwork(this.canonicalAuthority,e,t)]):[3,3];case 1:i.sent(),i.label=2;case 2:if(!Xa.IsInTrustedHostList(r))throw Ba.createUntrustedAuthorityError(r);i.label=3;case 3:return n=this.GetOpenIdConfigurationEndpoint(),o=this,[4,this.DiscoverEndpoints(n,e,t)];case 4:return o.tenantDiscoveryResponse=i.sent(),[2,this.tenantDiscoveryResponse]}}))}))},e.prototype.hasCachedMetadata=function(){return!!(this.tenantDiscoveryResponse&&this.tenantDiscoveryResponse.AuthorizationEndpoint&&this.tenantDiscoveryResponse.EndSessionEndpoint&&this.tenantDiscoveryResponse.Issuer)},e.prototype.GetOpenIdConfigurationEndpoint=function(){return this.DefaultOpenIdConfigurationEndpoint},e}(),es=function(){function e(t,r){if(!t||na.isEmpty(t))return this.uid="",void(this.utid="");try{var n=Ui.base64Decode(t),o=JSON.parse(n);o&&(o.hasOwnProperty("uid")&&(this.uid=r?e.stripPolicyFromUid(o.uid,r):o.uid),o.hasOwnProperty("utid")&&(this.utid=o.utid))}catch(e){throw Ia.createClientInfoDecodingError(e)}}return Object.defineProperty(e.prototype,"uid",{get:function(){return this._uid?this._uid:""},set:function(e){this._uid=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"utid",{get:function(){return this._utid?this._utid:""},set:function(e){this._utid=e},enumerable:!0,configurable:!0}),e.createClientInfoFromIdToken=function(t,r){var n={uid:t.subject,utid:""};return new e(Ui.base64Encode(JSON.stringify(n)),r)},e.stripPolicyFromUid=function(e,t){var r=e.split("-"),n=t.split("/").reverse(),o="";return na.isEmpty(n[0])?n.length>1&&(o=n[1]):o=n[0],r[r.length-1]===o?r.slice(0,r.length-1).join("-"):e},e.prototype.encodeClientInfo=function(){var e=JSON.stringify({uid:this.uid,utid:this.utid});return Ui.base64Encode(e)},e}(),ts=function(){function e(){}return e.parseExpiresIn=function(e){return e||(e="3599"),parseInt(e,10)},e.now=function(){return Math.round((new Date).getTime()/1e3)},e.relativeNowMs=function(){return window.performance.now()},e}(),rs=function(){function e(){}return e.decodeJwt=function(e){if(na.isEmpty(e))return null;var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);return!t||t.length<4?null:{header:t[1],JWSPayload:t[2],JWSSig:t[3]}},e.validateExpirationIsWithinOffset=function(e,t){var r=t||300;return e&&e>ts.now()+r},e.extractIdToken=function(e){var t=this.decodeJwt(e);if(!t)return null;try{var r=t.JWSPayload,n=Ui.base64Decode(r);return n?JSON.parse(n):null}catch(e){}return null},e}(),ns=function(e){if(na.isEmpty(e))throw Ia.createIdTokenNullOrEmptyError(e);try{this.rawIdToken=e,this.claims=rs.extractIdToken(e),this.claims&&(this.claims.hasOwnProperty("iss")&&(this.issuer=this.claims.iss),this.claims.hasOwnProperty("oid")&&(this.objectId=this.claims.oid),this.claims.hasOwnProperty("sub")&&(this.subject=this.claims.sub),this.claims.hasOwnProperty("tid")&&(this.tenantId=this.claims.tid),this.claims.hasOwnProperty("ver")&&(this.version=this.claims.ver),this.claims.hasOwnProperty("preferred_username")?this.preferredName=this.claims.preferred_username:this.claims.hasOwnProperty("upn")&&(this.preferredName=this.claims.upn),this.claims.hasOwnProperty("name")&&(this.name=this.claims.name),this.claims.hasOwnProperty("nonce")&&(this.nonce=this.claims.nonce),this.claims.hasOwnProperty("exp")&&(this.expiration=this.claims.exp),this.claims.hasOwnProperty("home_oid")&&(this.homeObjectId=this.claims.home_oid),this.claims.hasOwnProperty("sid")&&(this.sid=this.claims.sid),this.claims.hasOwnProperty("cloud_instance_host_name")&&(this.cloudInstance=this.claims.cloud_instance_host_name))}catch(e){throw Ia.createIdTokenParsingError(e)}},os=function(e,t){this.key=e,this.value=t},is=function(){function e(e){if(!window)throw ra.createNoWindowObjectError("Browser storage class could not find window object");if(!(void 0!==window[e]&&null!==window[e]))throw Ba.createStorageNotSupportedError(e);this.cacheLocation=e}return e.prototype.setItem=function(e,t,r){window[this.cacheLocation].setItem(e,t),r&&this.setItemCookie(e,t)},e.prototype.getItem=function(e,t){return t&&this.getItemCookie(e)?this.getItemCookie(e):window[this.cacheLocation].getItem(e)},e.prototype.removeItem=function(e){return window[this.cacheLocation].removeItem(e)},e.prototype.clear=function(){return window[this.cacheLocation].clear()},e.prototype.setItemCookie=function(e,t,r){var n=encodeURIComponent(e)+"="+encodeURIComponent(t)+";path=/;";r&&(n+="expires="+this.getCookieExpirationTime(r)+";");document.cookie=n},e.prototype.getItemCookie=function(e){for(var t=encodeURIComponent(e)+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){for(var o=r[n];" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(t))return decodeURIComponent(o.substring(t.length,o.length))}return""},e.prototype.clearItemCookie=function(e){this.setItemCookie(e,"",-1)},e.prototype.getCookieExpirationTime=function(e){var t=new Date;return new Date(t.getTime()+24*e*60*60*1e3).toUTCString()},e}(),as=function(){function e(){}return e.validateRequest=function(e,t,r,n){if(!t&&!e)throw Ba.createEmptyRequestError();var o,i;e&&(o=t?Ga.appendScopes(e.scopes,e.extraScopesToConsent):e.scopes,Ga.validateInputScope(o,!t),o=Ga.translateClientIdIfSingleScope(o,r),this.validatePromptParameter(e.prompt),i=this.validateEQParameters(e.extraQueryParameters,e.claimsRequest),this.validateClaimsRequest(e.claimsRequest));var a=this.validateAndGenerateState(e&&e.state,n),s=this.validateAndGenerateCorrelationId(e&&e.correlationId);return Mi({},e,{extraQueryParameters:i,scopes:o,state:a,correlationId:s})},e.validatePromptParameter=function(e){if(e&&[Xi.LOGIN,Xi.SELECT_ACCOUNT,Xi.CONSENT,Xi.NONE].indexOf(e)<0)throw Ba.createInvalidPromptError(e)},e.validateEQParameters=function(e,t){var r=Mi({},e);return r?(t&&delete r[Hi.claims],$i.forEach((function(e){r[e]&&delete r[e]})),r):null},e.validateClaimsRequest=function(e){if(e)try{JSON.parse(e)}catch(e){throw Ba.createClaimsRequestParsingError(e)}},e.validateAndGenerateState=function(t,r){return na.isEmpty(t)?e.generateLibraryState(r):""+e.generateLibraryState(r)+Hi.resourceDelimiter+t},e.generateLibraryState=function(e){var t={id:Ui.createNewGuid(),ts:ts.now(),method:e},r=JSON.stringify(t);return Ui.base64Encode(r)},e.parseLibraryState=function(e){var t=decodeURIComponent(e).split(Hi.resourceDelimiter)[0];if(Ui.isGuid(t))return{id:t,ts:ts.now(),method:Hi.interactionTypeRedirect};try{var r=Ui.base64Decode(t);return JSON.parse(r)}catch(t){throw Ia.createInvalidStateError(e,null)}},e.validateAndGenerateCorrelationId=function(e){if(e&&!Ui.isGuid(e))throw Ba.createInvalidCorrelationIdError();return Ui.isGuid(e)?e:Ui.createNewGuid()},e.createRequestSignature=function(e){return""+e.scopes.join(" ").toLowerCase()+Hi.resourceDelimiter+e.authority},e}(),ss=function(e){function t(t,r,n){var o=e.call(this,r)||this;return o.clientId=t,o.rollbackEnabled=!0,o.migrateCacheEntries(n),o}return ji(t,e),t.prototype.migrateCacheEntries=function(t){var r,n=this,o=Hi.cachePrefix+"."+Fi.IDTOKEN,i=Hi.cachePrefix+"."+Fi.CLIENT_INFO,a=Hi.cachePrefix+"."+Vi.ERROR,s=Hi.cachePrefix+"."+Vi.ERROR_DESC,c=e.prototype.getItem.call(this,o);if(c)try{r=new ns(c)}catch(e){return}if(r&&r.claims&&r.claims.aud===this.clientId){var u=[c,e.prototype.getItem.call(this,i),e.prototype.getItem.call(this,a),e.prototype.getItem.call(this,s)];[Fi.IDTOKEN,Fi.CLIENT_INFO,Vi.ERROR,Vi.ERROR_DESC].forEach((function(e,r){return n.duplicateCacheEntry(e,u[r],t)}))}},t.prototype.duplicateCacheEntry=function(e,t,r){t&&this.setItem(e,t,r)},t.prototype.generateCacheKey=function(e,t){try{return JSON.parse(e),e}catch(r){return 0===e.indexOf(""+Hi.cachePrefix)||0===e.indexOf(Hi.adalIdToken)?e:t?Hi.cachePrefix+"."+this.clientId+"."+e:Hi.cachePrefix+"."+e}},t.prototype.matchKeyForType=function(e,t,r,n){var o=na.validateAndParseJsonCacheKey(e);if(!o)return null;var i=e.match(t)&&e.match(r),a=!1;switch(n){case Li.ACCESS_TOKEN:a=!!e.match(Hi.scopes);break;case Li.ID_TOKEN:a=!e.match(Hi.scopes)}return i&&a?o:null},t.prototype.setItem=function(t,r,n){e.prototype.setItem.call(this,this.generateCacheKey(t,!0),r,n),this.rollbackEnabled&&!n&&e.prototype.setItem.call(this,this.generateCacheKey(t,!1),r,n)},t.prototype.getItem=function(t,r){return e.prototype.getItem.call(this,this.generateCacheKey(t,!0),r)},t.prototype.removeItem=function(t){e.prototype.removeItem.call(this,this.generateCacheKey(t,!0)),this.rollbackEnabled&&e.prototype.removeItem.call(this,this.generateCacheKey(t,!1))},t.prototype.resetCacheItems=function(){var t,r=window[this.cacheLocation];for(t in r)r.hasOwnProperty(t)&&-1!==t.indexOf(Hi.cachePrefix)&&e.prototype.removeItem.call(this,t)},t.prototype.resetTempCacheItems=function(t){var r=this,n=t&&as.parseLibraryState(t).id,o=this.tokenRenewalInProgress(t),i=window[this.cacheLocation];n&&!o&&Object.keys(i).forEach((function(t){-1!==t.indexOf(n)&&(r.removeItem(t),e.prototype.clearItemCookie.call(r,t))})),this.removeItem(zi.INTERACTION_STATUS),this.removeItem(zi.REDIRECT_REQUEST)},t.prototype.setItemCookie=function(t,r,n){e.prototype.setItemCookie.call(this,this.generateCacheKey(t,!0),r,n),this.rollbackEnabled&&e.prototype.setItemCookie.call(this,this.generateCacheKey(t,!1),r,n)},t.prototype.clearItemCookie=function(t){e.prototype.clearItemCookie.call(this,this.generateCacheKey(t,!0)),this.rollbackEnabled&&e.prototype.clearItemCookie.call(this,this.generateCacheKey(t,!1))},t.prototype.getItemCookie=function(t){return e.prototype.getItemCookie.call(this,this.generateCacheKey(t,!0))},t.prototype.getAllTokensByType=function(e,t,r){var n=this;return Object.keys(window[this.cacheLocation]).reduce((function(o,i){var a=n.matchKeyForType(i,e,t,r);if(a){var s=n.getItem(i);if(s)try{var c=new os(a,JSON.parse(s));return o.concat([c])}catch(e){return o}}return o}),[])},t.prototype.getAllAccessTokens=function(e,t){return this.getAllTokensByType(e,t,Li.ACCESS_TOKEN)},t.prototype.getAllIdTokens=function(e,t){return this.getAllTokensByType(e,t,Li.ID_TOKEN)},t.prototype.getAllTokens=function(e,t){var r=this.getAllAccessTokens(e,t),n=this.getAllIdTokens(e,t);return r.concat(n)},t.prototype.tokenRenewalInProgress=function(e){var r=this.getItem(t.generateTemporaryCacheKey(zi.RENEW_STATUS,e));return!(!r||r!==Hi.inProgress)},t.prototype.clearMsalCookie=function(r){var n=this;r?(this.clearItemCookie(t.generateTemporaryCacheKey(zi.NONCE_IDTOKEN,r)),this.clearItemCookie(t.generateTemporaryCacheKey(zi.STATE_LOGIN,r)),this.clearItemCookie(t.generateTemporaryCacheKey(zi.LOGIN_REQUEST,r)),this.clearItemCookie(t.generateTemporaryCacheKey(zi.STATE_ACQ_TOKEN,r))):document.cookie.split(";").forEach((function(t){var r=t.trim().split("=")[0];r.indexOf(Hi.cachePrefix)>-1&&e.prototype.clearItemCookie.call(n,r)}))},t.generateAcquireTokenAccountKey=function(e,t){var r=as.parseLibraryState(t).id;return""+zi.ACQUIRE_TOKEN_ACCOUNT+Hi.resourceDelimiter+e+Hi.resourceDelimiter+r},t.generateAuthorityKey=function(e){return t.generateTemporaryCacheKey(zi.AUTHORITY,e)},t.generateTemporaryCacheKey=function(e,t){var r=as.parseLibraryState(t).id;return""+e+Hi.resourceDelimiter+r},t}(is),cs=function(){function e(e,t,r,n,o,i,a){this.accountIdentifier=e,this.homeAccountIdentifier=t,this.userName=r,this.name=n,this.idToken=o,this.idTokenClaims=o,this.sid=i,this.environment=a}return e.createAccount=function(t,r){var n,o=t.objectId||t.subject,i=r?r.uid:"",a=r?r.utid:"";return na.isEmpty(i)||(n=na.isEmpty(a)?Ui.base64Encode(i):Ui.base64Encode(i)+"."+Ui.base64Encode(a)),new e(o,n,t.preferredName,t.name,t.claims,t.sid,t.issuer)},e.compareAccounts=function(e,t){return!(!e||!t)&&!(!e.homeAccountIdentifier||!t.homeAccountIdentifier||e.homeAccountIdentifier!==t.homeAccountIdentifier)},e}(),us=function(){function e(){}return e.isInIframe=function(){return window.parent!==window},e.isInPopup=function(){return!(!window.opener||window.opener===window)},e.generateFrameName=function(e,t){return""+e+Hi.resourceDelimiter+t},e.monitorIframeForHash=function(t,r,n,o){return new Promise((function(i,a){var s=ts.relativeNowMs()+r;o.verbose("monitorWindowForIframe polling started");var c=setInterval((function(){if(ts.relativeNowMs()>s)return o.error("monitorIframeForHash unable to find hash in url, timing out"),o.errorPii("monitorIframeForHash polling timed out for url: "+n),clearInterval(c),void a(Ia.createTokenRenewalTimeoutError());var e;try{e=t.location.href}catch(e){}e&&Ka.urlContainsHash(e)&&(o.verbose("monitorIframeForHash found url in hash"),clearInterval(c),i(t.location.hash))}),e.POLLING_INTERVAL_MS)}))},e.monitorPopupForHash=function(t,r,n,o){return new Promise((function(i,a){var s=r/e.POLLING_INTERVAL_MS,c=0;o.verbose("monitorWindowForHash polling started");var u=setInterval((function(){if(t.closed)return o.error("monitorWindowForHash window closed"),clearInterval(u),void a(Ia.createUserCancelledError());var e;try{e=t.location.href}catch(e){}e&&"about:blank"!==e&&(c++,e&&Ka.urlContainsHash(e)?(o.verbose("monitorPopupForHash found url in hash"),clearInterval(u),i(t.location.hash)):c>s&&(o.error("monitorPopupForHash unable to find hash in url, timing out"),o.errorPii("monitorPopupForHash polling timed out for url: "+n),clearInterval(u),a(Ia.createTokenRenewalTimeoutError())))}),e.POLLING_INTERVAL_MS)}))},e.loadFrame=function(e,t,r,n){var o=this;return n.infoPii("LoadFrame: "+t),new Promise((function(i,a){setTimeout((function(){var r=o.loadFrameSync(e,t,n);r?i(r):a("Unable to load iframe with name: "+t)}),r)}))},e.loadFrameSync=function(t,r,n){var o=e.addHiddenIFrame(r,n);return o?(""!==o.src&&"about:blank"!==o.src||(o.src=t,n.infoPii("Frame Name : "+r+" Navigated to: "+t)),o):null},e.addHiddenIFrame=function(e,t){if(void 0===e)return null;t.infoPii("Add msal frame to document:"+e);var r=document.getElementById(e);if(!r){if(document.createElement&&document.documentElement&&-1===window.navigator.userAgent.indexOf("MSIE 5.0")){var n=document.createElement("iframe");n.setAttribute("id",e),n.setAttribute("aria-hidden","true"),n.style.visibility="hidden",n.style.position="absolute",n.style.width=n.style.height="0",n.style.border="0",n.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),r=document.getElementsByTagName("body")[0].appendChild(n)}else document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeend","<iframe name='"+e+"' id='"+e+"' style='display:none'></iframe>");window.frames&&window.frames[e]&&(r=window.frames[e])}return r},e.removeHiddenIframe=function(e){document.body===e.parentNode&&document.body.removeChild(e)},e.getIframeWithHash=function(e){var t=document.getElementsByTagName("iframe");return Array.apply(null,Array(t.length)).map((function(e,r){return t.item(r)})).filter((function(t){try{return t.contentWindow.location.hash===e}catch(e){return!1}}))[0]},e.getPopups=function(){return window.openedWindows||(window.openedWindows=[]),window.openedWindows},e.getPopUpWithHash=function(t){return e.getPopups().filter((function(e){try{return e.location.hash===t}catch(e){return!1}}))[0]},e.trackPopup=function(t){e.getPopups().push(t)},e.closePopups=function(){e.getPopups().forEach((function(e){return e.close()}))},e.blockReloadInHiddenIframes=function(){if(Ka.urlContainsHash(window.location.hash)&&e.isInIframe())throw Ia.createBlockTokenRequestsInHiddenIframeError()},e.checkIfBackButtonIsPressed=function(e){var t=e.getItem(zi.REDIRECT_REQUEST);if(t&&!Ka.urlContainsHash(window.location.hash)){var r=t.split(Hi.resourceDelimiter);r.shift();var n=r.length>0?r.join(Hi.resourceDelimiter):null;e.resetTempCacheItems(n)}},e.clearUrlFragment=function(){"function"==typeof history.replaceState?history.replaceState(null,null,""+window.location.pathname+window.location.search):window.location.hash=""},e.POLLING_INTERVAL_MS=50,e}(),ls=function(){function e(){}return e.setResponseIdToken=function(e,t){if(!e)return null;if(!t)return e;var r=Number(t.expiration);return r&&!e.expiresOn&&(e.expiresOn=new Date(1e3*r)),Mi({},e,{idToken:t,idTokenClaims:t.claims,uniqueId:t.objectId||t.subject,tenantId:t.tenantId})},e.buildAuthResponse=function(t,r,n,o,i,a){switch(n.responseType){case Bi:return r=Mi({},r,{tokenType:Li.ID_TOKEN,account:o,scopes:i,accountState:a}),(r=e.setResponseIdToken(r,t)).idToken?r:null;case Ki:return(r=e.setResponseIdToken(r,t))&&r.accessToken&&r.idToken?r:null;case Gi:return r=e.setResponseIdToken(r,t);default:return null}},e}(),ps=function(){function e(){}return e.saveMetadataFromNetwork=function(e,t,r){return qi(this,void 0,void 0,(function(){var n;return Di(this,(function(o){switch(o.label){case 0:return[4,e.resolveEndpointsAsync(t,r)];case 1:return n=o.sent(),this.metadataMap.set(e.CanonicalAuthority,n),[2,n]}}))}))},e.getMetadata=function(e){return this.metadataMap.get(e)},e.saveMetadataFromConfig=function(e,t){try{if(t){var r=JSON.parse(t);if(!r.authorization_endpoint||!r.end_session_endpoint||!r.issuer)throw Ba.createInvalidAuthorityMetadataError();this.metadataMap.set(e,{AuthorizationEndpoint:r.authorization_endpoint,EndSessionEndpoint:r.end_session_endpoint,Issuer:r.issuer})}}catch(e){throw Ba.createInvalidAuthorityMetadataError()}},e.CreateInstance=function(e,t,r){return na.isEmpty(e)?null:(r&&this.saveMetadataFromConfig(e,r),new Za(e,t,this.metadataMap.get(e)))},e.metadataMap=new Map,e}();!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose"}(Ya||(Ya={}));var ds=function(){function e(e,t){void 0===t&&(t={}),this.level=Ya.Info;var r=t.correlationId,n=void 0===r?"":r,o=t.level,i=void 0===o?Ya.Info:o,a=t.piiLoggingEnabled,s=void 0!==a&&a;this.localCallback=e,this.correlationId=n,this.level=i,this.piiLoggingEnabled=s}return e.prototype.logMessage=function(e,t,r){if(!(e>this.level||!this.piiLoggingEnabled&&r)){var n,o=(new Date).toUTCString();n=na.isEmpty(this.correlationId)?o+":1.4.10-"+Ya[e]+(r?"-pii":"")+" "+t:o+":"+this.correlationId+"-1.4.10-"+Ya[e]+(r?"-pii":"")+" "+t,this.executeCallback(e,n,r)}},e.prototype.executeCallback=function(e,t,r){this.localCallback&&this.localCallback(e,t,r)},e.prototype.error=function(e){this.logMessage(Ya.Error,e,!1)},e.prototype.errorPii=function(e){this.logMessage(Ya.Error,e,!0)},e.prototype.warning=function(e){this.logMessage(Ya.Warning,e,!1)},e.prototype.warningPii=function(e){this.logMessage(Ya.Warning,e,!0)},e.prototype.info=function(e){this.logMessage(Ya.Info,e,!1)},e.prototype.infoPii=function(e){this.logMessage(Ya.Info,e,!0)},e.prototype.verbose=function(e){this.logMessage(Ya.Verbose,e,!1)},e.prototype.verbosePii=function(e){this.logMessage(Ya.Verbose,e,!0)},e.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled},e}(),fs={clientId:"",authority:null,validateAuthority:!0,authorityMetadata:"",knownAuthorities:[],redirectUri:function(){return Ka.getCurrentUrl()},postLogoutRedirectUri:function(){return Ka.getCurrentUrl()},navigateToLoginRequestUrl:!0},hs={cacheLocation:"sessionStorage",storeAuthStateInCookie:!1},ys={logger:new ds(null),loadFrameTimeout:6e3,tokenRenewalOffsetSeconds:300,navigateFrameWait:500},gs={isAngular:!1,unprotectedResources:new Array,protectedResourceMap:new Map};var ms={code:"server_unavailable",desc:"Server is temporarily unavailable."},vs={code:"unknown_server_error"},bs=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="ServerError",Object.setPrototypeOf(o,t.prototype),o}return ji(t,e),t.createServerUnavailableError=function(){return new t(ms.code,ms.desc)},t.createUnknownServerError=function(e){return new t(vs.code,e)},t}(ra),ws={code:"interaction_required"},Ss={code:"consent_required"},Ts={code:"login_required"},Es=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="InteractionRequiredAuthError",Object.setPrototypeOf(o,t.prototype),o}return ji(t,e),t.isInteractionRequiredError=function(e){var t=[ws.code,Ss.code,Ts.code];return e&&t.indexOf(e)>-1},t.createLoginRequiredAuthError=function(e){return new t(Ts.code,e)},t.createInteractionRequiredAuthError=function(e){return new t(ws.code,e)},t.createConsentRequiredAuthError=function(e){return new t(Ss.code,e)},t}(bs);function Is(e){return{uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:"",scopes:null,expiresOn:null,account:null,accountState:e,fromCache:!1}}var Cs,As,Os,Ps="Microsoft.MSAL.correlation_id",Rs="msal.api_telem_id",_s="msal.api_id",Ns="Microsoft_MSAL_cache_event_count",ks="Microsoft_MSAL_http_event_count",xs="Microsoft_MSAL_ui_event_count",js=function(e){var t=Ka.GetUrlComponents(e);if(Za.isAdfs(e))return e;var r=t.PathSegments;if(r&&r.length>=2){var n="tfp"===r[1]?2:1;n<r.length&&(r[n]="<tenant>")}return t.Protocol+"//"+t.HostNameAndPort+"/"+r.join("/")},Ms=function(e){return Ui.base64Encode(e)},qs=function(e){return"msal."+(e||"")},Ds=function(){return!!("undefined"!=typeof window&&"performance"in window&&window.performance.mark&&window.performance.measure)},Ls=function(){function e(e,t,r){var n;this.eventId=Ui.createNewGuid(),this.label=r,this.event=((n={})[qs("event_name")]=e,n[qs("elapsed_time")]=-1,n[""+Ps]=t,n)}return e.prototype.setElapsedTime=function(e){this.event[qs("elapsed_time")]=e},e.prototype.stop=function(){var e,t,r;this.setElapsedTime(+Date.now()-+this.startTimestamp),e=this.displayName,t=this.perfStartMark,r=this.perfEndMark,Ds()&&(window.performance.mark(r),window.performance.measure(e,t,r),window.performance.clearMeasures(e),window.performance.clearMarks(t),window.performance.clearMarks(r))},e.prototype.start=function(){var e;this.startTimestamp=Date.now(),this.event[qs("start_time")]=this.startTimestamp,e=this.perfStartMark,Ds()&&window.performance.mark(e)},Object.defineProperty(e.prototype,"telemetryCorrelationId",{get:function(){return this.event[""+Ps]},set:function(e){this.event[""+Ps]=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"eventName",{get:function(){return this.event[qs("event_name")]},enumerable:!0,configurable:!0}),e.prototype.get=function(){return Mi({},this.event,{eventId:this.eventId})},Object.defineProperty(e.prototype,"key",{get:function(){return this.telemetryCorrelationId+"_"+this.eventId+"-"+this.eventName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"displayName",{get:function(){return"Msal-"+this.label+"-"+this.telemetryCorrelationId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"perfStartMark",{get:function(){return"start-"+this.key},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"perfEndMark",{get:function(){return"end-"+this.key},enumerable:!0,configurable:!0}),e}(),Us=function(e){function t(t,r,n,o){var i=e.call(this,qs("default_event"),r,"DefaultEvent")||this;return i.event[qs("client_id")]=n,i.event[qs("sdk_plaform")]=t.sdk,i.event[qs("sdk_version")]=t.sdkVersion,i.event[qs("application_name")]=t.applicationName,i.event[qs("application_version")]=t.applicationVersion,i.event[qs("effective_connection_speed")]=t.networkInformation&&t.networkInformation.connectionSpeed,i.event[""+xs]=i.getEventCount(qs("ui_event"),o),i.event[""+ks]=i.getEventCount(qs("http_event"),o),i.event[""+Ns]=i.getEventCount(qs("cache_event"),o),i}return ji(t,e),t.prototype.getEventCount=function(e,t){return t[e]?t[e]:0},t}(Ls),Hs=qs("authority"),zs=qs("authority_type"),Fs=qs("ui_behavior"),Vs=qs("tenant_id"),Bs=qs("user_id"),Gs=qs("was_successful"),Ks=qs("api_error_code"),Ws=qs("login_hint");!function(e){e[e.AcquireTokenRedirect=2001]="AcquireTokenRedirect",e[e.AcquireTokenSilent=2002]="AcquireTokenSilent",e[e.AcquireTokenPopup=2003]="AcquireTokenPopup",e[e.LoginRedirect=2004]="LoginRedirect",e[e.LoginPopup=2005]="LoginPopup",e[e.Logout=2006]="Logout"}(As||(As={})),function(e){e.AcquireTokenRedirect="AcquireTokenRedirect",e.AcquireTokenSilent="AcquireTokenSilent",e.AcquireTokenPopup="AcquireTokenPopup",e.LoginRedirect="LoginRedirect",e.LoginPopup="LoginPopup",e.Logout="Logout"}(Os||(Os={}));var Qs=((Cs={})[Os.AcquireTokenSilent]=As.AcquireTokenSilent,Cs[Os.AcquireTokenPopup]=As.AcquireTokenPopup,Cs[Os.AcquireTokenRedirect]=As.AcquireTokenRedirect,Cs[Os.LoginPopup]=As.LoginPopup,Cs[Os.LoginRedirect]=As.LoginRedirect,Cs[Os.Logout]=As.Logout,Cs),$s=function(e){function t(t,r,n){var o=e.call(this,qs("api_event"),t,n)||this;return n&&(o.apiCode=Qs[n],o.apiEventIdentifier=n),o.piiEnabled=r,o}return ji(t,e),Object.defineProperty(t.prototype,"apiEventIdentifier",{set:function(e){this.event[Rs]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"apiCode",{set:function(e){this.event[_s]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authority",{set:function(e){this.event[Hs]=js(e).toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"apiErrorCode",{set:function(e){this.event[Ks]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tenantId",{set:function(e){this.event[Vs]=this.piiEnabled&&e?Ms(e):null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"accountId",{set:function(e){this.event[Bs]=this.piiEnabled&&e?Ms(e):null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"wasSuccessful",{get:function(){return!0===this.event[Gs]},set:function(e){this.event[Gs]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"loginHint",{set:function(e){this.event[Ws]=this.piiEnabled&&e?Ms(e):null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authorityType",{set:function(e){this.event[zs]=e.toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"promptType",{set:function(e){this.event[Fs]=e.toLowerCase()},enumerable:!0,configurable:!0}),t}(Ls),Js=qs("http_path"),Xs=qs("user_agent"),Ys=qs("query_parameters"),Zs=qs("api_version"),ec=qs("response_code"),tc=qs("oauth_error_code"),rc=qs("http_method"),nc=qs("request_id_header"),oc=qs("spe_info"),ic=qs("server_error_code"),ac=qs("server_sub_error_code"),sc=qs("url"),cc=function(e){function t(t,r){return e.call(this,qs("http_event"),t,r)||this}return ji(t,e),Object.defineProperty(t.prototype,"url",{set:function(e){var t=js(e);this.event[sc]=t&&t.toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"httpPath",{set:function(e){this.event[Js]=js(e).toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userAgent",{set:function(e){this.event[Xs]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"queryParams",{set:function(e){this.event[Ys]=$a.generateQueryParametersString(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"apiVersion",{set:function(e){this.event[Zs]=e.toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"httpResponseStatus",{set:function(e){this.event[ec]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"oAuthErrorCode",{set:function(e){this.event[tc]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"httpMethod",{set:function(e){this.event[rc]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"requestIdHeader",{set:function(e){this.event[nc]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"speInfo",{set:function(e){this.event[oc]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"serverErrorCode",{set:function(e){this.event[ic]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"serverSubErrorCode",{set:function(e){this.event[ac]=e},enumerable:!0,configurable:!0}),t}(Ls),uc=function(){function e(e,t,r){this.completedEvents={},this.inProgressEvents={},this.eventCountByCorrelationId={},this.onlySendFailureTelemetry=!1,this.telemetryPlatform=Mi({sdk:Hi.libraryName,sdkVersion:"1.4.10",networkInformation:{connectionSpeed:"undefined"!=typeof navigator&&navigator.connection&&navigator.connection.effectiveType}},e.platform),this.clientId=e.clientId,this.onlySendFailureTelemetry=e.onlySendFailureTelemetry,this.telemetryEmitter=t,this.logger=r}return e.getTelemetrymanagerStub=function(e,t){return new this({platform:{applicationName:"UnSetStub",applicationVersion:"0.0"},clientId:e},(function(){}),t)},e.prototype.startEvent=function(e){this.logger.verbose("Telemetry Event started: "+e.key),this.telemetryEmitter&&(e.start(),this.inProgressEvents[e.key]=e)},e.prototype.stopEvent=function(e){if(this.logger.verbose("Telemetry Event stopped: "+e.key),this.telemetryEmitter&&this.inProgressEvents[e.key]){e.stop(),this.incrementEventCount(e);var t=this.completedEvents[e.telemetryCorrelationId];this.completedEvents[e.telemetryCorrelationId]=(t||[]).concat([e]),delete this.inProgressEvents[e.key]}},e.prototype.flush=function(e){var t=this;if(this.logger.verbose("Flushing telemetry events: "+e),this.telemetryEmitter&&this.completedEvents[e]){var r=this.getOrphanedEvents(e);r.forEach((function(e){return t.incrementEventCount(e)}));var n=this.completedEvents[e].concat(r);delete this.completedEvents[e];var o=this.eventCountByCorrelationId[e];if(delete this.eventCountByCorrelationId[e],n&&n.length){var i=new Us(this.telemetryPlatform,e,this.clientId,o),a=n.concat([i]);this.telemetryEmitter(a.map((function(e){return e.get()})))}}},e.prototype.createAndStartApiEvent=function(e,t){var r=new $s(e,this.logger.isPiiLoggingEnabled(),t);return this.startEvent(r),r},e.prototype.stopAndFlushApiEvent=function(e,t,r,n){t.wasSuccessful=r,n&&(t.apiErrorCode=n),this.stopEvent(t),this.flush(e)},e.prototype.createAndStartHttpEvent=function(e,t,r,n){var o=new cc(e,n);return o.url=r,o.httpMethod=t,this.startEvent(o),o},e.prototype.incrementEventCount=function(e){var t,r=e.eventName,n=this.eventCountByCorrelationId[e.telemetryCorrelationId];n?n[r]=n[r]?n[r]+1:1:this.eventCountByCorrelationId[e.telemetryCorrelationId]=((t={})[r]=1,t)},e.prototype.getOrphanedEvents=function(e){var t=this;return Object.keys(this.inProgressEvents).reduce((function(r,n){if(-1!==n.indexOf(e)){var o=t.inProgressEvents[n];return delete t.inProgressEvents[n],r.concat([o])}return r}),[])},e}(),lc=function(){function e(){}return e.filterTokenCacheItemsByScope=function(e,t){return e.filter((function(e){var r=e.key.scopes.split(" "),n=Ga.removeDefaultScopes(t);return 0===n.length?Ga.containsScope(r,t):Ga.containsScope(r,n)}))},e.filterTokenCacheItemsByAuthority=function(e,t){return e.filter((function(e){return Ka.CanonicalizeUri(e.key.authority)===t}))},e.filterTokenCacheItemsByDomain=function(e,t){return e.filter((function(e){return Ka.GetUrlComponents(e.key.authority).HostNameAndPort===t}))},e}(),pc=function(){function e(e){this.authResponseCallback=null,this.tokenReceivedCallback=null,this.errorReceivedCallback=null,this.config=function(e){var t=e.auth,r=e.cache,n=void 0===r?{}:r,o=e.system,i=void 0===o?{}:o,a=e.framework,s=void 0===a?{}:a;return{auth:Mi({},fs,t),cache:Mi({},hs,n),system:Mi({},ys,i),framework:Mi({},gs,s)}}(e),this.logger=this.config.system.logger,this.clientId=this.config.auth.clientId,this.inCookie=this.config.cache.storeAuthStateInCookie,this.telemetryManager=this.getTelemetryManagerFromConfig(this.config.system.telemetry,this.clientId),Xa.setTrustedAuthoritiesFromConfig(this.config.auth.validateAuthority,this.config.auth.knownAuthorities),ps.saveMetadataFromConfig(this.config.auth.authority,this.config.auth.authorityMetadata),this.authority=this.config.auth.authority||"https://login.microsoftonline.com/common",this.cacheStorage=new ss(this.clientId,this.config.cache.cacheLocation,this.inCookie),window.activeRenewals={},window.renewStates=[],window.callbackMappedToRenewStates={},window.promiseMappedToRenewStates={},window.msal=this;var t=window.location.hash,r=Ka.urlContainsHash(t);(us.checkIfBackButtonIsPressed(this.cacheStorage),r)&&(this.getResponseState(t).method===Hi.interactionTypeRedirect&&this.handleRedirectAuthenticationResponse(t))}return Object.defineProperty(e.prototype,"authority",{get:function(){return this.authorityInstance.CanonicalAuthority},set:function(e){this.authorityInstance=ps.CreateInstance(e,this.config.auth.validateAuthority)},enumerable:!0,configurable:!0}),e.prototype.getAuthorityInstance=function(){return this.authorityInstance},e.prototype.handleRedirectCallback=function(e,t){if(!e)throw Ba.createInvalidCallbackObjectError(e);t?(this.tokenReceivedCallback=e,this.errorReceivedCallback=t,this.logger.warning("This overload for callback is deprecated - please change the format of the callbacks to a single callback as shown: (err: AuthError, response: AuthResponse).")):this.authResponseCallback=e,this.redirectError?this.authErrorHandler(Hi.interactionTypeRedirect,this.redirectError,this.redirectResponse):this.redirectResponse&&this.authResponseHandler(Hi.interactionTypeRedirect,this.redirectResponse)},e.prototype.urlContainsHash=function(e){return this.logger.verbose("UrlContainsHash has been called"),Ka.urlContainsHash(e)},e.prototype.authResponseHandler=function(e,t,r){if(this.logger.verbose("AuthResponseHandler has been called"),e===Hi.interactionTypeRedirect)this.logger.verbose("Interaction type is redirect"),this.errorReceivedCallback?(this.logger.verbose("Two callbacks were provided to handleRedirectCallback, calling success callback with response"),this.tokenReceivedCallback(t)):this.authResponseCallback&&(this.logger.verbose("One callback was provided to handleRedirectCallback, calling authResponseCallback with response"),this.authResponseCallback(null,t));else{if(e!==Hi.interactionTypePopup)throw Ia.createInvalidInteractionTypeError();this.logger.verbose("Interaction type is popup, resolving"),r(t)}},e.prototype.authErrorHandler=function(e,t,r,n){if(this.logger.verbose("AuthErrorHandler has been called"),this.cacheStorage.removeItem(zi.INTERACTION_STATUS),e===Hi.interactionTypeRedirect)if(this.logger.verbose("Interaction type is redirect"),this.errorReceivedCallback)this.logger.verbose("Two callbacks were provided to handleRedirectCallback, calling error callback"),this.errorReceivedCallback(t,r.accountState);else{if(!this.authResponseCallback)throw this.logger.verbose("handleRedirectCallback has not been called and no callbacks are registered, throwing error"),t;this.logger.verbose("One callback was provided to handleRedirectCallback, calling authResponseCallback with error"),this.authResponseCallback(t,r)}else{if(e!==Hi.interactionTypePopup)throw Ia.createInvalidInteractionTypeError();this.logger.verbose("Interaction type is popup, rejecting"),n(t)}},e.prototype.loginRedirect=function(e){this.logger.verbose("LoginRedirect has been called");var t=as.validateRequest(e,!0,this.clientId,Hi.interactionTypeRedirect);this.acquireTokenInteractive(Hi.interactionTypeRedirect,!0,t,null,null)},e.prototype.acquireTokenRedirect=function(e){this.logger.verbose("AcquireTokenRedirect has been called");var t=as.validateRequest(e,!1,this.clientId,Hi.interactionTypeRedirect);this.acquireTokenInteractive(Hi.interactionTypeRedirect,!1,t,null,null)},e.prototype.loginPopup=function(e){var t=this;this.logger.verbose("LoginPopup has been called");var r=as.validateRequest(e,!0,this.clientId,Hi.interactionTypePopup),n=this.telemetryManager.createAndStartApiEvent(r.correlationId,Os.LoginPopup);return new Promise((function(e,n){t.acquireTokenInteractive(Hi.interactionTypePopup,!0,r,e,n)})).then((function(e){return t.logger.verbose("Successfully logged in"),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,n,!0),e})).catch((function(e){throw t.cacheStorage.resetTempCacheItems(r.state),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,n,!1,e.errorCode),e}))},e.prototype.acquireTokenPopup=function(e){var t=this;this.logger.verbose("AcquireTokenPopup has been called");var r=as.validateRequest(e,!1,this.clientId,Hi.interactionTypePopup),n=this.telemetryManager.createAndStartApiEvent(r.correlationId,Os.AcquireTokenPopup);return new Promise((function(e,n){t.acquireTokenInteractive(Hi.interactionTypePopup,!1,r,e,n)})).then((function(e){return t.logger.verbose("Successfully acquired token"),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,n,!0),e})).catch((function(e){throw t.cacheStorage.resetTempCacheItems(r.state),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,n,!1,e.errorCode),e}))},e.prototype.acquireTokenInteractive=function(e,t,r,n,o){var i=this;this.logger.verbose("AcquireTokenInteractive has been called"),us.blockReloadInHiddenIframes();var a,s=this.cacheStorage.getItem(zi.INTERACTION_STATUS);if(e===Hi.interactionTypeRedirect&&this.cacheStorage.setItem(zi.REDIRECT_REQUEST,""+Hi.inProgress+Hi.resourceDelimiter+r.state),s===Hi.inProgress){var c=t?Ia.createLoginInProgressError():Ia.createAcquireTokenInProgressError(),u=Is(this.getAccountState(r.state));return this.cacheStorage.resetTempCacheItems(r.state),void this.authErrorHandler(e,c,u,o)}if(r&&r.account&&!t?(a=r.account,this.logger.verbose("Account set from request")):(a=this.getAccount(),this.logger.verbose("Account set from MSAL Cache")),a||$a.isSSOParam(r))this.logger.verbose("User session exists, login not required"),this.acquireTokenHelper(a,e,t,r,n,o);else{if(!t){this.logger.verbose("AcquireToken call, no context or account given"),this.logger.info("User login is required");u=Is(this.getAccountState(r.state));return this.cacheStorage.resetTempCacheItems(r.state),void this.authErrorHandler(e,Ia.createUserLoginRequiredError(),u,o)}if(this.extractADALIdToken()&&!r.scopes){this.logger.info("ADAL's idToken exists. Extracting login information from ADAL's idToken");var l=this.buildIDTokenRequest(r);this.silentLogin=!0,this.acquireTokenSilent(l).then((function(t){i.silentLogin=!1,i.logger.info("Unified cache call is successful"),i.authResponseHandler(e,t,n)}),(function(a){i.silentLogin=!1,i.logger.error("Error occurred during unified cache ATS: "+a),i.acquireTokenHelper(null,e,t,r,n,o)}))}else this.logger.verbose("Login call but no token found, proceed to login"),this.acquireTokenHelper(null,e,t,r,n,o)}},e.prototype.acquireTokenHelper=function(e,t,r,n,o,i){return qi(this,void 0,void 0,(function(){var a,s,c,u,l,p,d,f,h,y;return Di(this,(function(g){switch(g.label){case 0:this.logger.verbose("AcquireTokenHelper has been called"),this.logger.verbose("Interaction type: "+t+". isLoginCall: "+r),this.cacheStorage.setItem(zi.INTERACTION_STATUS,Hi.inProgress),a=n.scopes?n.scopes.join(" ").toLowerCase():Hi.oidcScopes.join(" "),this.logger.verbosePii("Request signature: "+a),c=n&&n.authority?ps.CreateInstance(n.authority,this.config.auth.validateAuthority,n.authorityMetadata):this.authorityInstance,g.label=1;case 1:return g.trys.push([1,11,,12]),c.hasCachedMetadata()?[3,3]:(this.logger.verbose("No cached metadata for authority"),[4,ps.saveMetadataFromNetwork(c,this.telemetryManager,n.correlationId)]);case 2:return g.sent(),[3,4];case 3:this.logger.verbose("Cached metadata found for authority"),g.label=4;case 4:if(l=r?Bi:this.getTokenType(e,n.scopes),p=n.redirectStartPage||window.location.href,s=new $a(c,this.clientId,l,this.getRedirectUri(n&&n.redirectUri),n.scopes,n.state,n.correlationId),this.logger.verbose("Finished building server authentication request"),this.updateCacheEntries(s,e,r,p),this.logger.verbose("Updating cache entries"),s.populateQueryParams(e,n),this.logger.verbose("Query parameters populated from account"),d=Ka.createNavigateUrl(s)+Hi.response_mode_fragment,t===Hi.interactionTypeRedirect)r?this.logger.verbose("Interaction type redirect but login call is true. State not cached"):(this.cacheStorage.setItem(ss.generateTemporaryCacheKey(zi.STATE_ACQ_TOKEN,n.state),s.state,this.inCookie),this.logger.verbose("State cached for redirect"),this.logger.verbosePii("State cached: "+s.state));else{if(t!==Hi.interactionTypePopup)throw this.logger.verbose("Invalid interaction error. State not cached"),Ia.createInvalidInteractionTypeError();window.renewStates.push(s.state),window.requestType=r?Hi.login:Hi.renewToken,this.logger.verbose("State saved to window"),this.logger.verbosePii("State saved: "+s.state),this.registerCallback(s.state,a,o,i)}if(t!==Hi.interactionTypePopup)return[3,9];this.logger.verbose("Interaction type is popup. Generating popup window");try{u=this.openPopup(d,"msal",Hi.popUpWidth,Hi.popUpHeight),us.trackPopup(u)}catch(e){if(this.logger.info(ia.code+":"+ia.desc),this.cacheStorage.setItem(Vi.ERROR,ia.code),this.cacheStorage.setItem(Vi.ERROR_DESC,ia.desc),i)return i(Ia.createPopupWindowError()),[2]}if(!u)return[3,8];g.label=5;case 5:return g.trys.push([5,7,,8]),[4,us.monitorPopupForHash(u,this.config.system.loadFrameTimeout,d,this.logger)];case 6:return f=g.sent(),this.handleAuthenticationResponse(f),this.cacheStorage.removeItem(zi.INTERACTION_STATUS),this.logger.info("Closing popup window"),this.config.framework.isAngular&&this.broadcast("msal:popUpHashChanged",f),us.closePopups(),[3,8];case 7:return h=g.sent(),i&&i(h),this.config.framework.isAngular?this.broadcast("msal:popUpClosed",h.errorCode+Hi.resourceDelimiter+h.errorMessage):(this.cacheStorage.removeItem(zi.INTERACTION_STATUS),u.close()),[3,8];case 8:return[3,10];case 9:n.onRedirectNavigate?(this.logger.verbose("Invoking onRedirectNavigate callback"),!1!==n.onRedirectNavigate(d)?(this.logger.verbose("onRedirectNavigate did not return false, navigating"),this.navigateWindow(d)):this.logger.verbose("onRedirectNavigate returned false, stopping navigation")):(this.logger.verbose("Navigating window to urlNavigate"),this.navigateWindow(d)),g.label=10;case 10:return[3,12];case 11:return y=g.sent(),this.logger.error(y),this.cacheStorage.resetTempCacheItems(n.state),this.authErrorHandler(t,Ia.createEndpointResolutionError(y.toString),Is(n.state),i),u&&u.close(),[3,12];case 12:return[2]}}))}))},e.prototype.ssoSilent=function(e){if(this.logger.verbose("ssoSilent has been called"),!e)throw Ba.createEmptyRequestError();if(!e.sid&&!e.loginHint)throw Ba.createSsoSilentError();return this.acquireTokenSilent(Mi({},e,{scopes:Hi.oidcScopes}))},e.prototype.acquireTokenSilent=function(e){var t=this;this.logger.verbose("AcquireTokenSilent has been called");var r=as.validateRequest(e,!1,this.clientId,Hi.interactionTypeSilent),n=this.telemetryManager.createAndStartApiEvent(r.correlationId,Os.AcquireTokenSilent),o=as.createRequestSignature(r);return new Promise((function(e,n){return qi(t,void 0,void 0,(function(){var t,i,a,s,c,u,l,p,d,f,h;return Di(this,(function(y){switch(y.label){case 0:if(us.blockReloadInHiddenIframes(),t=r.scopes.join(" ").toLowerCase(),this.logger.verbosePii("Serialized scopes: "+t),r.account?(i=r.account,this.logger.verbose("Account set from request")):(i=this.getAccount(),this.logger.verbose("Account set from MSAL Cache")),a=this.cacheStorage.getItem(Hi.adalIdToken),!i&&!r.sid&&!r.loginHint&&na.isEmpty(a))return this.logger.info("User login is required"),[2,n(Ia.createUserLoginRequiredError())];if(s=this.getTokenType(i,r.scopes),this.logger.verbose("Response type: "+s),c=new $a(ps.CreateInstance(r.authority,this.config.auth.validateAuthority,r.authorityMetadata),this.clientId,s,this.getRedirectUri(r.redirectUri),r.scopes,r.state,r.correlationId),this.logger.verbose("Finished building server authentication request"),$a.isSSOParam(r)||i?(c.populateQueryParams(i,r,null,!0),this.logger.verbose("Query parameters populated from existing SSO or account")):i||na.isEmpty(a)?this.logger.verbose("No additional query parameters added"):(u=rs.extractIdToken(a),this.logger.verbose("ADAL's idToken exists. Extracting login information from ADAL's idToken to populate query parameters"),c.populateQueryParams(i,null,u,!0)),!(l=r.claimsRequest||c.claimsValue)&&!r.forceRefresh)try{d=this.getCachedToken(c,i)}catch(e){p=e}return d?(this.logger.verbose("Token found in cache lookup"),this.logger.verbosePii("Scopes found: "+JSON.stringify(d.scopes)),e(d),[2,null]):[3,1];case 1:return p?(this.logger.infoPii(p.errorCode+":"+p.errorMessage),n(p),[2,null]):[3,2];case 2:f=void 0,f=l?"Skipped cache lookup since claims were given":r.forceRefresh?"Skipped cache lookup since request.forceRefresh option was set to true":"No valid token found in cache lookup",this.logger.verbose(f),c.authorityInstance||(c.authorityInstance=r.authority?ps.CreateInstance(r.authority,this.config.auth.validateAuthority,r.authorityMetadata):this.authorityInstance),this.logger.verbosePii("Authority instance: "+c.authority),y.label=3;case 3:return y.trys.push([3,7,,8]),c.authorityInstance.hasCachedMetadata()?[3,5]:(this.logger.verbose("No cached metadata for authority"),[4,ps.saveMetadataFromNetwork(c.authorityInstance,this.telemetryManager,r.correlationId)]);case 4:return y.sent(),this.logger.verbose("Authority has been updated with endpoint discovery response"),[3,6];case 5:this.logger.verbose("Cached metadata found for authority"),y.label=6;case 6:return window.activeRenewals[o]?(this.logger.verbose("Renewing token in progress. Registering callback"),this.registerCallback(window.activeRenewals[o],o,e,n)):r.scopes&&Ga.onlyContainsOidcScopes(r.scopes)?(this.logger.verbose("OpenID Connect scopes only, renewing idToken"),this.silentLogin=!0,this.renewIdToken(o,e,n,i,c)):(this.logger.verbose("Renewing access token"),this.renewToken(o,e,n,i,c)),[3,8];case 7:return h=y.sent(),this.logger.error(h),n(Ia.createEndpointResolutionError(h.toString())),[2,null];case 8:return[2]}}))}))})).then((function(e){return t.logger.verbose("Successfully acquired token"),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,n,!0),e})).catch((function(e){throw t.cacheStorage.resetTempCacheItems(r.state),t.telemetryManager.stopAndFlushApiEvent(r.correlationId,n,!1,e.errorCode),e}))},e.prototype.openPopup=function(e,t,r,n){this.logger.verbose("OpenPopup has been called");try{var o=window.screenLeft?window.screenLeft:window.screenX,i=window.screenTop?window.screenTop:window.screenY,a=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,s=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,c=a/2-r/2+o,u=s/2-n/2+i,l=window.open(e,t,"width="+r+", height="+n+", top="+u+", left="+c+", scrollbars=yes");if(!l)throw Ia.createPopupWindowError();return l.focus&&l.focus(),l}catch(e){throw this.cacheStorage.removeItem(zi.INTERACTION_STATUS),Ia.createPopupWindowError(e.toString())}},e.prototype.loadIframeTimeout=function(e,t,r){return qi(this,void 0,void 0,(function(){var n,o,i,a,s;return Di(this,(function(c){switch(c.label){case 0:return n=window.activeRenewals[r],this.logger.verbosePii("Set loading state to pending for: "+r+":"+n),this.cacheStorage.setItem(ss.generateTemporaryCacheKey(zi.RENEW_STATUS,n),Hi.inProgress),this.config.system.navigateFrameWait?[4,us.loadFrame(e,t,this.config.system.navigateFrameWait,this.logger)]:[3,2];case 1:return i=c.sent(),[3,3];case 2:i=us.loadFrameSync(e,t,this.logger),c.label=3;case 3:o=i,c.label=4;case 4:return c.trys.push([4,6,,7]),[4,us.monitorIframeForHash(o.contentWindow,this.config.system.loadFrameTimeout,e,this.logger)];case 5:return(a=c.sent())&&this.handleAuthenticationResponse(a),[3,7];case 6:throw s=c.sent(),this.cacheStorage.getItem(ss.generateTemporaryCacheKey(zi.RENEW_STATUS,n))===Hi.inProgress&&(this.logger.verbose("Loading frame has timed out after: "+this.config.system.loadFrameTimeout/1e3+" seconds for scope/authority "+r+":"+n),n&&window.callbackMappedToRenewStates[n]&&window.callbackMappedToRenewStates[n](null,s),this.cacheStorage.removeItem(ss.generateTemporaryCacheKey(zi.RENEW_STATUS,n))),us.removeHiddenIframe(o),s;case 7:return us.removeHiddenIframe(o),[2]}}))}))},e.prototype.navigateWindow=function(e,t){if(!e||na.isEmpty(e))throw this.logger.info("Navigate url is empty"),ra.createUnexpectedError("Navigate url is empty");var r=t||window,n=t?"Navigated Popup window to:"+e:"Navigate to:"+e;this.logger.infoPii(n),r.location.assign(e)},e.prototype.registerCallback=function(e,t,r,n){var o=this;window.activeRenewals[t]=e,window.promiseMappedToRenewStates[e]||(window.promiseMappedToRenewStates[e]=[]),window.promiseMappedToRenewStates[e].push({resolve:r,reject:n}),window.callbackMappedToRenewStates[e]||(window.callbackMappedToRenewStates[e]=function(r,n){window.activeRenewals[t]=null;for(var i=0;i<window.promiseMappedToRenewStates[e].length;++i)try{if(n)window.promiseMappedToRenewStates[e][i].reject(n);else{if(!r)throw o.cacheStorage.resetTempCacheItems(e),ra.createUnexpectedError("Error and response are both null");window.promiseMappedToRenewStates[e][i].resolve(r)}}catch(e){o.logger.warning(e)}window.promiseMappedToRenewStates[e]=null,window.callbackMappedToRenewStates[e]=null})},e.prototype.logout=function(e){this.logger.verbose("Logout has been called"),this.logoutAsync(e)},e.prototype.logoutAsync=function(e){return qi(this,void 0,void 0,(function(){var t,r,n,o,i,a;return Di(this,(function(s){switch(s.label){case 0:t=e||Ui.createNewGuid(),r=this.telemetryManager.createAndStartApiEvent(t,Os.Logout),this.clearCache(),this.account=null,s.label=1;case 1:return s.trys.push([1,5,,6]),this.authorityInstance.hasCachedMetadata()?[3,3]:(this.logger.verbose("No cached metadata for authority"),[4,ps.saveMetadataFromNetwork(this.authorityInstance,this.telemetryManager,e)]);case 2:return s.sent(),[3,4];case 3:this.logger.verbose("Cached metadata found for authority"),s.label=4;case 4:return n="client-request-id="+t,o=void 0,this.getPostLogoutRedirectUri()?(o="&post_logout_redirect_uri="+encodeURIComponent(this.getPostLogoutRedirectUri()),this.logger.verbose("redirectUri found and set")):(o="",this.logger.verbose("No redirectUri set for app. postLogoutQueryParam is empty")),i=void 0,this.authorityInstance.EndSessionEndpoint?(i=this.authorityInstance.EndSessionEndpoint+"?"+n+o,this.logger.verbose("EndSessionEndpoint found and urlNavigate set"),this.logger.verbosePii("urlNavigate set to: "+this.authorityInstance.EndSessionEndpoint)):(i=this.authority+"oauth2/v2.0/logout?"+n+o,this.logger.verbose("No endpoint, urlNavigate set to default")),this.telemetryManager.stopAndFlushApiEvent(t,r,!0),this.logger.verbose("Navigating window to urlNavigate"),this.navigateWindow(i),[3,6];case 5:return a=s.sent(),this.telemetryManager.stopAndFlushApiEvent(t,r,!1,a.errorCode),[3,6];case 6:return[2]}}))}))},e.prototype.clearCache=function(){this.logger.verbose("Clearing cache"),window.renewStates=[];for(var e=this.cacheStorage.getAllTokens(Hi.clientId,Hi.homeAccountIdentifier),t=0;t<e.length;t++)this.cacheStorage.removeItem(JSON.stringify(e[t].key));this.cacheStorage.resetCacheItems(),this.cacheStorage.clearMsalCookie(),this.logger.verbose("Cache cleared")},e.prototype.clearCacheForScope=function(e){this.logger.verbose("Clearing access token from cache");for(var t=this.cacheStorage.getAllAccessTokens(Hi.clientId,Hi.homeAccountIdentifier),r=0;r<t.length;r++){var n=t[r];n.value.accessToken===e&&(this.cacheStorage.removeItem(JSON.stringify(n.key)),this.logger.verbosePii("Access token removed: "+n.key))}},e.prototype.isCallback=function(e){return this.logger.info("isCallback will be deprecated in favor of urlContainsHash in MSAL.js v2.0."),this.logger.verbose("isCallback has been called"),Ka.urlContainsHash(e)},e.prototype.processCallBack=function(e,t,r){var n,o;this.logger.info("ProcessCallBack has been called. Processing callback from redirect response"),t||(this.logger.verbose("StateInfo is null, getting stateInfo from hash"),t=this.getResponseState(e));try{n=this.saveTokenFromHash(e,t)}catch(e){o=e}try{this.cacheStorage.clearMsalCookie(t.state);var i=this.getAccountState(t.state);if(n){if(t.requestType===Hi.renewToken||n.accessToken?(window.parent!==window?this.logger.verbose("Window is in iframe, acquiring token silently"):this.logger.verbose("Acquiring token interactive in progress"),this.logger.verbose("Response tokenType set to "+Li.ACCESS_TOKEN),n.tokenType=Li.ACCESS_TOKEN):t.requestType===Hi.login&&(this.logger.verbose("Response tokenType set to "+Li.ID_TOKEN),n.tokenType=Li.ID_TOKEN),!r)return this.logger.verbose("Setting redirectResponse"),void(this.redirectResponse=n)}else if(!r)return this.logger.verbose("Response is null, setting redirectResponse with state"),this.redirectResponse=Is(i),this.redirectError=o,void this.cacheStorage.resetTempCacheItems(t.state);this.logger.verbose("Calling callback provided to processCallback"),r(n,o)}catch(e){throw this.logger.error("Error occurred in token received callback function: "+e),Ia.createErrorInCallbackFunction(e.toString())}},e.prototype.handleAuthenticationResponse=function(e){this.logger.verbose("HandleAuthenticationResponse has been called");var t=e||window.location.hash,r=this.getResponseState(t);this.logger.verbose("Obtained state from response");var n=window.callbackMappedToRenewStates[r.state];this.processCallBack(t,r,n)},e.prototype.handleRedirectAuthenticationResponse=function(e){this.logger.info("Returned from redirect url"),this.logger.verbose("HandleRedirectAuthenticationResponse has been called"),us.clearUrlFragment(),this.logger.verbose("Window.location.hash cleared");var t=this.getResponseState(e);if(this.config.auth.navigateToLoginRequestUrl&&window.parent===window){this.logger.verbose("Window.parent is equal to window, not in popup or iframe. Navigation to login request url after login turned on");var r=this.cacheStorage.getItem(ss.generateTemporaryCacheKey(zi.LOGIN_REQUEST,t.state),this.inCookie);if(!r||"null"===r)return this.logger.error("Unable to get valid login request url from cache, redirecting to home page"),void window.location.assign("/");this.logger.verbose("Valid login request url obtained from cache");var n=Ka.removeHashFromUrl(window.location.href),o=Ka.removeHashFromUrl(r);if(n!==o)return this.logger.verbose("Current url is not login request url, navigating"),this.logger.verbosePii("CurrentUrl: "+n+", finalRedirectUrl: "+o),void window.location.assign(""+o+e);this.logger.verbose("Current url matches login request url");var i=Ka.GetUrlComponents(r);i.Hash&&(this.logger.verbose("Login request url contains hash, resetting non-msal hash"),window.location.hash=i.Hash)}else this.config.auth.navigateToLoginRequestUrl||this.logger.verbose("Default navigation to start page after login turned off");this.processCallBack(e,t,null)},e.prototype.getResponseState=function(e){this.logger.verbose("GetResponseState has been called");var t,r=Ka.deserializeHash(e);if(!r)throw ra.createUnexpectedError("Hash was not parsed correctly.");if(!r.hasOwnProperty(Li.STATE))throw ra.createUnexpectedError("Hash does not contain state.");this.logger.verbose("Hash contains state. Creating stateInfo object");var n=as.parseLibraryState(r.state);if((t={requestType:Hi.unknown,state:r.state,timestamp:n.ts,method:n.method,stateMatch:!1}).state===this.cacheStorage.getItem(ss.generateTemporaryCacheKey(zi.STATE_LOGIN,t.state),this.inCookie)||t.state===this.silentAuthenticationState)return this.logger.verbose("State matches cached state, setting requestType to login"),t.requestType=Hi.login,t.stateMatch=!0,t;if(t.state===this.cacheStorage.getItem(ss.generateTemporaryCacheKey(zi.STATE_ACQ_TOKEN,t.state),this.inCookie))return this.logger.verbose("State matches cached state, setting requestType to renewToken"),t.requestType=Hi.renewToken,t.stateMatch=!0,t;if(!t.stateMatch){this.logger.verbose("State does not match cached state, setting requestType to type from window"),t.requestType=window.requestType;for(var o=window.renewStates,i=0;i<o.length;i++)if(o[i]===t.state){this.logger.verbose("Matching state found for request"),t.stateMatch=!0;break}t.stateMatch||this.logger.verbose("Matching state not found for request")}return t},e.prototype.getCachedToken=function(e,t){this.logger.verbose("GetCachedToken has been called");var r=e.scopes,n=this.getCachedIdToken(e,t),o=this.getCachedAccessToken(e,t,r),i=this.getAccountState(e.state);return ls.buildAuthResponse(n,o,e,t,r,i)},e.prototype.getTokenCacheItemByAuthority=function(e,t,r,n){var o,i=this;return 1===(o=Ka.isCommonAuthority(e)||Ka.isOrganizationsAuthority(e)||Ka.isConsumersAuthority(e)?lc.filterTokenCacheItemsByDomain(t,Ka.GetUrlComponents(e).HostNameAndPort):lc.filterTokenCacheItemsByAuthority(t,e)).length?o[0]:o.length>1?(this.logger.warning("Multiple matching tokens found. Cleaning cache and requesting a new token."),o.forEach((function(e){i.cacheStorage.removeItem(JSON.stringify(e.key))})),null):(this.logger.verbose("No matching tokens of type "+n+" found"),null)},e.prototype.getCachedIdToken=function(e,t){this.logger.verbose("Getting all cached tokens of type ID Token");var r=this.cacheStorage.getAllIdTokens(this.clientId,t?t.homeAccountIdentifier:null),n=e.authority||this.authority,o=this.getTokenCacheItemByAuthority(n,r,null,Li.ID_TOKEN);if(o){if(this.logger.verbose("Evaluating ID token found"),this.evaluateTokenExpiration(o)){this.logger.verbose("ID token expiration is within offset, using ID token found in cache");var i=o.value;return i?this.logger.verbose("ID Token found in cache is valid and unexpired"):this.logger.verbose("ID Token found in cache is invalid"),i?new ns(i.idToken):null}return this.logger.verbose("Cached ID token is expired, removing from cache"),this.cacheStorage.removeItem(JSON.stringify(o.key)),null}return this.logger.verbose("No tokens found"),null},e.prototype.getCachedAccessToken=function(e,t,r){this.logger.verbose("Getting all cached tokens of type Access Token");var n=this.cacheStorage.getAllAccessTokens(this.clientId,t?t.homeAccountIdentifier:null),o=lc.filterTokenCacheItemsByScope(n,r),i=e.authority||this.authority,a=this.getTokenCacheItemByAuthority(i,o,r,Li.ACCESS_TOKEN);if(a){if(e.authorityInstance=ps.CreateInstance(a.key.authority,this.config.auth.validateAuthority),this.logger.verbose("Evaluating access token found"),this.evaluateTokenExpiration(a)){if(this.logger.verbose("Access token expiration is within offset, using access token found in cache"),!t&&!(t=this.getAccount()))throw ra.createUnexpectedError("Account should not be null here.");var s=this.getAccountState(e.state);return{uniqueId:"",tenantId:"",tokenType:Li.ACCESS_TOKEN,idToken:null,idTokenClaims:null,accessToken:a.value.accessToken,scopes:a.key.scopes.split(" "),expiresOn:new Date(1e3*Number(a.value.expiresIn)),account:t,accountState:s,fromCache:!0}}return this.logger.verbose("Access token expired, removing from cache"),this.cacheStorage.removeItem(JSON.stringify(a.key)),null}return this.logger.verbose("No matching token found when filtering by scope and authority"),null},e.prototype.evaluateTokenExpiration=function(e){var t=Number(e.value.expiresIn);return rs.validateExpirationIsWithinOffset(t,this.config.system.tokenRenewalOffsetSeconds)},e.prototype.extractADALIdToken=function(){this.logger.verbose("ExtractADALIdToken has been called");var e=this.cacheStorage.getItem(Hi.adalIdToken);return na.isEmpty(e)?null:rs.extractIdToken(e)},e.prototype.renewToken=function(e,t,r,n,o){this.logger.verbose("RenewToken has been called"),this.logger.verbosePii("RenewToken scope and authority: "+e);var i=us.generateFrameName(Zi,e);us.addHiddenIFrame(i,this.logger),this.updateCacheEntries(o,n,!1),this.logger.verbosePii("RenewToken expected state: "+o.state);var a=Ka.urlRemoveQueryStringParameter(Ka.createNavigateUrl(o),Hi.prompt)+Hi.prompt_none+Hi.response_mode_fragment;window.renewStates.push(o.state),window.requestType=Hi.renewToken,this.logger.verbose("Set window.renewState and requestType"),this.registerCallback(o.state,e,t,r),this.logger.infoPii("Navigate to: "+a),this.loadIframeTimeout(a,i,e).catch((function(e){return r(e)}))},e.prototype.renewIdToken=function(e,t,r,n,o){this.logger.info("RenewIdToken has been called");var i=us.generateFrameName(Yi,e);us.addHiddenIFrame(i,this.logger),this.updateCacheEntries(o,n,!1),this.logger.verbose("RenewIdToken expected state: "+o.state);var a=Ka.urlRemoveQueryStringParameter(Ka.createNavigateUrl(o),Hi.prompt)+Hi.prompt_none+Hi.response_mode_fragment;this.silentLogin?(this.logger.verbose("Silent login is true, set silentAuthenticationState"),window.requestType=Hi.login,this.silentAuthenticationState=o.state):(this.logger.verbose("Not silent login, set window.renewState and requestType"),window.requestType=Hi.renewToken,window.renewStates.push(o.state)),this.registerCallback(o.state,e,t,r),this.logger.infoPii('Navigate to:" '+a),this.loadIframeTimeout(a,i,e).catch((function(e){return r(e)}))},e.prototype.saveToken=function(e,t,r,n,o){var i=new Wa(t,this.clientId,r,n.uid,n.utid),a=new Qa(e.accessToken,e.idToken.rawIdToken,o.toString(),n.encodeClientInfo());return this.cacheStorage.setItem(JSON.stringify(i),JSON.stringify(a)),o?(this.logger.verbose("New expiration set for token"),e.expiresOn=new Date(1e3*o)):this.logger.error("Could not parse expiresIn parameter for access token"),e},e.prototype.saveIdToken=function(e,t,r,n,o){this.logger.verbose("SaveIdToken has been called");var i=Mi({},e);i.scopes=Hi.oidcScopes,i.accessToken=r[Li.ID_TOKEN];var a=Number(o.expiration);return this.logger.verbose("Saving ID token to cache"),this.saveToken(i,t,void 0,n,a)},e.prototype.saveAccessToken=function(e,t,r,n){this.logger.verbose("SaveAccessToken has been called");var o=Mi({},e),i=r[Li.SCOPE],a=i.split(" "),s=this.cacheStorage.getAllAccessTokens(this.clientId,t);this.logger.verbose("Retrieving all access tokens from cache and removing duplicates");for(var c=0;c<s.length;c++){var u=s[c];if(u.key.homeAccountIdentifier===e.account.homeAccountIdentifier){var l=u.key.scopes.split(" ");Ga.isIntersectingScopes(l,a)&&this.cacheStorage.removeItem(JSON.stringify(u.key))}}o.accessToken=r[Li.ACCESS_TOKEN],o.scopes=a;var p=ts.parseExpiresIn(r[Li.EXPIRES_IN]),d=as.parseLibraryState(r[Li.STATE]).ts+p;return this.logger.verbose("Saving access token to cache"),this.saveToken(o,t,i,n,d)},e.prototype.saveTokenFromHash=function(e,t){this.logger.verbose("SaveTokenFromHash has been called"),this.logger.info("State status: "+t.stateMatch+"; Request type: "+t.requestType);var r,n={uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:null,scopes:[],expiresOn:null,account:null,accountState:"",fromCache:!1},o=Ka.deserializeHash(e),i="",a="",s=null;if(o.hasOwnProperty(Li.ERROR_DESCRIPTION)||o.hasOwnProperty(Li.ERROR)){if(this.logger.verbose("Server returned an error"),this.logger.infoPii("Error : "+o[Li.ERROR]+"; Error description: "+o[Li.ERROR_DESCRIPTION]),this.cacheStorage.setItem(Vi.ERROR,o[Li.ERROR]),this.cacheStorage.setItem(Vi.ERROR_DESC,o[Li.ERROR_DESCRIPTION]),t.requestType===Hi.login&&(this.logger.verbose("RequestType is login, caching login error, generating authorityKey"),this.cacheStorage.setItem(Vi.LOGIN_ERROR,o[Li.ERROR_DESCRIPTION]+":"+o[Li.ERROR]),i=ss.generateAuthorityKey(t.state)),t.requestType===Hi.renewToken){this.logger.verbose("RequestType is renewToken, generating acquireTokenAccountKey"),i=ss.generateAuthorityKey(t.state);var c=this.getAccount(),u=void 0;c&&!na.isEmpty(c.homeAccountIdentifier)?(u=c.homeAccountIdentifier,this.logger.verbose("AccountId is set")):(u=Hi.no_account,this.logger.verbose("AccountId is set as no_account")),a=ss.generateAcquireTokenAccountKey(u,t.state)}var l=o[Li.ERROR],p=o[Li.ERROR_DESCRIPTION];r=Es.isInteractionRequiredError(l)||Es.isInteractionRequiredError(p)?new Es(o[Li.ERROR],o[Li.ERROR_DESCRIPTION]):new bs(o[Li.ERROR],o[Li.ERROR_DESCRIPTION])}else if(this.logger.verbose("Server returns success"),t.stateMatch){this.logger.info("State is right"),o.hasOwnProperty(Li.SESSION_STATE)&&(this.logger.verbose("Fragment has session state, caching"),this.cacheStorage.setItem(ss.generateTemporaryCacheKey(zi.SESSION_STATE,t.state),o[Li.SESSION_STATE])),n.accountState=this.getAccountState(t.state);var d=void 0;if(o.hasOwnProperty(Li.ACCESS_TOKEN)){this.logger.info("Fragment has access token"),n.accessToken=o[Li.ACCESS_TOKEN],o.hasOwnProperty(Li.SCOPE)&&(n.scopes=o[Li.SCOPE].split(" ")),o.hasOwnProperty(Li.ID_TOKEN)?(this.logger.verbose("Fragment has id_token"),s=new ns(o[Li.ID_TOKEN])):(this.logger.verbose("No idToken on fragment, getting idToken from cache"),s=new ns(this.cacheStorage.getItem(Fi.IDTOKEN))),n=ls.setResponseIdToken(n,s);var f=this.populateAuthority(t.state,this.inCookie,this.cacheStorage,s);this.logger.verbose("Got authority from cache"),o.hasOwnProperty(Li.CLIENT_INFO)?(this.logger.verbose("Fragment has clientInfo"),d=new es(o[Li.CLIENT_INFO],f)):this.authorityInstance.AuthorityType===Qi.Adfs?d=es.createClientInfoFromIdToken(s,f):this.logger.warning("ClientInfo not received in the response from AAD"),n.account=cs.createAccount(s,d),this.logger.verbose("Account object created from response");var h=void 0;n.account&&!na.isEmpty(n.account.homeAccountIdentifier)?(this.logger.verbose("AccountKey set"),h=n.account.homeAccountIdentifier):(this.logger.verbose("AccountKey set as no_account"),h=Hi.no_account),a=ss.generateAcquireTokenAccountKey(h,t.state);var y=ss.generateAcquireTokenAccountKey(Hi.no_account,t.state);this.logger.verbose("AcquireTokenAccountKey generated");var g=this.cacheStorage.getItem(a),m=void 0;na.isEmpty(g)?na.isEmpty(this.cacheStorage.getItem(y))||(this.logger.verbose("No acquireToken account retrieved from cache"),n=this.saveAccessToken(n,f,o,d)):(m=JSON.parse(g),this.logger.verbose("AcquireToken request account retrieved from cache"),n.account&&m&&cs.compareAccounts(n.account,m)?(n=this.saveAccessToken(n,f,o,d),this.logger.info("The user object received in the response is the same as the one passed in the acquireToken request")):this.logger.warning("The account object created from the response is not the same as the one passed in the acquireToken request"))}if(o.hasOwnProperty(Li.ID_TOKEN)){this.logger.info("Fragment has idToken"),s=new ns(o[Li.ID_TOKEN]);f=this.populateAuthority(t.state,this.inCookie,this.cacheStorage,s);if(n=ls.setResponseIdToken(n,s),o.hasOwnProperty(Li.CLIENT_INFO)?(this.logger.verbose("Fragment has clientInfo"),d=new es(o[Li.CLIENT_INFO],f)):this.authorityInstance.AuthorityType===Qi.Adfs?d=es.createClientInfoFromIdToken(s,f):this.logger.warning("ClientInfo not received in the response from AAD"),this.account=cs.createAccount(s,d),n.account=this.account,this.logger.verbose("Account object created from response"),s&&s.nonce){this.logger.verbose("IdToken has nonce");var v=this.cacheStorage.getItem(ss.generateTemporaryCacheKey(zi.NONCE_IDTOKEN,t.state),this.inCookie);s.nonce!==v?(this.account=null,this.cacheStorage.setItem(Vi.LOGIN_ERROR,"Nonce Mismatch. Expected Nonce: "+v+",Actual Nonce: "+s.nonce),this.logger.error("Nonce Mismatch. Expected Nonce: "+v+", Actual Nonce: "+s.nonce),r=Ia.createNonceMismatchError(v,s.nonce)):(this.logger.verbose("Nonce matches, saving idToken to cache"),this.cacheStorage.setItem(Fi.IDTOKEN,o[Li.ID_TOKEN],this.inCookie),this.cacheStorage.setItem(Fi.CLIENT_INFO,d.encodeClientInfo(),this.inCookie),this.saveIdToken(n,f,o,d,s))}else this.logger.verbose("No idToken or no nonce. Cache key for Authority set as state"),i=t.state,a=t.state,this.logger.error("Invalid id_token received in the response"),r=Ia.createInvalidIdTokenError(s),this.cacheStorage.setItem(Vi.ERROR,r.errorCode),this.cacheStorage.setItem(Vi.ERROR_DESC,r.errorMessage)}}else{this.logger.verbose("State mismatch"),i=t.state,a=t.state;var b=this.cacheStorage.getItem(ss.generateTemporaryCacheKey(zi.STATE_LOGIN,t.state),this.inCookie);this.logger.error("State Mismatch. Expected State: "+b+", Actual State: "+t.state),r=Ia.createInvalidStateError(t.state,b),this.cacheStorage.setItem(Vi.ERROR,r.errorCode),this.cacheStorage.setItem(Vi.ERROR_DESC,r.errorMessage)}if(this.cacheStorage.removeItem(ss.generateTemporaryCacheKey(zi.RENEW_STATUS,t.state)),this.cacheStorage.resetTempCacheItems(t.state),this.logger.verbose("Status set to complete, temporary cache cleared"),this.inCookie&&(this.logger.verbose("InCookie is true, setting authorityKey in cookie"),this.cacheStorage.setItemCookie(i,"",-1),this.cacheStorage.clearMsalCookie(t.state)),r)throw r;if(!n)throw ra.createUnexpectedError("Response is null");return n},e.prototype.populateAuthority=function(e,t,r,n){this.logger.verbose("PopulateAuthority has been called");var o=ss.generateAuthorityKey(e),i=r.getItem(o,t);return na.isEmpty(i)?i:Ka.replaceTenantPath(i,n.tenantId)},e.prototype.getAccount=function(){if(this.account)return this.account;var e=this.cacheStorage.getItem(Fi.IDTOKEN,this.inCookie),t=this.cacheStorage.getItem(Fi.CLIENT_INFO,this.inCookie);if(!na.isEmpty(e)&&!na.isEmpty(t)){var r=new ns(e),n=new es(t,"");return this.account=cs.createAccount(r,n),this.account}return null},e.prototype.getAccountState=function(e){if(e){var t=e.indexOf(Hi.resourceDelimiter);if(t>-1&&t+1<e.length)return e.substring(t+1)}return e},e.prototype.getAllAccounts=function(){for(var e=[],t=this.cacheStorage.getAllAccessTokens(Hi.clientId,Hi.homeAccountIdentifier),r=0;r<t.length;r++){var n=new ns(t[r].value.idToken),o=new es(t[r].value.homeAccountIdentifier,""),i=cs.createAccount(n,o);e.push(i)}return this.getUniqueAccounts(e)},e.prototype.getUniqueAccounts=function(e){if(!e||e.length<=1)return e;for(var t=[],r=[],n=0;n<e.length;++n)e[n].homeAccountIdentifier&&-1===t.indexOf(e[n].homeAccountIdentifier)&&(t.push(e[n].homeAccountIdentifier),r.push(e[n]));return r},e.prototype.broadcast=function(e,t){var r=new CustomEvent(e,{detail:t});window.dispatchEvent(r)},e.prototype.getCachedTokenInternal=function(e,t,r,n){var o=t||this.getAccount();if(!o)return null;var i=this.authorityInstance?this.authorityInstance:ps.CreateInstance(this.authority,this.config.auth.validateAuthority),a=this.getTokenType(o,e),s=new $a(i,this.clientId,a,this.getRedirectUri(),e,r,n);return this.getCachedToken(s,t)},e.prototype.getScopesForEndpoint=function(e){if(this.config.framework.unprotectedResources.length>0)for(var t=0;t<this.config.framework.unprotectedResources.length;t++)if(e.indexOf(this.config.framework.unprotectedResources[t])>-1)return null;if(this.config.framework.protectedResourceMap.size>0)for(var r=0,n=Array.from(this.config.framework.protectedResourceMap.keys());r<n.length;r++){var o=n[r];if(e.indexOf(o)>-1)return this.config.framework.protectedResourceMap.get(o)}return e.indexOf("http://")>-1||e.indexOf("https://")>-1?Ka.getHostFromUri(e)===Ka.getHostFromUri(this.getRedirectUri())?new Array(this.clientId):null:new Array(this.clientId)},e.prototype.getLoginInProgress=function(){return this.cacheStorage.getItem(zi.INTERACTION_STATUS)===Hi.inProgress},e.prototype.setInteractionInProgress=function(e){e?this.cacheStorage.setItem(zi.INTERACTION_STATUS,Hi.inProgress):this.cacheStorage.removeItem(zi.INTERACTION_STATUS)},e.prototype.setloginInProgress=function(e){this.setInteractionInProgress(e)},e.prototype.getAcquireTokenInProgress=function(){return this.cacheStorage.getItem(zi.INTERACTION_STATUS)===Hi.inProgress},e.prototype.setAcquireTokenInProgress=function(e){this.setInteractionInProgress(e)},e.prototype.getLogger=function(){return this.logger},e.prototype.setLogger=function(e){this.logger=e},e.prototype.getRedirectUri=function(e){return e||("function"==typeof this.config.auth.redirectUri?this.config.auth.redirectUri():this.config.auth.redirectUri)},e.prototype.getPostLogoutRedirectUri=function(){return"function"==typeof this.config.auth.postLogoutRedirectUri?this.config.auth.postLogoutRedirectUri():this.config.auth.postLogoutRedirectUri},e.prototype.getCurrentConfiguration=function(){if(!this.config)throw Ba.createNoSetConfigurationError();return this.config},e.prototype.getTokenType=function(e,t){var r=cs.compareAccounts(e,this.getAccount());return $a.determineResponseType(r,t)},e.prototype.setAccountCache=function(e,t){var r=e?this.getAccountId(e):Hi.no_account,n=ss.generateAcquireTokenAccountKey(r,t);this.cacheStorage.setItem(n,JSON.stringify(e))},e.prototype.setAuthorityCache=function(e,t){var r=ss.generateAuthorityKey(e);this.cacheStorage.setItem(r,Ka.CanonicalizeUri(t),this.inCookie)},e.prototype.updateCacheEntries=function(e,t,r,n){n&&this.cacheStorage.setItem(ss.generateTemporaryCacheKey(zi.LOGIN_REQUEST,e.state),n,this.inCookie),r?this.cacheStorage.setItem(ss.generateTemporaryCacheKey(zi.STATE_LOGIN,e.state),e.state,this.inCookie):this.setAccountCache(t,e.state),this.setAuthorityCache(e.state,e.authority),this.cacheStorage.setItem(ss.generateTemporaryCacheKey(zi.NONCE_IDTOKEN,e.state),e.nonce,this.inCookie)},e.prototype.getAccountId=function(e){return na.isEmpty(e.homeAccountIdentifier)?Hi.no_account:e.homeAccountIdentifier},e.prototype.buildIDTokenRequest=function(e){return{scopes:Hi.oidcScopes,authority:this.authority,account:this.getAccount(),extraQueryParameters:e.extraQueryParameters,correlationId:e.correlationId}},e.prototype.getTelemetryManagerFromConfig=function(e,t){if(!e)return uc.getTelemetrymanagerStub(t,this.logger);var r=e.applicationName,n=e.applicationVersion,o=e.telemetryEmitter;if(!r||!n||!o)throw Ba.createTelemetryConfigError(e);return new uc({platform:{applicationName:r,applicationVersion:n},clientId:t},o,this.logger)},e}();var dc;!function(e){e.AzureChina="https://login.chinacloudapi.cn",e.AzureGermany="https://login.microsoftonline.de",e.AzureGovernment="https://login.microsoftonline.us",e.AzurePublicCloud="https://login.microsoftonline.com"}(dc||(dc={}));const fc=function(e,t=jn){const r=qn(e,void 0,t);return Object.assign(Object.assign({},r),{getToken:qn("=> getToken()",r,t)})}("InteractiveBrowserCredential");class hc{constructor(e){if(e=Object.assign(Object.assign(Object.assign({},ki.getDefaultOptions()),e),{tenantId:e&&e.tenantId||"common",clientId:e&&e.clientId||"04b07795-8ddb-461a-bbee-02f9e1bf7b46"}),this.loginStyle=e.loginStyle||"popup",-1===["redirect","popup"].indexOf(this.loginStyle)){const t=new Error("Invalid loginStyle: "+e.loginStyle);throw fc.info(Mn("",t)),t}const t="adfs"===e.tenantId&&e.authorityHost?[e.authorityHost]:[];this.msalConfig={auth:Object.assign(Object.assign({clientId:e.clientId,authority:`${e.authorityHost}/${e.tenantId}`,knownAuthorities:t},e.redirectUri&&{redirectUri:e.redirectUri}),e.postLogoutRedirectUri&&{redirectUri:e.postLogoutRedirectUri}),cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!0}},this.msalObject=new pc(this.msalConfig)}login(){switch(this.loginStyle){case"redirect":{const e=new Promise((e,t)=>{this.msalObject.handleRedirectCallback(e,t)});return this.msalObject.loginRedirect(),e}case"popup":return this.msalObject.loginPopup()}}acquireToken(e){return c(this,void 0,void 0,(function*(){let t,r;try{fc.info("Attempting to acquire token silently"),t=yield this.msalObject.acquireTokenSilent(e)}catch(t){if(t instanceof ra)switch(t.errorCode){case"consent_required":case"interaction_required":case"login_required":fc.info("Authentication returned errorCode "+t.errorCode);break;default:throw fc.info(Mn(e.scopes,"Failed to acquire token: "+t.message)),t}}if(void 0===t){switch(fc.info("Silent authentication failed, falling back to interactive method "+this.loginStyle),this.loginStyle){case"redirect":r=new Promise((e,t)=>{this.msalObject.handleRedirectCallback(e,t)}),this.msalObject.acquireTokenRedirect(e);break;case"popup":r=this.msalObject.acquireTokenPopup(e)}t=r&&(yield r)}return t}))}getToken(e,t){return c(this,void 0,void 0,(function*(){const{span:r}=xn("InteractiveBrowserCredential-getToken",t);try{this.msalObject.getAccount()||(yield this.login());const t=yield this.acquireToken({scopes:Array.isArray(e)?e:e.split(",")});if(t){const r=t.expiresOn.getTime();return fc.getToken.info((n=e,`SUCCESS. Scopes: ${Array.isArray(n)?n.join(", "):n}.`)),{token:t.accessToken,expiresOnTimestamp:r}}return fc.getToken.info("No response"),null}catch(t){throw r.setStatus({code:Qr.ERROR,message:t.message}),fc.getToken.info(Mn(e,t)),t}finally{r.end()}var n}))}}async function yc(){const e=new hc,t=new _n(e);return await t.getMetricDefinitions("resourceUri")}return window.addEventListener("DOMContentLoaded",()=>{document.getElementById("queryLogs").addEventListener("click",()=>yc())}),e.queryLogs=yc,Object.defineProperty(e,"__esModule",{value:!0}),e}({});
